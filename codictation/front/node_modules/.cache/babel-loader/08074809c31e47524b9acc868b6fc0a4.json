{"remainingRequest":"D:\\project\\codictation.2.7\\codictation\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\codictation.2.7\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.transform-quasar-imports.js!D:\\project\\codictation.2.7\\codictation\\src\\diff.js","dependencies":[{"path":"D:\\project\\codictation.2.7\\codictation\\src\\diff.js","mtime":1612749277000},{"path":"D:\\project\\codictation.2.7\\codictation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\project\\codictation.2.7\\codictation\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\project\\codictation.2.7\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.transform-quasar-imports.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiKTsKCjsKCihmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBzcGFjZXMgPSBmdW5jdGlvbiBzcGFjZXMoc3RyKSB7CiAgICB2YXIgc3BhY2VzID0gc3RyLm1hdGNoKC9ccysvZyk7CgogICAgaWYgKHNwYWNlcyA9PSBudWxsKSB7CiAgICAgIHNwYWNlcyA9IFtdOwogICAgfQoKICAgIHJldHVybiBzcGFjZXMuY29uY2F0KCJcbiIpOwogIH07CgogIHZhciBtYXJrdXAgPSB7CiAgICBkZWxldGVkOiBmdW5jdGlvbiBkZWxldGVkKHN0ciwgbWFya2VyKSB7CiAgICAgIHJldHVybiBtYXJrZXIuc3RhcnQgKyBlc2NhcGUoc3RyKSArIG1hcmtlci5lbmQ7CiAgICB9LAogICAgaW5zZXJ0ZWQ6IGZ1bmN0aW9uIGluc2VydGVkKHN0ciwgbWFya2VyKSB7CiAgICAgIHJldHVybiBtYXJrZXIuc3RhcnQgKyBlc2NhcGUoc3RyKSArIG1hcmtlci5lbmQ7CiAgICB9CiAgfTsKCiAgdmFyIHJldHJpZXZlID0gZnVuY3Rpb24gcmV0cmlldmUob2JqLCBrZXlzKSB7CiAgICByZXR1cm4ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gKGEsIHgpIHsKICAgICAgcmV0dXJuIGEgJiYgYVt4XTsKICAgIH0sIG9iaik7CiAgfTsKCiAgdmFyIGJ1aWxkX3dvcmRfaW5kZXggPSBmdW5jdGlvbiBidWlsZF93b3JkX2luZGV4KHdvcmRzX2FycmF5KSB7CiAgICByZXR1cm4gd29yZHNfYXJyYXkucmVkdWNlKGZ1bmN0aW9uIChhLCB4LCBpKSB7CiAgICAgIGFbeF0gPSBhW3hdIHx8IHsKICAgICAgICByb3dzOiBbXSwKICAgICAgICBvOiBudWxsCiAgICAgIH07CiAgICAgIGFbeF0ucm93cy5wdXNoKGkpOwogICAgICByZXR1cm4gYTsKICAgIH0sIHt9KTsKICB9OwoKICB2YXIgd29yZCA9IHsKICAgIGZyZXF1ZW5jeTogZnVuY3Rpb24gZnJlcXVlbmN5KHdvcmRIYXNoLCB3b3JkKSB7CiAgICAgIHJldHVybiByZXRyaWV2ZSh3b3JkSGFzaCwgW3dvcmQsICJyb3dzIiwgImxlbmd0aCJdKTsKICAgIH0sCiAgICBjb25uZWN0OiBmdW5jdGlvbiBjb25uZWN0KHdvcmRzLCByb3csIGNvbm5lY3RlZFJvdykgewogICAgICB3b3Jkc1tyb3ddID0gewogICAgICAgIHRleHQ6IHdvcmRzW3Jvd10sCiAgICAgICAgcm93OiBjb25uZWN0ZWRSb3cKICAgICAgfTsKICAgIH0sCiAgICBleGlzdHM6IGZ1bmN0aW9uIGV4aXN0cyh3b3JkcywgaW5kZXgpIHsKICAgICAgcmV0dXJuIHJldHJpZXZlKHdvcmRzLCBbaW5kZXgsICJ0ZXh0Il0pICE9IG51bGw7CiAgICB9CiAgfTsKCiAgdmFyIGNvbm5lY3RVbmNoYW5nZWRXb3JkcyA9IGZ1bmN0aW9uIGNvbm5lY3RVbmNoYW5nZWRXb3JkcyhkaWZmKSB7CiAgICB2YXIgb2xkX2hhc2ggPSBidWlsZF93b3JkX2luZGV4KGRpZmYub2xkX3dvcmRzKTsKICAgIHZhciBuZXdfaGFzaCA9IGJ1aWxkX3dvcmRfaW5kZXgoZGlmZi5uZXdfd29yZHMpOyAvLyBmb3IgZWFjaCB3b3JkIGluIHRoZSBuZXcgdGV4dAogICAgLy8gd2hlbiB0aGUgd29yZCBhcHBlYXJzIGluIG9ubHkgb25jZSBpbiBib3RoIGhhc2hlcwogICAgLy8gYWRkIGEgbmV3IG9iamVjdCB0byB0aGUgZGlmZi5uZXdfd29yZHMgYW5kIGRpZmYub2xkX3dvcmRzCiAgICAvLyBhcnJheXMgdGhhdCBjb250YWlucyB0aGUgaW5kZXggb2YgdGhhdCB3b3JkIGluIHRoZSBvdGhlciBhcnJheQogICAgLy8gYWxvbmcgd2l0aCB0aGUgdGV4dCBvZiB0aGUgd29yZAoKICAgIGZvciAodmFyIGkgaW4gbmV3X2hhc2gpIHsKICAgICAgaWYgKHdvcmQuZnJlcXVlbmN5KG5ld19oYXNoLCBpKSA9PT0gMSAmJiB3b3JkLmZyZXF1ZW5jeShvbGRfaGFzaCwgaSkgPT09IDEpIHsKICAgICAgICAvLyBhc3N1bWUgdGhlc2Ugd29yZHMgYXJlIHVuY2hhbmdlZCBtYXRjaGVzCiAgICAgICAgd29yZC5jb25uZWN0KGRpZmYubmV3X3dvcmRzLCBuZXdfaGFzaFtpXS5yb3dzWzBdLCBvbGRfaGFzaFtpXS5yb3dzWzBdKTsKICAgICAgICB3b3JkLmNvbm5lY3QoZGlmZi5vbGRfd29yZHMsIG9sZF9oYXNoW2ldLnJvd3NbMF0sIG5ld19oYXNoW2ldLnJvd3NbMF0pOwogICAgICB9CiAgICB9CiAgfTsKCiAgdmFyIGNoYWluTWF0Y2hpbmdXb3JkcyA9IGZ1bmN0aW9uIGNoYWluTWF0Y2hpbmdXb3JkcyhkaWZmKSB7CiAgICAvLyB0cnkgdG8gZmluZCBjb25zZWN1dGl2ZSBtYXRjaGluZyB3b3Jkcy4KICAgIC8vIHRoaXMgc3RlcCBpcyBlc3NlbnRpYWxseSB0cnlpbmcgdG8gZmluZAogICAgLy8gdGhlIGJlc3Qgc3RyaW5nIG9mIG1hdGNoZXMgd2hlbiBhIHdvcmQKICAgIC8vIGhhcyBiZWVuIHVzZWQgbW9yZSB0aGFuIG9uY2UKICAgIGRpZmYubmV3X3dvcmRzLmZvckVhY2goZnVuY3Rpb24gKG5ld1dvcmQsIGkpIHsKICAgICAgaWYgKHdvcmQuZXhpc3RzKGRpZmYubmV3X3dvcmRzLCBpKSAmJiAhd29yZC5leGlzdHMoZGlmZi5uZXdfd29yZHMsIGkgKyAxKSAvLyBhbmQgdGhlIG5leHQgd29yZCBpcyBzby1mYXIgdW5tYXRjaGVkCiAgICAgIC8vIGFuZCB3ZSBoYXZlbid0IHBhc3NlZCB0aGUgZW5kIG9mIHRoZSBkaWZmLm9sZF93b3JkcwogICAgICAmJiBuZXdXb3JkLnJvdyArIDEgPCBkaWZmLm9sZF93b3Jkcy5sZW5ndGggJiYgIXdvcmQuZXhpc3RzKGRpZmYub2xkX3dvcmRzLCBuZXdXb3JkLnJvdyArIDEpIC8vIGFuZCB0aGUgbmV4dCB3b3JkIGlzIHRoZSBzYW1lIGluIHRoZSBkaWZmLm9sZF93b3JkcwogICAgICAmJiBkaWZmLm5ld193b3Jkc1tpICsgMV0gPT0gZGlmZi5vbGRfd29yZHNbbmV3V29yZC5yb3cgKyAxXSkgewogICAgICAgIC8vIGNoYWluIGN1cnJlbnQgd29yZCB0byBuZXh0IGluIGRpZmYubmV3X3dvcmRzIGFuZCBkaWZmLm9sZF93b3JkcwogICAgICAgIHdvcmQuY29ubmVjdChkaWZmLm5ld193b3JkcywgaSArIDEsIG5ld1dvcmQucm93ICsgMSk7CiAgICAgICAgd29yZC5jb25uZWN0KGRpZmYub2xkX3dvcmRzLCBuZXdXb3JkLnJvdyArIDEsIGkgKyAxKTsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgdmFyIGRpZmYgPSBmdW5jdGlvbiBkaWZmKG9sZF93b3JkcywgbmV3X3dvcmRzKSB7CiAgICB2YXIgZGlmZiA9IHsKICAgICAgb2xkX3dvcmRzOiBvbGRfd29yZHMsCiAgICAgIG5ld193b3JkczogbmV3X3dvcmRzCiAgICB9OwogICAgY29ubmVjdFVuY2hhbmdlZFdvcmRzKGRpZmYpOwogICAgY2hhaW5NYXRjaGluZ1dvcmRzKGRpZmYpOwogICAgZGlmZi5vbGRfd29yZHMucmV2ZXJzZSgpOwogICAgZGlmZi5uZXdfd29yZHMucmV2ZXJzZSgpOwogICAgY2hhaW5NYXRjaGluZ1dvcmRzKGRpZmYpOwogICAgZGlmZi5vbGRfd29yZHMucmV2ZXJzZSgpOwogICAgZGlmZi5uZXdfd29yZHMucmV2ZXJzZSgpOwogICAgcmV0dXJuIGRpZmY7CiAgfTsKCiAgdmFyIGRpZmZlciA9IHsKICAgIHN0cmluZ1RvV29yZHM6IGZ1bmN0aW9uIHN0cmluZ1RvV29yZHMoc3RyKSB7CiAgICAgIHN0ciA9IHRoaXMucHJlcGFyZV90ZXh0KHN0cik7CiAgICAgIHJldHVybiBzdHIgPT0gIiIgPyBbXSA6IHN0ci5zcGxpdCgvXHMrLyk7CiAgICB9LAogICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKG9sZFN0cmluZywgbmV3U3RyaW5nLCBzaWdpbCkgewogICAgICAvLyBzZXQgc2lnaWwgZGVmYXVsdHMgaWYgbm90IHBhc3NlZAogICAgICBpZiAoc2lnaWwgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHNpZ2lsID0gewogICAgICAgICAgaW5zOiB7CiAgICAgICAgICAgIHN0YXJ0OiAnPGlucz4nLAogICAgICAgICAgICBlbmQ6ICc8L2lucz4nCiAgICAgICAgICB9LAogICAgICAgICAgZGVsOiB7CiAgICAgICAgICAgIHN0YXJ0OiAnPGRlbD4nLAogICAgICAgICAgICBlbmQ6ICc8L2RlbD4nCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSAvLyBwYXNzIGFycmF5cyBvZiBuZXcgYW5kIG9sZCB3b3JkcyB0byBkaWZmIG1ldGhvZAogICAgICAvLyBkaWZmIG1ldGhvZCByZXR1cm5zIG91dHB1dCBvZiB0aGUgZGlmZgoKCiAgICAgIHZhciBkaWZmX291dHB1dCA9IGRpZmYodGhpcy5zdHJpbmdUb1dvcmRzKG9sZFN0cmluZyksIHRoaXMuc3RyaW5nVG9Xb3JkcyhuZXdTdHJpbmcpKTsgLy8gY29uc29sZS5sb2coJz09PT09PT0nLCBkaWZmX291dHB1dCkKCiAgICAgIHZhciBzdHIgPSAiIjsgLy8gZmluZCBhbGwgb2YgdGhlIHNwYWNlcyBpbiB0aGUgcHJldmlvdXMgc3RyaW5nCiAgICAgIC8vIHNvIHdlIGNhbiByZWFzc2VtYmxlIHRoZSB3b3JkcyBhcyB0aGV5IHdlcmUKICAgICAgLy8gKGRvZXNuJ3Qgc2VlbSBhbGwgdGhlIG5lY2Vzc2FyeSBmb3IgSFRNTCkKCiAgICAgIHZhciBvbGRfc3BhY2VzID0gc3BhY2VzKG9sZFN0cmluZyk7CiAgICAgIHZhciBuZXdfc3BhY2VzID0gc3BhY2VzKG5ld1N0cmluZyk7IC8vIGlmIHRoZSBuZXdTdHJpbmcgd2FzIGVtcHR5LAogICAgICAvLyBzdHJpa2Ugb3V0IGV2ZXJ5dGhpbmcgZnJvbSB0aGUgb2xkU3RyaW5nCgogICAgICBpZiAoZGlmZl9vdXRwdXQubmV3X3dvcmRzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgLy8gd2h5IGlzIHRoZXJlIGEgc3BlY2lhbCBjYXNlIGZvciBsZW5ndGggMD8KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpZmZfb3V0cHV0Lm9sZF93b3Jkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgc3RyICs9IG1hcmt1cC5kZWxldGVkKGRpZmZfb3V0cHV0Lm9sZF93b3Jkc1tpXSwgc2lnaWwuZGVsKSArIG9sZF9zcGFjZXNbaV07CiAgICAgICAgfQogICAgICB9IC8vIGFzc2VtYmxlIHRoZSBkaWZmZWQgc3RyaW5nIGJ5IHN0aXRjaGluZyB0b2dldGhlcgogICAgICAvLyB0aGUgb2xkU3RyaW5nIGFuZCB0aGUgbmV3U3RyaW5nLgogICAgICBlbHNlIHsKICAgICAgICAgIC8vIGZvciBhbGwgb2xkX3dvcmRzIHRoYXQgd2VyZSBkZWxldGVkCiAgICAgICAgICAvLyAoaW5kaWNhdGVkIGJ5IGEgbGFjayBvZiBhbiBvYmplY3QgYXQgdGhpcyBpbmRleCkKICAgICAgICAgIC8vIHRoaXMgbG9vcCBzdG9wcyBhcyBzb29uIGFzIGFuIG9sZCB3b3JkIG1hdGNoZXMgd2l0aAogICAgICAgICAgLy8gdGhlIG5ldyBzdHJpbmcgKGVzc2VudGlhbGx5IGp1c3QgY3JlYXRpbmcgdGhlIGRlbGV0ZWQgc3RyaW5ncwogICAgICAgICAgLy8gYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgZGlmZikKICAgICAgICAgIGZvciAobiA9IDA7IG4gPCBkaWZmX291dHB1dC5vbGRfd29yZHMubGVuZ3RoICYmIGRpZmZfb3V0cHV0Lm9sZF93b3Jkc1tuXS50ZXh0ID09IG51bGw7IG4rKykgewogICAgICAgICAgICAvLyBzdXJyb3VuZCB0aG9zZSB3b3JkcyB3L2RlbGV0ZSBpbmRpY2F0b3JzL3RhZ3MgYW5kCiAgICAgICAgICAgIC8vIGFkZCBiYWNrIGl0cyBzcGFjZXMKICAgICAgICAgICAgc3RyICs9IG1hcmt1cC5kZWxldGVkKGRpZmZfb3V0cHV0Lm9sZF93b3Jkc1tuXSArIG9sZF9zcGFjZXNbbl0sIHNpZ2lsLmRlbCk7CiAgICAgICAgICB9IC8vIGZvciBhbGwgd29yZHMgaW4gdGhlIG5ld1N0cmluZwoKCiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpZmZfb3V0cHV0Lm5ld193b3Jkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBpZiB0aGUgd29yZCBkaWQgbm90IG1hdGNoIGFueSBpbiB0aGUgb2xkU3RyaW5nCiAgICAgICAgICAgIGlmIChkaWZmX291dHB1dC5uZXdfd29yZHNbaV0udGV4dCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgLy8gc3Vycm91bmQgdGhlIHdvcmQgdy9pbnNlcnQgaW5kaWNhdG9ycy90YWdzCiAgICAgICAgICAgICAgLy8gYW5kIGFkZCBiYWNrIGl0cyBzcGFjZXMKICAgICAgICAgICAgICBzdHIgKz0gbWFya3VwLmluc2VydGVkKGRpZmZfb3V0cHV0Lm5ld193b3Jkc1tpXSwgc2lnaWwuaW5zKSArIG5ld19zcGFjZXNbaV07CiAgICAgICAgICAgIH0gLy8gaWYgdGhlIHdvcmQgZGlkIG1hdGNoIHdpdGggdGhlIG9sZFN0cmluZwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBwcmUgPSAiIjsKCiAgICAgICAgICAgICAgICBmb3IgKG4gPSBkaWZmX291dHB1dC5uZXdfd29yZHNbaV0ucm93ICsgMTsgbiA8IGRpZmZfb3V0cHV0Lm9sZF93b3Jkcy5sZW5ndGggJiYgZGlmZl9vdXRwdXQub2xkX3dvcmRzW25dLnRleHQgPT0gbnVsbDsgbisrKSB7CiAgICAgICAgICAgICAgICAgIHByZSArPSBtYXJrdXAuZGVsZXRlZChkaWZmX291dHB1dC5vbGRfd29yZHNbbl0sIHNpZ2lsLmRlbCkgKyBvbGRfc3BhY2VzW25dOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHN0ciArPSBkaWZmX291dHB1dC5uZXdfd29yZHNbaV0udGV4dCArIG5ld19zcGFjZXNbaV0gKyBwcmU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKC9cJHNwYWNlYmFyXCQvZywgJyAnKTsgLy8gdGhpcy5tZXJnZV9hZGphY2VudCgnZGVsJykKICAgICAgLy8gdGhpcy5tZXJnZV9hZGphY2VudCgnaW5zJykKCiAgICAgIHJldHVybiBzdHI7CiAgICB9LAogICAgcHJlcGFyZV90ZXh0OiBmdW5jdGlvbiBwcmVwYXJlX3RleHQoc3RyaW5nKSB7CiAgICAgIHN0cmluZyA9IHRoaXMucmVtb3ZlX2V4dHJhX3NwYWNlcyhzdHJpbmcpOwogICAgICBzdHJpbmcgPSB0aGlzLnByZXBhcmVfbWFya2Rvd24oc3RyaW5nKTsKICAgICAgcmV0dXJuIHN0cmluZzsKICAgIH0sCiAgICByZW1vdmVfZXh0cmFfc3BhY2VzOiBmdW5jdGlvbiByZW1vdmVfZXh0cmFfc3BhY2VzKHN0cmluZykgewogICAgICAvLyByZXBsYWNlIGV4dHJhIGVuZC1vZi1saW5lIHNwYWNlcwogICAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoL1xzKyQvLCAnJyk7CiAgICB9LAogICAgcHJlcGFyZV9tYXJrZG93bjogZnVuY3Rpb24gcHJlcGFyZV9tYXJrZG93bihzdHJpbmcpIHsKICAgICAgLy8gd2UgZG9uJ3Qgd2FudCB0byBzcGxpdCB1cCBtYXJrdXAtc3R5bGUgbGlua3MKICAgICAgLy8gc28gd2UncmUgcmVwbGFjaW5nIHNwYWNlcwogICAgICB2YXIgbGlua19yZSA9IC9ccyg/PVteXFtdKlxdKS9nOwogICAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UobGlua19yZSwgJyRzcGFjZWJhciQnKTsKICAgIH0sCiAgICBtZXJnZV9hZGphY2VudDogZnVuY3Rpb24gbWVyZ2VfYWRqYWNlbnQodHlwZSkgewogICAgICB2YXIgc3BhbnMgPSAkKHR5cGUpOwoKICAgICAgZm9yICh2YXIgaSA9IHNwYW5zLmxlbmd0aCAtIDI7IGkgPj0gMDsgLS1pKSB7CiAgICAgICAgdmFyIHNwYW4gPSBzcGFuc1tpXTsKICAgICAgICB2YXIgbmV4dHNwYW4gPSBzcGFuc1tpICsgMV07CiAgICAgICAgbWVyZ2Uoc3BhbiwgbmV4dHNwYW4pOwogICAgICB9CiAgICB9LAogICAgbWVyZ2U6IGZ1bmN0aW9uIG1lcmdlKHNwYW4sIG5leHRzcGFuKSB7CiAgICAgIHZhciBmb2xsb3dlciA9IHNwYW4ubmV4dFNpYmxpbmc7CiAgICAgIHZhciBjb25jYXQgPSB0cnVlOwoKICAgICAgd2hpbGUgKGZvbGxvd2VyICYmIGZvbGxvd2VyICE9IG5leHRzcGFuKSB7CiAgICAgICAgaWYgKGZvbGxvd2VyLm5vZGVOYW1lICE9ICcjdGV4dCcpIHsKICAgICAgICAgIGNvbmNhdCA9IGZhbHNlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICB2YXIgbGVuID0gZm9sbG93ZXIuZGF0YS50cmltKCkubGVuZ3RoOwoKICAgICAgICBpZiAobGVuID4gMCkgewogICAgICAgICAgY29uY2F0ID0gZmFsc2U7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGZvbGxvd2VyID0gZm9sbG93ZXIubmV4dFNpYmxpbmc7CiAgICAgIH0KCiAgICAgIGlmIChjb25jYXQpIHsKICAgICAgICAkKHNwYW4pLnRleHQoJChzcGFuKS50ZXh0KCkgKyAiICIgKyAkKGZvbGxvd2VyKS50ZXh0KCkpOwogICAgICAgICQoZm9sbG93ZXIpLnJlbW92ZSgpOwogICAgICB9CiAgICB9CiAgfTsKICBleHBvcnRzLmRpZmZlciA9IGRpZmZlcjsKfSkodHlwZW9mIGV4cG9ydHMgPT09ICd1bmRlZmluZWQnID8gdGhpcyA6IGV4cG9ydHMpOw=="},{"version":3,"sources":["D:/project/codictation.2.7/codictation/src/diff.js"],"names":["exports","spaces","str","match","concat","markup","deleted","marker","start","escape","end","inserted","retrieve","obj","keys","reduce","a","x","build_word_index","words_array","i","rows","o","push","word","frequency","wordHash","connect","words","row","connectedRow","text","exists","index","connectUnchangedWords","diff","old_hash","old_words","new_hash","new_words","chainMatchingWords","forEach","newWord","length","reverse","differ","stringToWords","prepare_text","split","parse","oldString","newString","sigil","undefined","ins","del","diff_output","old_spaces","new_spaces","n","pre","replace","string","remove_extra_spaces","prepare_markdown","link_re","merge_adjacent","type","spans","$","span","nextspan","merge","follower","nextSibling","nodeName","len","data","trim","remove"],"mappings":"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","sourcesContent":[";(function (exports) {\n\n  var spaces = function(str) {\n    var spaces = str.match(/\\s+/g);\n    if (spaces == null) {\n      spaces = [];\n    }\n    return spaces.concat(\"\\n\");\n  };\n\n  var markup = {\n    deleted: function(str, marker) {\n      return marker.start + escape(str) + marker.end;\n    },\n\n    inserted: function(str, marker) {\n      return marker.start + escape(str) + marker.end;\n    }\n  };\n\n  var retrieve = function(obj, keys) {\n    return keys.reduce(function(a, x) {\n      return a && a[x];\n    }, obj);\n  };\n\n  var build_word_index = function(words_array) {\n    return words_array.reduce(function(a, x, i) {\n      a[x] = a[x] || { rows: [], o: null };\n      a[x].rows.push(i);\n      return a;\n    }, {});\n  };\n\n  var word = {\n    frequency: function(wordHash, word) {\n      return retrieve(wordHash, [word, \"rows\", \"length\"])\n    },\n\n    connect: function(words, row, connectedRow) {\n      words[row] = { text: words[row], row: connectedRow };\n    },\n\n    exists: function(words, index) {\n      return retrieve(words, [index, \"text\"]) != null;\n    }\n  };\n\n  var connectUnchangedWords = function(diff) {\n    var old_hash = build_word_index(diff.old_words);\n    var new_hash = build_word_index(diff.new_words);\n\n    // for each word in the new text\n    // when the word appears in only once in both hashes\n    // add a new object to the diff.new_words and diff.old_words\n    // arrays that contains the index of that word in the other array\n    // along with the text of the word\n    for ( var i in new_hash ) {\n      if (word.frequency(new_hash, i) === 1 && word.frequency(old_hash, i) === 1) {\n        // assume these words are unchanged matches\n        word.connect(diff.new_words, new_hash[i].rows[0], old_hash[i].rows[0]);\n        word.connect(diff.old_words, old_hash[i].rows[0], new_hash[i].rows[0]);\n      }\n    }\n  };\n\n  var chainMatchingWords = function(diff) {\n    // try to find consecutive matching words.\n    // this step is essentially trying to find\n    // the best string of matches when a word\n    // has been used more than once\n    diff.new_words.forEach(function(newWord, i) {\n      if (word.exists(diff.new_words, i)\n          && !word.exists(diff.new_words, i + 1) // and the next word is so-far unmatched\n          // and we haven't passed the end of the diff.old_words\n          && newWord.row + 1 < diff.old_words.length\n          && !word.exists(diff.old_words, newWord.row + 1)\n          // and the next word is the same in the diff.old_words\n          && diff.new_words[i + 1] == diff.old_words[ newWord.row + 1 ]) {\n        // chain current word to next in diff.new_words and diff.old_words\n        word.connect(diff.new_words, i + 1, newWord.row + 1);\n        word.connect(diff.old_words, newWord.row + 1, i + 1);\n      }\n    });\n  };\n\n  var diff =  function(old_words, new_words) {\n    var diff = {\n      old_words: old_words,\n      new_words: new_words\n    };\n\n    connectUnchangedWords(diff);\n    chainMatchingWords(diff);\n    diff.old_words.reverse();\n    diff.new_words.reverse();\n    chainMatchingWords(diff);\n    diff.old_words.reverse();\n    diff.new_words.reverse();\n    return diff;\n  };\n\n  var differ = {\n    stringToWords: function(str) {\n      str = this.prepare_text(str);\n      return str == \"\" ? [] : str.split(/\\s+/);\n    },\n\n    parse: function(oldString, newString, sigil) {\n      // set sigil defaults if not passed\n      if (sigil === undefined) {\n        sigil =\n        {\n          ins:\n          {\n            start: '<ins>',\n            end: '</ins>'\n          },\n          del:\n          {\n            start: '<del>',\n            end: '</del>'\n          },\n        };\n      }\n\n\n      // pass arrays of new and old words to diff method\n      // diff method returns output of the diff\n      var diff_output = diff(this.stringToWords(oldString), this.stringToWords(newString));\n      // console.log('=======', diff_output)\n      var str = \"\";\n\n      // find all of the spaces in the previous string\n      // so we can reassemble the words as they were\n      // (doesn't seem all the necessary for HTML)\n      var old_spaces = spaces(oldString);\n      var new_spaces = spaces(newString);\n\n      // if the newString was empty,\n      // strike out everything from the oldString\n      if (diff_output.new_words.length == 0) { // why is there a special case for length 0?\n        for (var i = 0; i < diff_output.old_words.length; i++) {\n          str += markup.deleted((diff_output.old_words[i]), sigil.del) + old_spaces[i];\n        }\n      }\n      // assemble the diffed string by stitching together\n        // the oldString and the newString.\n      else {\n        // for all old_words that were deleted\n        // (indicated by a lack of an object at this index)\n        // this loop stops as soon as an old word matches with\n        // the new string (essentially just creating the deleted strings\n        // at the beginning of the diff)\n        for (n = 0;\n             n < diff_output.old_words.length\n             && diff_output.old_words[n].text == null;\n             n++)\n        {\n          // surround those words w/delete indicators/tags and\n          // add back its spaces\n\n          str += markup.deleted((diff_output.old_words[n]) + old_spaces[n], sigil.del);\n        }\n\n        // for all words in the newString\n        for ( var i = 0; i < diff_output.new_words.length; i++ ) {\n          // if the word did not match any in the oldString\n          if (diff_output.new_words[i].text == null) {\n            // surround the word w/insert indicators/tags\n            // and add back its spaces\n            str += markup.inserted((diff_output.new_words[i]), sigil.ins) + new_spaces[i];\n          }\n          // if the word did match with the oldString\n          else {\n            var pre = \"\";\n\n            for (\n                  n = diff_output.new_words[i].row + 1;\n                  n < diff_output.old_words.length\n                  && diff_output.old_words[n].text == null;\n                  n++\n                )\n            {\n\n              pre += markup.deleted((diff_output.old_words[n]), sigil.del) + old_spaces[n];\n            }\n            str += diff_output.new_words[i].text + new_spaces[i] + pre;\n          }\n        }\n      }\n\n      str = str.replace(/\\$spacebar\\$/g, ' ')\n\n      // this.merge_adjacent('del')\n      // this.merge_adjacent('ins')\n      return str;\n    },\n\n    prepare_text: function(string) {\n      string = this.remove_extra_spaces(string);\n      string = this.prepare_markdown(string);\n      return string;\n    },\n\n    remove_extra_spaces: function(string) {\n      // replace extra end-of-line spaces\n      return string.replace(/\\s+$/, '');\n    },\n\n    prepare_markdown: function(string) {\n      // we don't want to split up markup-style links\n      // so we're replacing spaces\n      var link_re = /\\s(?=[^\\[]*\\])/g;\n      return string.replace(link_re, '$spacebar$');\n    },\n\n\n    merge_adjacent: function(type) {\n      var spans = $(type);\n      for ( var i = spans.length - 2; i >= 0; --i)\n      {\n         var span = spans[i];\n         var nextspan = spans[i + 1];\n\n         merge(span, nextspan);\n      }\n    },\n\n    merge: function(span, nextspan) {\n      var follower = span.nextSibling;\n      var concat = true;\n       while (follower && follower != nextspan)\n       {\n         if (follower.nodeName != '#text')\n         {\n           concat = false;\n           break;\n         }\n         var len = follower.data.trim().length;\n         if (len > 0)\n         {\n           concat = false;\n           break;\n         }\n\n         follower = follower.nextSibling;\n       }\n\n      if (concat)\n      {\n        $(span).text($(span).text() + \" \" + $(follower).text());\n        $(follower).remove();\n      }\n    }\n  }\n\n\n\n\n  exports.differ = differ\n\n}(typeof exports === 'undefined' ? this : exports));\n"]}]}