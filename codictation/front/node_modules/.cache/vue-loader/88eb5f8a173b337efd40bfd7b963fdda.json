{"remainingRequest":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\src\\components\\profile\\mycomments.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\src\\components\\profile\\mycomments.vue","mtime":1615185347198},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.transform-quasar-imports.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.auto-import.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.2\\codictation\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG5hbWU6ICIiLCAvL+W9k+WJjeeUqOaIt+eahOeUqOaIt+WQjQogICAgICAgICAgICB1c2VySWQ6ICIiLCAvL+W9k+WJjeeUqOaIt+eahF9pZCAg5Y+v5qC55o2u6L+Z5Lik5Liq5L+h5oGv5Y675pWw5o2u5bqTVXNlcuWPluaVsOaNrgogICAgICAgICAgICBhcGk6ICIvYXBpIiwKICAgICAgICAgICAgY29tbWVudExpc3Q6IFtdLAogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgLy8g6L+b5YWl5Yiw5Lu75Yqh6K+m5oOF6aG16Z2iCiAgICAgICAgaW50b1Rhc2soaW5kZXgpIHsKICAgICAgICAgICAgdmFyIGRpZmZJZCA9IHRoaXMuY29tbWVudExpc3RbaW5kZXhdLnRhc2tJZDsgLy/ku7vliqFfaWQKICAgICAgICAgICAgdmFyIHBhdGggPSAiL2RpZmYvIiArIGRpZmZJZDsKICAgICAgICAgICAgdGhpcy4kYXhpb3MuZ2V0KHRoaXMuYXBpICsgIi9jdXJyZW50VGFzaz9faWQ9IiArIGRpZmZJZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLor6Xku7vliqHlt7Looqvlj5HluIPogIXliKDpmaTvvIEiLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLXJpZ2h0IiwKICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDEwMCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHBhdGgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdGhpcy5uYW1lID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgidXNlck5hbWUiKTsKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLm5hbWUpOwogICAgICAgIHRoaXMuJGF4aW9zLmdldCh0aGlzLmFwaSArICIvcHJvZmlsZT9uYW1lPSIgKyB0aGlzLm5hbWUpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICB0aGlzLnVzZXJJZCA9IHJlcy5kYXRhWzBdLl9pZDsgLy/mib7lnLDmlrnkv53lrZgKICAgICAgICAgICAgdmFyIG15Q29tbWVudHMgPSByZXMuZGF0YVswXS5teUNvbW1lbnRzIC8vIOS7juaVsOaNruW6k+S4reiOt+WPluKAnG15Q29tbWVudHPigJ3lr7nosaHmlbDnu4QKICAgICAgICAgICAgY29uc29sZS5sb2coIm15Q29tbWVudHMiLCBteUNvbW1lbnRzKTsKCiAgICAgICAgICAgIC8vIOagueaNruebuOWQjOeahHRhc2tUaXRsZe+8jOWQiOW5tuKAnG15Q29tbWVudHPigJ3mlbDnu4TvvIzlvaLmiJDmlrDmlbDnu4TigJxjb21tZW50TGlzdOKAnQogICAgICAgICAgICB2YXIgY29tbWVudHNJbmZvID0ge307CiAgICAgICAgICAgIG15Q29tbWVudHMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIHZhciB7IHRhc2tUaXRsZSB9ID0gaXRlbTsKICAgICAgICAgICAgICAgIGlmICghY29tbWVudHNJbmZvW3Rhc2tUaXRsZV0pIHsKICAgICAgICAgICAgICAgICAgICBjb21tZW50c0luZm9bdGFza1RpdGxlXSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGFza1RpdGxlLAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrUHVibGlzaGVyOiBpdGVtLnRhc2tQdWJsaXNoZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tJZDogaXRlbS50YXNrSWQsCiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkOiBbXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbW1lbnRzSW5mb1t0YXNrVGl0bGVdLmNoaWxkLnB1c2goewogICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ6IGl0ZW0uY29tbWVudCwKICAgICAgICAgICAgICAgICAgICB0aW1lOiBpdGVtLnRpbWUsCiAgICAgICAgICAgICAgICAgICAgcmVwbGllczogaXRlbS5yZXBseSwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5jb21tZW50TGlzdCA9IE9iamVjdC52YWx1ZXMoY29tbWVudHNJbmZvKTsKICAgICAgICB9KTsKICAgIH0sCn0K"},{"version":3,"sources":["mycomments.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"mycomments.vue","sourceRoot":"src/components/profile","sourcesContent":["<template>\n<div class=\"q-pa-md\">\n    <h1>Comments</h1>\n    <div v-if=\"commentList.length > 0\" class=\"q-pa-md\" style=\"max-width: 85%\">\n        <q-list v-for=\"(item, index) in commentList\" :key=\"index\" v-model=\"commentList\">\n            <q-expansion-item popup default-opened :caption=\"item.taskPublisher\" :content-inset-level=\"0.5\">\n                <template v-slot:header>\n                    <q-item-section avatar>\n                        <q-avatar icon=\"assignment\" color=\"primary\" text-color=\"white\" />\n                    </q-item-section>\n\n                    <q-item-section>\n                        {{ item.taskTitle }}\n                        <span class=\"text-grey text-caption\">By {{ item.taskPublisher }}</span>\n                    </q-item-section>\n\n                    <q-item-section side>\n                        <div class=\"row items-center\">\n                            <q-btn flat style=\"color: #FF0080\" label=\"View Details\" @click=\"intoTask(index)\"/>\n                        </div>\n                    </q-item-section>\n                </template>\n                <q-separator />\n                <q-card v-for=\"(subItem, i) in item.child\" :key=\"i\">\n                    <q-card-section class=\"row\">\n                        <q-item-section side>\n                            <q-icon name=\"comment\" class=\"text-purple\" style=\"font-size: 1.35em\" />\n                        </q-item-section>\n                        <q-item-section class=\"comment-box\">\n                            {{ subItem.comment }}\n                        </q-item-section>\n                        <q-item-section side>\n                            {{ subItem.time }}\n                        </q-item-section>\n                    </q-card-section>\n                    <div v-if=\"subItem.replies.length > 0\">\n                        <q-expansion-item expand-separator icon=\"reply_all\" :content-inset-level=\"0.5\" label=\"View All Replies\" header-class=\"text-grey-6\">\n                            <q-separator />\n                            <q-card  v-for=\"(repItem, key) in subItem.replies\" :key=\"key\">\n                                <q-card-section class=\"row\">\n                                    <q-item-section side>\n                                        <q-icon name=\"question_answer\" class=\"text-purple\" style=\"font-size: 1.35em\" />\n                                    </q-item-section>\n                                    <q-item-section class=\"comment-box\">\n                                        <span><em class=\"text-bold\">{{ repItem.responder }}</em> --- {{ repItem.comment }}</span>\n                                    </q-item-section>\n                                    <q-item-section side>\n                                        {{ repItem.time }}\n                                    </q-item-section>\n                                </q-card-section>\n                            </q-card>\n                        </q-expansion-item>\n                    </div>\n                    <q-separator />\n                </q-card>\n            </q-expansion-item>\n        </q-list>\n    </div>\n    <div v-else>你还没发过任何评论哟~快去发表你的评论吧！</div>\n</div>\n</template>\n\n<script>\n\nexport default {\n    data() {\n        return {\n            name: \"\", //当前用户的用户名\n            userId: \"\", //当前用户的_id  可根据这两个信息去数据库User取数据\n            api: \"/api\",\n            commentList: [],\n        }\n    },\n    methods: {\n        // 进入到任务详情页面\n        intoTask(index) {\n            var diffId = this.commentList[index].taskId; //任务_id\n            var path = \"/diff/\" + diffId;\n            this.$axios.get(this.api + \"/currentTask?_id=\" + diffId).then((res) => {\n                if (res.data.length == 0) {\n                this.$notify({\n                    type: \"warning\",\n                    message: \"该任务已被发布者删除！\",\n                    position: \"top-right\",\n                    offset: 100,\n                });\n                } else {\n                this.$router.push(path);\n                }\n            });\n        },\n    },\n    created() {\n        this.name = sessionStorage.getItem(\"userName\");\n        console.log(this.name);\n        this.$axios.get(this.api + \"/profile?name=\" + this.name).then((res) => {\n            this.userId = res.data[0]._id; //找地方保存\n            var myComments = res.data[0].myComments // 从数据库中获取“myComments”对象数组\n            console.log(\"myComments\", myComments);\n\n            // 根据相同的taskTitle，合并“myComments”数组，形成新数组“commentList”\n            var commentsInfo = {};\n            myComments.forEach((item, index) => {\n                var { taskTitle } = item;\n                if (!commentsInfo[taskTitle]) {\n                    commentsInfo[taskTitle] = {\n                        taskTitle,\n                        taskPublisher: item.taskPublisher,\n                        taskId: item.taskId,\n                        child: []\n                    }\n                }\n                commentsInfo[taskTitle].child.push({\n                    comment: item.comment,\n                    time: item.time,\n                    replies: item.reply,\n                });\n            });\n            this.commentList = Object.values(commentsInfo);\n        });\n    },\n}\n</script>\n\n<style>\n.comment-box {\n    justify-content: flex-start;\n}\n.q-item__section.column.q-item__section--main.justify-center {\n    flex-direction: column;\n}\n</style>\n"]}]}