{"remainingRequest":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\src\\components\\profile\\mycomments.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\src\\components\\profile\\mycomments.vue","mtime":1618040466531},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.transform-quasar-imports.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.auto-import.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.8\\codictation\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG5hbWU6ICIiLCAvL+W9k+WJjeeUqOaIt+eahOeUqOaIt+WQjQogICAgICAgICAgICB1c2VySWQ6ICIiLCAvL+W9k+WJjeeUqOaIt+eahF9pZCAg5Y+v5qC55o2u6L+Z5Lik5Liq5L+h5oGv5Y675pWw5o2u5bqTVXNlcuWPluaVsOaNrgogICAgICAgICAgICBhcGk6ICIvYXBpIiwKICAgICAgICAgICAgY29tbWVudExpc3Q6IFtdLAogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgLy8g6L+b5YWl5Yiw5Lu75Yqh6K+m5oOF6aG16Z2iCiAgICAgICAgaW50b1Rhc2soaW5kZXgpIHsKICAgICAgICAgICAgdmFyIGRpZmZJZCA9IHRoaXMuY29tbWVudExpc3RbaW5kZXhdLnRhc2tJZDsgLy/ku7vliqFfaWQKICAgICAgICAgICAgdmFyIHBhdGggPSAiL2RpZmYvIiArIGRpZmZJZDsKICAgICAgICAgICAgdGhpcy4kYXhpb3MuZ2V0KHRoaXMuYXBpICsgIi9jdXJyZW50VGFzaz9faWQ9IiArIGRpZmZJZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJUaGUgdGFzayBoYXMgYmVlbiBkZWxldGVkLiIsCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtcmlnaHQiLAogICAgICAgICAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2gocGF0aCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICB0aGlzLm5hbWUgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ1c2VyTmFtZSIpOwogICAgICAgIGNvbnNvbGUubG9nKHRoaXMubmFtZSk7CiAgICAgICAgdGhpcy4kYXhpb3MuZ2V0KHRoaXMuYXBpICsgIi9wcm9maWxlP25hbWU9IiArIHRoaXMubmFtZSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIHRoaXMudXNlcklkID0gcmVzLmRhdGFbMF0uX2lkOyAvL+aJvuWcsOaWueS/neWtmAogICAgICAgICAgICB2YXIgbXlDb21tZW50cyA9IHJlcy5kYXRhWzBdLm15Q29tbWVudHMgLy8g5LuO5pWw5o2u5bqT5Lit6I635Y+W4oCcbXlDb21tZW50c+KAneWvueixoeaVsOe7hAogICAgICAgICAgICBjb25zb2xlLmxvZygibXlDb21tZW50cyIsIG15Q29tbWVudHMpOwoKICAgICAgICAgICAgLy8g5qC55o2u55u45ZCM55qEdGFza1RpdGxl77yM5ZCI5bm24oCcbXlDb21tZW50c+KAneaVsOe7hO+8jOW9ouaIkOaWsOaVsOe7hOKAnGNvbW1lbnRMaXN04oCdCiAgICAgICAgICAgIHZhciBjb21tZW50c0luZm8gPSB7fTsKICAgICAgICAgICAgbXlDb21tZW50cy5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgeyB0YXNrVGl0bGUgfSA9IGl0ZW07CiAgICAgICAgICAgICAgICBpZiAoIWNvbW1lbnRzSW5mb1t0YXNrVGl0bGVdKSB7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudHNJbmZvW3Rhc2tUaXRsZV0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tUaXRsZSwKICAgICAgICAgICAgICAgICAgICAgICAgdGFza1B1Ymxpc2hlcjogaXRlbS50YXNrUHVibGlzaGVyLAogICAgICAgICAgICAgICAgICAgICAgICB0YXNrSWQ6IGl0ZW0udGFza0lkLAogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZDogW10KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb21tZW50c0luZm9bdGFza1RpdGxlXS5jaGlsZC5wdXNoKHsKICAgICAgICAgICAgICAgICAgICBjb21tZW50OiBpdGVtLmNvbW1lbnQsCiAgICAgICAgICAgICAgICAgICAgdGltZTogaXRlbS50aW1lLAogICAgICAgICAgICAgICAgICAgIHJlcGxpZXM6IGl0ZW0ucmVwbHksCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuY29tbWVudExpc3QgPSBPYmplY3QudmFsdWVzKGNvbW1lbnRzSW5mbyk7CiAgICAgICAgfSk7CiAgICB9LAp9Cg=="},{"version":3,"sources":["mycomments.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"mycomments.vue","sourceRoot":"src/components/profile","sourcesContent":["<template>\n<q-page class=\"q-pa-md\">\n    <h3 class=\"q-my-md\">Comments</h3>\n    <q-separator insert style=\"width: 55%\" />\n    <div v-if=\"commentList.length > 0\" class=\"q-pa-md\" style=\"max-width: 85%\">\n        <q-list v-for=\"(item, index) in commentList\" :key=\"index\" v-model=\"commentList\">\n            <q-expansion-item popup default-opened :caption=\"item.taskPublisher\" :content-inset-level=\"0.5\">\n                <template v-slot:header>\n                    <q-item-section avatar>\n                        <q-avatar icon=\"assignment\" color=\"primary\" text-color=\"white\" />\n                    </q-item-section>\n\n                    <q-item-section>\n                        {{ item.taskTitle }}\n                        <span class=\"text-grey text-caption\">By {{ item.taskPublisher }}</span>\n                    </q-item-section>\n\n                    <q-item-section side>\n                        <div class=\"row items-center\">\n                            <q-btn flat color=\"pink-4\" label=\"View Details\" @click=\"intoTask(index)\"/>\n                        </div>\n                    </q-item-section>\n                </template>\n                <q-separator />\n                <q-card v-for=\"(subItem, i) in item.child\" :key=\"i\">\n                    <q-card-section class=\"row\">\n                        <q-item-section side>\n                            <q-icon name=\"comment\" class=\"text-purple\" style=\"font-size: 1.35em\" />\n                        </q-item-section>\n                        <q-item-section class=\"comment-box\">\n                            {{ subItem.comment }}\n                        </q-item-section>\n                        <q-item-section side>\n                            {{ subItem.time }}\n                        </q-item-section>\n                    </q-card-section>\n                    <div v-if=\"subItem.replies.length > 0\">\n                        <q-expansion-item expand-separator icon=\"reply_all\" :content-inset-level=\"0.5\" label=\"View All Replies\" header-class=\"text-grey-6\">\n                            <q-separator />\n                            <q-card  v-for=\"(repItem, key) in subItem.replies\" :key=\"key\">\n                                <q-card-section class=\"row\">\n                                    <q-item-section side>\n                                        <q-icon name=\"question_answer\" class=\"text-purple\" style=\"font-size: 1.35em\" />\n                                    </q-item-section>\n                                    <q-item-section class=\"comment-box\">\n                                        <span><em class=\"text-bold\">{{ repItem.responder }}</em> --- {{ repItem.comment }}</span>\n                                    </q-item-section>\n                                    <q-item-section side>\n                                        {{ repItem.time }}\n                                    </q-item-section>\n                                </q-card-section>\n                            </q-card>\n                        </q-expansion-item>\n                    </div>\n                    <q-separator />\n                </q-card>\n            </q-expansion-item>\n        </q-list>\n    </div>\n    <div v-else>No comment yet...</div>\n</q-page>\n</template>\n\n<script>\n\nexport default {\n    data() {\n        return {\n            name: \"\", //当前用户的用户名\n            userId: \"\", //当前用户的_id  可根据这两个信息去数据库User取数据\n            api: \"/api\",\n            commentList: [],\n        }\n    },\n    methods: {\n        // 进入到任务详情页面\n        intoTask(index) {\n            var diffId = this.commentList[index].taskId; //任务_id\n            var path = \"/diff/\" + diffId;\n            this.$axios.get(this.api + \"/currentTask?_id=\" + diffId).then((res) => {\n                if (res.data.length == 0) {\n                this.$notify({\n                    type: \"warning\",\n                    message: \"The task has been deleted.\",\n                    position: \"top-right\",\n                    offset: 100,\n                });\n                } else {\n                this.$router.push(path);\n                }\n            });\n        },\n    },\n    created() {\n        this.name = sessionStorage.getItem(\"userName\");\n        console.log(this.name);\n        this.$axios.get(this.api + \"/profile?name=\" + this.name).then((res) => {\n            this.userId = res.data[0]._id; //找地方保存\n            var myComments = res.data[0].myComments // 从数据库中获取“myComments”对象数组\n            console.log(\"myComments\", myComments);\n\n            // 根据相同的taskTitle，合并“myComments”数组，形成新数组“commentList”\n            var commentsInfo = {};\n            myComments.forEach((item) => {\n                var { taskTitle } = item;\n                if (!commentsInfo[taskTitle]) {\n                    commentsInfo[taskTitle] = {\n                        taskTitle,\n                        taskPublisher: item.taskPublisher,\n                        taskId: item.taskId,\n                        child: []\n                    }\n                }\n                commentsInfo[taskTitle].child.push({\n                    comment: item.comment,\n                    time: item.time,\n                    replies: item.reply,\n                });\n            });\n            this.commentList = Object.values(commentsInfo);\n        });\n    },\n}\n</script>\n\n<style>\n.comment-box {\n    justify-content: flex-start;\n}\n.q-item__section.column.q-item__section--main.justify-center {\n    flex-direction: column;\n}\n</style>\n"]}]}