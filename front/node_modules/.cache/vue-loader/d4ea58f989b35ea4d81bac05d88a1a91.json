{"remainingRequest":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\src\\components\\diff.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\src\\components\\diff.vue","mtime":1615816885558},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.transform-quasar-imports.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\node_modules\\vue-cli-plugin-quasar\\lib\\loader.auto-import.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\codictation\\collection\\final project\\codictation\\codictation2.0\\codictation.2.3\\codictation\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGltcG9ydCB7IHZlcnNpb24gfSBmcm9tICd4bHN4L3R5cGVzJzsKaW1wb3J0IEF2YXRhciBmcm9tICJ2dWUtYXZhdGFyIjsKCnZhciBkaWZmZXIgPSByZXF1aXJlKCIuLi9kaWZmLmpzIikuZGlmZmVyOwp2YXIgewogIGNvdW50VGVjaFNjb3JlcywKICBjb3VudE1hdGNoUG9pbnRzLAogIGxpbmVhclJlZywKfSA9IHJlcXVpcmUoIi4uL2NvdW50U2NvcmVzLmpzIik7CgpsZXQgbXVzaWNJbnRlcnZhbCA9IG51bGw7CmxldCBwbGF5ZXI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXJTdGF0dXM6IDAsCiAgICAgIGlzcmVhZG9ubHk6IHRydWUsCiAgICAgIGlzVGVhY2hlcjogZmFsc2UsCiAgICAgIHRleHQxOiAiIiwgLy/lvZPliY3nlKjmiLfkvZzkuLrnrKzkuIDkuKrnlKjmiLfmj5DkuqTnmoTnrKzkuIDniYjmnKwKICAgICAgaXN2ZXJzaW9uMTogZmFsc2UsIC8v5Yik5pat5piv5ZCm5pyJ56ys5LiA5Liq54mI5pysCiAgICAgIGlzRmluYWw6IGZhbHNlLCAvL+WIpOaWreaYr+WQpuacieS/ruaUueiusOW9leWPr+S7peeUn+aIkOe7vOWQiOeJiOacrAogICAgICB0ZXh0X3YxOiAiIiwgLy/ku47mlbDmja7lupPlj5blvpfnmoTnrKzkuIDkuKrnlKjmiLfmj5DkuqTnmoTnrKzkuIDniYjmnKzvvIzlj6/og73kuI50ZXh0MeS4jeS4gOagtwogICAgICB0ZXh0X2ZuOiAiIiwKICAgICAgaXNlZGl0OiBmYWxzZSwgLy/mjqfliLbmmK/lkKbmmL7npLrkv67mlLnmoYYKICAgICAgdGV4dERpdjogIiIsIC8v5b2T5YmN6aG16Z2i55qEdGV4dERpdueahOWAvCwg6K6w5b2V5b2T5YmN55So5oi355qE5L+u5pS554mI5pysCiAgICAgIGN1cnJlbnRDb21wYXJlVGV4dDogIiIsIC8v5b2T5YmN6aG16Z2i55qEdGV4dERpdueahOWAvCwg55So5p2l5YGa5q+U6L6D5Z+656GACiAgICAgIHNlbnRlbmNlczogW10sIC8v56ys5LiA5Liq55So5oi35o+Q5Lqk55qE56ys5LiA54mI5pys55qE5YiG5Y+l57uT5p6cCiAgICAgIHVzZXJuYW1lOiAiIiwKICAgICAgZGlmZkxpc3Q6IFtdLAogICAgICB0YWJsZURhdGE6IFtdLCAvL+WIhumhteebuOWFswogICAgICBzZW5UYWJsZURhdGE6IFtdLCAvL+WPpeWtkOeJiOacrOebuOWFswogICAgICBwYWdlc2l6ZTogMywgLy/kv67mlLnliIbpobXnm7jlhbMKICAgICAgY3VycnBhZ2U6IDEsIC8v5L+u5pS55YiG6aG155u45YWzCiAgICAgIHBhZ2VzaXplUzogMSwgLy/lj6XlrZDniYjmnKzliIbpobXnm7jlhbMKICAgICAgY3VycnBhZ2VTOiAxLCAvL+WPpeWtkOeJiOacrOWIhumhteebuOWFswogICAgICBpc0FjdGl2ZTogZmFsc2UsCiAgICAgIHNlZW46IGZhbHNlLAogICAgICB0ZW1waW5kZXg6IDAsCiAgICAgIGN1cnJlbnQ6IDAsCiAgICAgIGRpZmZJZDogIiIsIC8v5b2T5YmN5Lu75Yqh55qEX2lkCiAgICAgIGZpbGVOYW1lOiAiIiwKICAgICAgdXNlckxpc3Q6IFtdLAogICAgICBpblVzZXJMaXN0OiBmYWxzZSwKICAgICAgYXBpOiAiL2FwaSIsCiAgICAgIHBsYXllcjogIiIsIC8v5pKt5pS+5ZmoCiAgICAgIHJhdGVTZWxlY3RlZDogIjEuMCIsIC8v5pKt5pS+6YCf5bqmCiAgICAgIGlzVmlkZW86IGZhbHNlLCAvL+aWh+S7tuexu+Wei+aYr+WQpuS4uuinhumikQogICAgICB2aWRlb1R5cGU6IFsiQVZJIiwgImJhaXdtYSIsICJybXZiIiwgInJtIiwgImZsYXNoIiwgIm1wNCIsICJtaWQiLCAiM0dQIl0sIC8v6KeG6aKR57G75Z6LCiAgICAgIHNlbnRlbmNlTGlzdDogW10sIC8v6I635b6X5Y675o6J5qCH562+5LmL5ZCO5ZCE5Y+l5a2Q55qE57u85ZCI54mI5pys77yM6YGN5Y6G5aGr5YWF5L+u5pS55qGGCiAgICAgIGZpbmFsX2NvbnRleHQ6IFtdLAogICAgICBkYkxpc3Q6IFtdLAogICAgICByZWd0ZXN0OiAvWzxpbnM+fDxkZWw+fDxzdWJpbnM+XS9nLAogICAgICBsb2FkaW5nOiB0cnVlLCAvL+WKoOi9veWKqOeUuwogICAgICBwdWJsaXNoZXI6ICIiLAogICAgICBzdGF0dXM6ICIxIiwKICAgICAgaWRlbnRpdHk6ICIiLAogICAgICBzdWJtaXR0ZWQ6IFtdLCAvL+W3suaPkOS6pOS/ruaUueeahOWQjeWNlQogICAgICBpc0FkZGl0aW9uOiBmYWxzZSwgLy/mmK/lkKbmmL7npLrlop7liqDlj6XlrZDnmoTmlofmnKzmoYblkozmjInpkq4KICAgICAgYWRkaXRpb246ICIiLCAvL+WinuWKoOeahOWGheWuuQogICAgICBhdXRvcGxheTogZmFsc2UsIC8v5o6n5Yi26KeG6aKR6Ieq5Yqo5pKt5pS+CiAgICAgIHRhc2tUaXRsZTogIiIsCiAgICAgIGRlYWRsaW5lOiAiIiwKICAgICAgcHVibGlzaFRpbWU6ICIiLAogICAgICBpc1RpbWVsaW5lOiBmYWxzZSwKICAgICAgdmVyc2lvbnM6IFtdLAogICAgICByZXZlcnNlOiB0cnVlLAogICAgICB0YXNrTGFiZWxzOiBbXSwKICAgICAgdXNlcklkOiAiIiwKICAgICAgdmVyc2lvbnNMaXN0OiAiIiwgLy/lnKhjcmVhdGVk5Lit5LuO5ZCO5Y+w6I635Y+W5pWw5o2uCiAgICAgIHRlY2hTY29yZUxpc3Q6IHt9LCAvL+e7n+iuoeavj+S4quS6uuW+l+WIsOeahOaKgOacr+WIhgogICAgICBtYXRjaFNjb3JlTGlzdDoge30sIC8v57uf6K6h5q+P5Liq5Lq65b6X5Yiw55qE5Yy56YWN5YiGCiAgICAgIHRlY2hMaXN0OiBbXSwKICAgICAgbWF0Y2hMaXN0OiBbXSwKICAgICAgc2NvcmVMaXN0OiBbXSwgLy/mgLvliIYKICAgICAgY291bnRNYXRjaFNjb3JlczogW10sCiAgICAgIHRlY2hQb2ludHM6IDYwLCAvL+aAu+eahOaKgOacr+WIhgogICAgICBtYXRjaFBvaW50czogNDAsIC8v5oC755qE5Yy56YWN5YiGCiAgICAgIHNjb3JlczogIuWIhuaVsOaaguacquWFrOW4g++8jOaIquatouaXpeacn+WQjuWGjeadpeafpeeci+WQp34iLAogICAgICBhdmVyU2NvcmVzOiAiIiwgLy/lubPlnYfliIYKICAgICAgaXNQdWJsaXNoZXI6IGZhbHNlLAogICAgICBpc1N1Ym1pdHRlZDogZmFsc2UsCiAgICAgIHRhc2tDb2luczogMCwgLy/mr4/kuKrku7vliqHlj6/ojrflvpfnmoTph5HluIEKICAgICAgbXlSYW5rOiAiIiwKICAgICAgdGltZXNwYW46IDAsIC8vdmlkZW/mkq3mlL7lrp7pmYXml7bpl7QKICAgICAgaXNDb3VudFRpbWU6IGZhbHNlLCAvL+aYr+WQpuiuoeaXtgogICAgICBpc01hbnVhbDogIiIsIC8v5piv5ZCm6Ieq5Yqo6K6h566X5YiG5pWwCiAgICAgIGlzQ29uZmlybTogIiIsCiAgICAgIHZpZGVvSWQ6ICdiSmwtYXZqUmd6VScsCiAgICAgIGFydGlzdDogIlBhcmNlbHMiLAogICAgICB0aXRsZTogIkxpZ2h0ZW51cCIsCiAgICAgIGR1cmF0aW9uOiAxNzgsCiAgICAgIGN1cnJlbnRUaW1lOiAwLAogICAgICBpc1BsYXlpbmc6IGZhbHNlCiAgICB9OwogIH0sCiAgY29tcG9uZW50OiB7CiAgICBBdmF0YXIsCiAgfSwKICBjb21wdXRlZDogewoJCXJlY29yZEltYWdlKCkgewoJCQlyZXR1cm4gYGh0dHBzOi8vaW1nLnlvdXR1YmUuY29tL3ZpLyR7dGhpcy52aWRlb0lkfS9zZGRlZmF1bHQuanBnYDsKCQl9LAoJCXBlcmNlbnRhZ2UoKSB7CgkJCXJldHVybiB0aGlzLmN1cnJlbnRUaW1lIC8gdGhpcy5kdXJhdGlvbiAqIDEwMDsKCQl9LAoJCXNob3dQbGF5VGltZSgpIHsKCQkJY29uc3QgbSA9IHRoaXMuZ2V0TWludXRlcyh0aGlzLmR1cmF0aW9uKTsKCQkJY29uc3QgcyA9IHRoaXMuZ2V0U2Vjb25kcyh0aGlzLmR1cmF0aW9uKTsKCQkJcmV0dXJuIGAke219OiR7c31gOwoJCX0sCgkJc2hvd0N1cnJlbnRQbGF5VGltZSgpIHsKCQkJY29uc3QgbSA9IHRoaXMuZ2V0TWludXRlcyh0aGlzLmN1cnJlbnRUaW1lKTsKCQkJY29uc3QgcyA9IHRoaXMuZ2V0U2Vjb25kcyh0aGlzLmN1cnJlbnRUaW1lKTsKCgkJCXJldHVybiBgJHttfToke3N9YDsKCQl9Cgl9LAoJd2F0Y2g6IHsKCQljdXJyZW50VGltZSh0aW1lKSB7CgkJCWlmIChNYXRoLnJvdW5kKHRpbWUgKyAxKSA+PSB0aGlzLmR1cmF0aW9uKSB7CgkJCQl0aGlzLnRvZ2dsZVBsYXkoKTsKCQkJCXRoaXMuY3VycmVudFRpbWUgPSAwOwoJCQkJcGxheWVyLnN0b3BWaWRlbygpOwoJCQl9CgkJfQoJfSwKICBtZXRob2RzOiB7CiAgICBwcmV2KCkgewoJCQlpZihwbGF5ZXIpIHsKCQkJCXBsYXllci5wcmV2aW91c1ZpZGVvKCk7CgkJCX0KCQl9LAkJCgkJbmV4dCgpIHsKCQkJaWYocGxheWVyKSB7CgkJCQljb25zb2xlLmxvZyhwbGF5ZXIsIHBsYXllci5nZXRWaWRlb1VybCgpLnNwbGl0KCc/dj0nKVsxXSkKCQkJCXBsYXllci5uZXh0VmlkZW8oKTsKCQkJfQoJCX0sCgkJanVtcFRvKGUpIHsKCQkJY29uc3QgdHJhY2tQZXJjZW50YWdlID0gKGUubGF5ZXJYIC8gdGhpcy4kcmVmcy50aW1lbGluZS5vZmZzZXRXaWR0aCkgKiAxMDA7CgkJCQoJCQl0aGlzLnBsYXlBdCh0aGlzLmR1cmF0aW9uIC8gMTAwICogdHJhY2tQZXJjZW50YWdlKTsKCQl9LAoJCXBsYXlBdChzZWNvbmRzKSB7CgkJCWlmKHBsYXllcikgewoJCQkJcGxheWVyLnNlZWtUbyhzZWNvbmRzKTsKCQkJCXRoaXMuY3VycmVudFRpbWUgPSBzZWNvbmRzOwoJCQkJCgkJCQlpZighdGhpcy5pc1BsYXlpbmcpIHsKCQkJCQl0aGlzLnRvZ2dsZVBsYXkoKTsKCQkJCX0KCQkJfQoJCX0sCgkJZ2V0TWludXRlcyhzZWNvbmRzKSB7CgkJCWNvbnN0IG0gPSBNYXRoLmZsb29yKChzZWNvbmRzICUgMzYwMCkgLyA2MCk7CgkJCXJldHVybiBtOwoJCX0sCgkJZ2V0U2Vjb25kcyhzZWNvbmRzKSB7CgkJCWNvbnN0IHMgPSBNYXRoLmZsb29yKChzZWNvbmRzICUgMzYwMCkgJSA2MCk7CgkJCXJldHVybiAocyA8PSA5ID8gIjAiIDogIiIpICsgczsKCQl9LAoJCWludGVydmFsKCkgewoJCQl0aGlzLmN1cnJlbnRUaW1lID0gIXBsYXllciA/IHRoaXMuY3VycmVudFRpbWUgOiBNYXRoLnJvdW5kKHBsYXllci5nZXRDdXJyZW50VGltZSgpKTsKCQl9LAoJCXRvZ2dsZVBsYXkoKSB7CgkJCWlmICghdGhpcy5pc1BsYXlpbmcpIHsKCQkJCW11c2ljSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh0aGlzLmludGVydmFsLCAxMDAwKTsKCQkJCXBsYXllci5wbGF5VmlkZW8oKTsKCQkJCXBsYXllci51bk11dGUoKTsKCQkJfSBlbHNlIHsKCQkJCWNsZWFySW50ZXJ2YWwobXVzaWNJbnRlcnZhbCk7CgkJCQlwbGF5ZXIucGF1c2VWaWRlbygpOwoJCQl9CgoJCQl0aGlzLmlzUGxheWluZyA9ICF0aGlzLmlzUGxheWluZzsKCQl9LAoKICAgIHRlbXBzYXZlKCkgewogICAgICB0aGlzLiRheGlvcwogICAgICAgIC5nZXQodGhpcy5hcGkgKyAiL2N1cnJlbnRUYXNrP19pZD0iICsgdGhpcy5kaWZmSWQpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy51c2VyTGlzdCA9IHJlcy5kYXRhWzBdLnVzZXJMaXN0OwogICAgICAgICAgdmFyIGlzTmFtZSA9IGZhbHNlOwogICAgICAgICAgZm9yICh2YXIgdWggPSAwOyB1aCA8IHRoaXMudXNlckxpc3QubGVuZ3RoOyB1aCsrKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnVzZXJuYW1lID09IHRoaXMudXNlckxpc3RbdWhdLm5hbWUpIHsKICAgICAgICAgICAgICBpc05hbWUgPSB0cnVlOwogICAgICAgICAgICAgIHRoaXMudXNlckxpc3RbdWhdLm15X3NlbnRlbmNlcyA9IHRoaXMuc2VudGVuY2VMaXN0OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAvL+WmguaenOayoeacieWImeWinuWKoAogICAgICAgICAgaWYgKGlzTmFtZSA9PSBmYWxzZSkgewogICAgICAgICAgICB0aGlzLnVzZXJMaXN0LnB1c2goewogICAgICAgICAgICAgIG5hbWU6IHRoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgbXlfc2VudGVuY2VzOiB0aGlzLnNlbnRlbmNlTGlzdCwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy4kYXhpb3MucG9zdCh0aGlzLmFwaSArICIvdGVtcHNhdmUiLCB7CiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIF9pZDogdGhpcy5kaWZmSWQsCiAgICAgICAgICAgICAgdXNlckxpc3Q6IHRoaXMudXNlckxpc3QsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgbWVzc2FnZTogIuaaguaXtuS/neWtmOaIkOWKnyIsCiAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLXJpZ2h0IiwKICAgICAgICAgICAgb2Zmc2V0OiAxMDAsCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuaXNlZGl0ID0gZmFsc2U7CiAgICAgICAgfSk7CiAgICB9LAogICAgcmV0dXJuYmFjaygpIHsKICAgICAgaWYgKHRoaXMuc3VibWl0dGVkLmluZGV4T2YodGhpcy51c2VybmFtZSkgPj0gMCkgewogICAgICAgIGlmICh0aGlzLnN1Ym1pdHRlZC5pbmRleE9mKHRoaXMudXNlcm5hbWUpID09IDApIHsKICAgICAgICAgIGlmICh0aGlzLnN1Ym1pdHRlZC5pbmRleE9mKHRoaXMudXNlcm5hbWUsIDEpID09IC0xKSB7CiAgICAgICAgICAgIHZhciB1c2VyX2luZGV4ID0gdGhpcy51c2VyTGlzdC5maW5kSW5kZXgoCiAgICAgICAgICAgICAgKGF0dHIpID0+IGF0dHIubmFtZSA9PSB0aGlzLnVzZXJuYW1lCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmICh1c2VyX2luZGV4ID49IDApIHsKICAgICAgICAgICAgICB0aGlzLmlzZWRpdCA9IHRydWU7CiAgICAgICAgICAgICAgdGhpcy5zZW50ZW5jZUxpc3QgPSB0aGlzLnVzZXJMaXN0W3VzZXJfaW5kZXhdLm15X3NlbnRlbmNlczsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmlzZWRpdCA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICAvLyB0aXRsZTogIuitpuWRiiIsCiAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5oqx5q2J77yM5rKh5pyJ5oKo55qE5Y6G5Y+y6K6w5b2V77yBIiwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLXJpZ2h0IiwKICAgICAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmlzZWRpdCA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgICAgIC8vIHRpdGxlOiAi6K2m5ZGKIiwKICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgbWVzc2FnZTogIuaKseatie+8jOaCqOW3suaPkOS6pOi/h++8gSIsCiAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtcmlnaHQiLAogICAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5pc2VkaXQgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIC8vIHRpdGxlOiAi6K2m5ZGKIiwKICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICBtZXNzYWdlOiAi5oqx5q2J77yM5oKo5bey5o+Q5Lqk6L+H77yBIiwKICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtcmlnaHQiLAogICAgICAgICAgICBvZmZzZXQ6IDEwMCwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgdXNlcl9pbmRleCA9IHRoaXMudXNlckxpc3QuZmluZEluZGV4KAogICAgICAgICAgKGF0dHIpID0+IGF0dHIubmFtZSA9PSB0aGlzLnVzZXJuYW1lCiAgICAgICAgKTsKICAgICAgICBpZiAodXNlcl9pbmRleCA+PSAwKSB7CiAgICAgICAgICB0aGlzLnNlbnRlbmNlTGlzdCA9IHRoaXMudXNlckxpc3RbdXNlcl9pbmRleF0ubXlfc2VudGVuY2VzOwogICAgICAgICAgdGhpcy5pc2VkaXQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmlzZWRpdCA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgLy8gdGl0bGU6ICLorablkYoiLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIG1lc3NhZ2U6ICLmirHmrYnvvIzmsqHmnInmgqjnmoTljoblj7LorrDlvZXvvIEiLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc2hvd1RpbWVsaW5lKCkgewogICAgICB0aGlzLiRheGlvcwogICAgICAgIC5nZXQodGhpcy5hcGkgKyAiL2FsbFZlcnNpb25zP19pZD0iICsgdGhpcy5kaWZmSWQpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgLy8gY29uc29sZS5sb2coInJlcyBkYXRhIiwgcmVzLmRhdGEpOwogICAgICAgICAgdGhpcy52ZXJzaW9ucyA9IHJlcy5kYXRhOwogICAgICAgICAgaWYgKHRoaXMudmVyc2lvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICB0aGlzLmlzVGltZWxpbmUgPSB0cnVlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgICAvLyB0aXRsZTogIuitpuWRiiIsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIG1lc3NhZ2U6ICLlvZPliY3ku7vliqHov5jmsqHmnInkurrlrozmiJAiLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLXJpZ2h0IiwKICAgICAgICAgICAgICBvZmZzZXQ6IDEwMCwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgY2xvc2VUaW1lbGluZSgpIHsKICAgICAgdGhpcy5pc1RpbWVsaW5lID0gZmFsc2U7CiAgICB9LAogICAgLy/kvb/nlKhkb2N1bWVudC5xdWVyeVNlbGVjdG9y5a6e546w6ZSa54K555qE5pWI5p6cCiAgICB0b0Jlc3QoaWROYW1lKSB7CiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaWROYW1lKS5zY3JvbGxJbnRvVmlldyh0cnVlKTsKICAgIH0sCiAgICAvL+WbnuWIsOmhtumDqAogICAgdG9Ub3AoKSB7CiAgICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDA7CiAgICB9LAogICAgLy/mta7moYYKICAgIGNoYW5nZVBvcyhldmVudCkgewogICAgICB2YXIgd29yZE9wZXJhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgid29yZE9wZXJhdGUiKTsKICAgICAgd29yZE9wZXJhdGUuc3R5bGUucG9zaXRpb24gPSAiZml4ZWQiOwogICAgICB3b3JkT3BlcmF0ZS5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7CiAgICAgIHdvcmRPcGVyYXRlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICJ3aGl0ZSI7CiAgICAgIGlmIChldmVudC5jbGllbnRYIDwgd2luZG93LnNjcmVlbi53aWR0aCAvIDIpIHsKICAgICAgICB3b3JkT3BlcmF0ZS5zdHlsZS5sZWZ0ID0gZXZlbnQuY2xpZW50WCArIDUgKyAicHgiOwogICAgICB9IGVsc2UgewogICAgICAgIHdvcmRPcGVyYXRlLnN0eWxlLmxlZnQgPSBldmVudC5jbGllbnRYIC0gd29yZE9wZXJhdGUub2Zmc2V0V2lkdGggKyAicHgiOwogICAgICB9CgogICAgICBpZiAoZXZlbnQuY2xpZW50WSA+IHdpbmRvdy5zY3JlZW4uaGVpZ2h0IC8gMikgewogICAgICAgIHdvcmRPcGVyYXRlLnN0eWxlLnRvcCA9IGV2ZW50LmNsaWVudFkgLSB3b3JkT3BlcmF0ZS5vZmZzZXRIZWlnaHQgKyAicHgiOwogICAgICB9IGVsc2UgewogICAgICAgIHdvcmRPcGVyYXRlLnN0eWxlLnRvcCA9IGV2ZW50LmNsaWVudFkgKyAicHgiOwogICAgICB9CiAgICB9LAogICAgLy/noa7lrprmmK/pn7PpopHmkq3mlL7lmajov5jmmK/op4bpopHmkq3mlL7lmagKICAgIGRlY2lkZVBsYXllcigpIHsKICAgICAgaWYgKHRoaXMuaXNWaWRlbykgewogICAgICAgIHRoaXMucGxheWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3ZpZGVvID4gdmlkZW8iKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhdWRpbyIpOwogICAgICB9CiAgICB9LAogICAgLy/mjqfliLbmkq3mlL7pgJ/luqYKICAgIC8vIGhhbmRsZVNwZWVkKCkgewogICAgLy8gICB0aGlzLnBsYXllci5wbGF5YmFja1JhdGUgPSB0aGlzLnJhdGVTZWxlY3RlZDsKICAgIC8vIH0sCiAgICAvL+aOp+WItuWQjumAgDEw56eSCiAgICBnb0JhY2soKSB7CiAgICAgIHRoaXMucGxheWVyLmN1cnJlbnRUaW1lIC09IDEwOwogICAgfSwKICAgIC8v5o6n5Yi25YmN6L+bMTDnp5IKICAgIGdvRm9yd2FyZCgpIHsKICAgICAgdGhpcy5wbGF5ZXIuY3VycmVudFRpbWUgKz0gMTA7CiAgICB9LAogICAgLy/liIbpobXnm7jlhbMKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMuY3VycnBhZ2UgPSB2YWw7CiAgICB9LAogICAgLy/liIbpobXnm7jlhbMKICAgIGhhbmRsZVNpemVDaGFuZ2UodmFsKSB7CiAgICAgIHRoaXMucGFnZXNpemUgPSB2YWw7CiAgICB9LAogICAgLy/liIbpobXnm7jlhbMKICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2VTKHZhbCkgewogICAgICB0aGlzLmN1cnJwYWdlUyA9IHZhbDsKICAgIH0sCiAgICAvL+WIhumhteebuOWFswogICAgaGFuZGxlU2l6ZUNoYW5nZVModmFsKSB7CiAgICAgIHRoaXMucGFnZXNpemVTID0gdmFsOwogICAgfSwKICAgIC8v5o+Q5Lqk56ys5LiA5Lu977yM5Y+q5omn6KGM5LiA5qyh77yM5L2G5Lya5Yaz5a6a5pWw5o2u5bqT55qE57uT5p6ECiAgICBzdWJtaXR2MSgpIHsKICAgICAgLy/ojrflvpflvZPliY3ml7bpl7QKICAgICAgLy8gbGV0IGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAvLyBsZXQgbmV3ZGF0ZSA9IGRhdGUudG9Mb2NhbGVTdHJpbmcoImNoaW5lc2UiLCB7CiAgICAgIC8vICAgaG91cjEyOiBmYWxzZSwKICAgICAgLy8gfSk7CgogICAgICBsZXQgbmV3ZGF0ZSA9IHRoaXMuJG1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQoIllZWVkvTU0vREQgSEg6bW06c3MiKTsKCiAgICAgIHZhciBmbGFnID0gdHJ1ZTsKICAgICAgdmFyIHJlZ3N0ciA9IC8oW0EtWmEtejAtOVwnXCJcIVw/XC1cOlw7XC5cLFwlXCRcJlxbIFxdXSkvOwogICAgICB2YXIgbGltaXRlZF93b3JkcyA9IDA7CiAgICAgIHRoaXMuJGF4aW9zCiAgICAgICAgLmdldCh0aGlzLmFwaSArICIvY3VycmVudFRhc2s/X2lkPSIgKyB0aGlzLmRpZmZJZCkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBsaW1pdGVkX3dvcmRzID0gcmVzLmRhdGFbMF0ud29yZHM7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhsaW1pdGVkX3dvcmRzKTsKICAgICAgICAgIHZhciB2aWRlb19pZCA9IHJlcy5kYXRhWzBdLnZpZGVvSWQ7IC8v5a+55bqU6KeG6aKR55qEX2lkCiAgICAgICAgICB2YXIgYXV0aGNvZGUgPSByZXMuZGF0YVswXS5hdXRoY29kZTsgLy/lr7nlupTku7vliqHnmoTpqozor4HnoIEKICAgICAgICAgIC8v6L6T5YWl55qE5YaF5a656Z2e56m6CiAgICAgICAgICBpZiAodGhpcy50ZXh0MSkgewogICAgICAgICAgICB2YXIgdF9sZW5ndGggPSB0aGlzLnRleHQxLnNwbGl0KCIgIikubGVuZ3RoOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0X2xlbmd0aCkKICAgICAgICAgICAgaWYgKHRfbGVuZ3RoID4gbGltaXRlZF93b3JkcykgewogICAgICAgICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgdGhpcy50ZXh0MS5sZW5ndGg7IGErKykgewogICAgICAgICAgICAgICAgdmFyIHJlZ1Jlc3VsdCA9IHJlZ3N0ci50ZXN0KHRoaXMudGV4dDFbYV0pOwogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIi0tLS0tMSIsIHJlZ1Jlc3VsdCk7CiAgICAgICAgICAgICAgICBpZiAocmVnUmVzdWx0ID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiYWFhIik7CiAgICAgICAgICAgICAgICAgIGZsYWcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImZsYWciLCBmbGFnKTsKICAgICAgICAgICAgICBpZiAoZmxhZykgewogICAgICAgICAgICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAgICAgICAgICAgLnBvc3QodGhpcy5hcGkgKyAiL3VwZGF0ZVZlcnNpb24iLCB7CiAgICAgICAgICAgICAgICAgICAgLy/mlbTnr4fmm7TmlrDliLDniYjmnKzliJfooagKICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICAgIF9pZDogdGhpcy5kaWZmSWQsCiAgICAgICAgICAgICAgICAgICAgICB0aW1lOiBuZXdkYXRlLAogICAgICAgICAgICAgICAgICAgICAgbmV3X3ZlcnNpb246IHRoaXMudGV4dDEsCiAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdGhpcy51c2VySWQsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJhYWEiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRheGlvcwogICAgICAgICAgICAgICAgICAgICAgLmdldCh0aGlzLmFwaSArICIvY3VycmVudFRhc2s/X2lkPSIgKyB0aGlzLmRpZmZJZCkKICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIjExMSIpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpZmZMaXN0ID0gcmVzLmRhdGFbMF0uZGlmZkxpc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJkaWZmTGlzdDEiLCB0aGlzLmRpZmZMaXN0KQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXJMaXN0ID0gcmVzLmRhdGFbMF0udXNlckxpc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRpZmZMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQodGhpcy5hcGkgKyAiL2FsbFZlcnNpb25zP19pZD0iICsgdGhpcy5kaWZmSWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJyZXMgZGF0YSIsIHJlcy5kYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG93bmVyID0gcmVzLmRhdGFbMF0ubmFtZTsgLy/nrKzkuIDkuKrmj5DkuqTnmoTnlKjmiLcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG93bmVyID09IHRoaXMudXNlcm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIuWujOaIkOWQrOWGmeiOt+W+lzXph5HluIHvvIznrKzkuIDkuKrlrozmiJDpop3lpJblho3ojrflvpc16YeR5biBIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLXJpZ2h0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXNlckxpc3QuaW5kZXhPZigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VyTGlzdC5maW5kKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvYmopID0+IG9iai5uYW1lID09IG93bmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT0gLTEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXNlckxpc3QucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG93bmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteV9zZW50ZW5jZXM6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0dGVkLnB1c2gob3duZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGF4aW9zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwaSArICIvcHJvZmlsZT9uYW1lPSIgKyB0aGlzLnVzZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSByZXMuZGF0YVswXS5faWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyVGFza3MgPSByZXMuZGF0YVswXS5teVRhc2tzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyVGFza3MucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFza0lkOiB0aGlzLmRpZmZJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWRlb0lkOiB2aWRlb19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWFkbGluZTogdGhpcy5kZWFkbGluZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoY29kZTogYXV0aGNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMudGFza1RpdGxlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0aGlzLnRhc2tMYWJlbHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29yZXM6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5pu05paw55So5oi34oCcbXlUYXNrc+KAnQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRheGlvcy5wb3N0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpICsgIi91cGRhdGVNeVRhc2tzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiB1c2VySWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15VGFza3M6IHVzZXJUYXNrcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRpdGxlOiAi6K2m5ZGKIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICLpnZ7luLjpgZfmhr7vvIzlt7LmnInlhbbku5bnlKjmiLfmj5DkuqTlvZPliY3ku7vliqHnmoTnrKwx5Liq54mI5pys77yB5LiL5qyh5Yqg5rK5KOC4hyDigKJf4oCiKeC4hyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDEwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzdmVyc2lvbjEgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRfdjEgPSByZXMuZGF0YVswXS52ZXJzaW9uOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlmZkxpc3QxID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5YiG5Y+l5bm25a2Y5YKo5Yiw5pWw5o2u5bqT5LitCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VudGVuY2VzID0gdGhpcy50ZXh0X3YxLnNwbGl0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8oPzw9W15BLVpdLlsuP10pICsoPz1bQS1aXSkvZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnNlbnRlbmNlcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbiA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuIDwgdGhpcy5zZW50ZW5jZXMubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB3b3JkcyA9IHRoaXMuc2VudGVuY2VzW3Nlbl0uc3BsaXQoIiAiKTsgLy/liIbor40KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+WOu+aOieepuuWAvAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgd29yZHMubGVuZ3RoOyB5KyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3b3Jkc1t5XSA9PSAiIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3Jkcy5zcGxpY2UoeSwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSB5IC0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdvcmRfbGlzdCA9IFtdOyAvL+WIhuivjeWIl+ihqO+8jOWMheaLrOeUqOaIt+WIl+ihqAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuYW1lcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyX2l0ZW0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXR0aW1lOiBuZXdkYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXMucHVzaCh1c2VyX2l0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHdvciA9IDA7IHdvciA8IHdvcmRzLmxlbmd0aDsgd29yKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3b3JkSXRlbSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5kZXg6IHdvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29yZDogd29yZHNbd29yXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZnM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmOiB3b3Jkc1t3b3JdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IG5hbWVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogMCwgLy8wPT7ljp/or43vvIzmsqHkv67mlLnvvIzliJ3lp4vlgLzvvJsxPT7lop7liqDvvJsyPT7mnInlop7mnInliKDvvJstMT0+5Yig6ZmkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNlZGl0ZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2ZpcnN0OiB0cnVlLCAvL+ebuOWvueesrOS4gOeJiO+8jOeUqOS6juWMuuWIhuaUueeJiOaYr+WQpuS4uuWinuWKoOeahOWGheWuuQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmRfbGlzdC5wdXNoKHdvcmRJdGVtKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mlrDmlLnliqgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VudGVuY2VfaXRlbSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRlbmNlczogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHRoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2U6IHRoaXMuc2VudGVuY2VzW3Nlbl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3Jkczogd29yZF9saXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB0aGlzLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2VEaWZmczogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHRoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2VEaWZmOiB0aGlzLnNlbnRlbmNlc1tzZW5dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZMaXN0MS5wdXNoKHNlbnRlbmNlX2l0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyX2luZGV4ID0gdGhpcy51c2VyTGlzdC5maW5kSW5kZXgoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGF0dHIpID0+IGF0dHIubmFtZSA9PSB0aGlzLnVzZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXNlckxpc3RbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9pbmRleAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLm15X3NlbnRlbmNlcyA9IHRoaXMuc2VudGVuY2VzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVmZkxpc3QyIiwgZGlmZkxpc3QxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRheGlvcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wb3N0KHRoaXMuYXBpICsgIi91cGRhdGVkaWZmIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lsIbliIbor43liIblj6Xnu5Pmnpzmm7TmlrDliLDmlbDmja7lupMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHRoaXMuZGlmZklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmTGlzdDogZGlmZkxpc3QxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyTGlzdDogdGhpcy51c2VyTGlzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0dGVkOiB0aGlzLnN1Ym1pdHRlZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiLS0tLS0tLSIgKyByZXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy4kcm91dGVyLmdvKDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuY3JlYXRlRmluYWxWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jcmVhdGVGaW5hbFZlcnNpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzdmVyc2lvbjEgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNGaW5hbCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lvaLmiJDnu7zlkIjniYjmnKwKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jcmVhdGVGaW5hbFZlcnNpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGl0bGU6ICLorablkYoiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIumdnuW4uOmBl+aGvu+8jOW3suacieWFtuS7lueUqOaIt+aPkOS6pOW9k+WJjeS7u+WKoeeahOesrDHkuKrniYjmnKzvvIHkuIvmrKHliqDmsrko4LiHIOKAol/igKIp4LiHIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAidG9wLXJpZ2h0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oMCk7CiAgICAgICAgICAgICAgICAvLyB0aGlzLmNyZWF0ZUZpbmFsVmVyc2lvbigpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhmbGFnKTsKICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICAgIC8vIHRpdGxlOiAi6K2m5ZGKIiwKICAgICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5o+Q5Lqk5YaF5a655YyF5ZCr6Z2e5rOV5a2X56ym77yM6K+35qOA5p+l5L+u5pS55ZCO5YaN5o+Q5Lqk77yBIiwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtcmlnaHQiLAogICAgICAgICAgICAgICAgICBvZmZzZXQ6IDEwMCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgICAgICAgLy8gdGl0bGU6ICLorablkYoiLAogICAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgICAgbWVzc2FnZTogIuWtl+aVsOWwkeS6juW9k+WJjeS7u+WKoemZkOWItueahCIgKyBsaW1pdGVkX3dvcmRzICsgIuivje+8gSIsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICAgICAgICBvZmZzZXQ6IDEwMCwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy/ovpPlhaXnmoTlhoXlrrnkuLrnqboKICAgICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgICAvLyB0aXRsZTogIuitpuWRiiIsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAgICAgICAgIG1lc3NhZ2U6ICLor7fph43mlrDnoa7orqTvvIzmgqjlubbmnKrovpPlhaXlhoXlrrnlk6Z+IiwKICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICAgICAgb2Zmc2V0OiAxMDAsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oMCk7IC8v5Yi35paw6aG16Z2iCiAgICB9LAogICAgLy/miZPlvIDlop7liqDlj6XlrZDnvJbovpHpnaLmnb8KICAgIGVkaXR2MSgpIHsKICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICB0aXRsZTogIlRpcCIsCiAgICAgICAgbWVzc2FnZTogIuavj+asoeWPquiDveWinuWKoOS4gOS4quWPpeWtkOWTpu+8gSIsCiAgICAgICAgcG9zaXRpb246ICJ0b3AtcmlnaHQiLAogICAgICAgIG9mZnNldDogMTAwLAogICAgICB9KTsKICAgICAgdGhpcy5pc0FkZGl0aW9uID0gdHJ1ZTsKICAgICAgdGhpcy5hZGRpdGlvbiA9ICIiOwogICAgfSwKICAgIC8v54K55Ye75L+u5pS55oyJ6ZKuCiAgICBjaGFuZ2V2MSgpIHsKICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAuZ2V0KHRoaXMuYXBpICsgIi9jdXJyZW50VGFzaz9faWQ9IiArIHRoaXMuZGlmZklkKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIC8vIHRoaXMuc3VibWl0dGVkID0gcmVzLmRhdGFbMF0uc3VibWl0dGVkOwogICAgICAgICAgLy8gY29uc29sZS5sb2coImNoYW5nZXYxIHN1Ym1pdHRlZCIsIHRoaXMuc3VibWl0dGVkKTsKICAgICAgICAgIGlmICh0aGlzLnN1Ym1pdHRlZC5pbmRleE9mKHRoaXMudXNlcm5hbWUpID49IDApIHsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coCiAgICAgICAgICAgIC8vICAgInRoaXMuc3VibWl0dGVkLmluZGV4T2YodGhpcy51c2VybmFtZSkiLAogICAgICAgICAgICAvLyAgIHRoaXMuc3VibWl0dGVkLmluZGV4T2YodGhpcy51c2VybmFtZSkKICAgICAgICAgICAgLy8gKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coCiAgICAgICAgICAgIC8vICAgInRoaXMuc3VibWl0dGVkLmluZGV4T2YodGhpcy51c2VybmFtZSwgMSkiLAogICAgICAgICAgICAvLyAgIHRoaXMuc3VibWl0dGVkLmluZGV4T2YodGhpcy51c2VybmFtZSwgMSkKICAgICAgICAgICAgLy8gKTsKICAgICAgICAgICAgaWYgKHRoaXMuc3VibWl0dGVkLmluZGV4T2YodGhpcy51c2VybmFtZSkgPT0gMCkgewogICAgICAgICAgICAgIGlmICh0aGlzLnN1Ym1pdHRlZC5pbmRleE9mKHRoaXMudXNlcm5hbWUsIDEpID09IC0xKSB7CiAgICAgICAgICAgICAgICAvL+eCueWHu+S/ruaUueaMiemSrgogICAgICAgICAgICAgICAgdGhpcy5pc2VkaXQgPSB0cnVlOwogICAgICAgICAgICAgICAgLy/lvZPliY3nlKjmiLfopoHmj5DkuqTnmoTniYjmnKwKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0ZXh0RGl2IikuaW5uZXJIVE1MKTsKICAgICAgICAgICAgICAgIHRoaXMudGV4dERpdiA9IGRvY3VtZW50CiAgICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50QnlJZCgidGV4dERpdiIpCiAgICAgICAgICAgICAgICAgIC5pbm5lckhUTUwucmVwbGFjZSgvKDxzcGFuW14+XSo/Pil8KDxcL3NwYW4+KS9nLCAiIik7CiAgICAgICAgICAgICAgICAvL+eUqOS6juavlOi+g+eahOaWh+acrO+8jOWOu+mZpOagh+etvgogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Q29tcGFyZVRleHQgPSBkb2N1bWVudAogICAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudEJ5SWQoInRleHREaXYiKQogICAgICAgICAgICAgICAgICAuaW5uZXJIVE1MLnJlcGxhY2UoLyg8c3BhbltePl0qPz4pfCg8XC9zcGFuPikvZywgIiIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmlzZWRpdCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgICAgICAgLy8gdGl0bGU6ICLorablkYoiLAogICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLmirHmrYnvvIzmgqjnmoTmj5DkuqTmnLrkvJrlt7LnlKjlrozvvIEiLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuaXNlZGl0ID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgICAgIC8vIHRpdGxlOiAi6K2m5ZGKIiwKICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLmirHmrYnvvIzmgqjnmoTmj5DkuqTmnLrkvJrlt7LnlKjlrozvvIEiLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICJ0b3AtcmlnaHQiLAogICAgICAgICAgICAgICAgb2Zmc2V0OiAxMDAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8v54K55Ye75L+u5pS55oyJ6ZKuCiAgICAgICAgICAgIHRoaXMuaXNlZGl0ID0gdHJ1ZTsKICAgICAgICAgICAgLy/lvZPliY3nlKjmiLfopoHmj5DkuqTnmoTniYjmnKwKICAgICAgICAgICAgdGhpcy50ZXh0RGl2ID0gZG9jdW1lbnQKICAgICAgICAgICAgICAuZ2V0RWxlbWVudEJ5SWQoInRleHREaXYiKQogICAgICAgICAgICAgIC5pbm5lckhUTUwucmVwbGFjZSgvKDxzcGFuW14+XSo/Pil8KDxcL3NwYW4+KS9nLCAiIik7CgogICAgICAgICAgICAvL+eUqOS6juavlOi+g+eahOaWh+acrO+8jOWOu+mZpOagh+etvgogICAgICAgICAgICB0aGlzLmN1cnJlbnRDb21wYXJlVGV4dCA9IGRvY3VtZW50CiAgICAgICAgICAgICAgLmdldEVsZW1lbnRCeUlkKCJ0ZXh0RGl2IikKICAgICAgICAgICAgICAuaW5uZXJIVE1MLnJlcGxhY2UoLyg8c3BhbltePl0qPz4pfCg8XC9zcGFuPikvZywgIiIpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIC8v5Y+W5raI5L+u5pS5CiAgICBjYW5jZWxDaGFuZ2V2MSgpIHsKICAgICAgdGhpcy5pc2VkaXQgPSBmYWxzZTsKICAgIH0sCiAgICAvL+ehruWumuaVsOe7hOmHjOaYr+WQpuacieafkOS4quWFg+e0oAogICAgZmluZEVsZW0oYXJyYXlUb1NlYXJjaCwgYXR0ciwgdmFsKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXlUb1NlYXJjaC5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChhcnJheVRvU2VhcmNoW2ldW2F0dHJdID09IHZhbCkgewogICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiAtMTsKICAgIH0sCiAgICAvL+aPkOS6pOW9k+WJjeeUqOaIt+eahOeJiOacrAogICAgc3VibWl0bXYoKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oIueUqOaIt+WPquiDveaPkOS6pOS4gOasoSwg5piv5ZCm57un57utPyIsICLmj5DnpLoiLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICLnoa7lrpoiLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLAogICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICBjZW50ZXI6IHRydWUsCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIHZhciBmbGFnMSA9IHRydWU7CiAgICAgICAgdmFyIHJlZ3N0ciA9IC8oW0EtWmEtejAtOVwnXCJcIVw/XDpcLVw7XC5cLFwlXCRcJlxbIFxdXSkvOwogICAgICAgIGZvciAodmFyIHNsID0gMDsgc2wgPCB0aGlzLnNlbnRlbmNlTGlzdC5sZW5ndGg7IHNsKyspIHsKICAgICAgICAgIC8v5q+P5Liq5Y+l5a2QCiAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IHRoaXMuc2VudGVuY2VMaXN0W3NsXS5sZW5ndGg7IGMrKykgewogICAgICAgICAgICB2YXIgcmVnUmVzdWx0ID0gcmVnc3RyLnRlc3QodGhpcy5zZW50ZW5jZUxpc3Rbc2xdW2NdKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIisrKysrMyIsIHJlZ1Jlc3VsdCk7CiAgICAgICAgICAgIGlmIChyZWdSZXN1bHQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImNjYyIpOwogICAgICAgICAgICAgIGZsYWcxID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gY29uc29sZS5sb2coImZsYWcxIiwgZmxhZzEpOwogICAgICAgIGlmIChmbGFnMSkgewogICAgICAgICAgLy/ojrflvpflvZPliY3ml7bpl7QKICAgICAgICAgIC8vIGxldCBkYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAgIC8vIGxldCBuZXdkYXRlID0gZGF0ZS50b0xvY2FsZVN0cmluZygiY2hpbmVzZSIsIHsKICAgICAgICAgIC8vICAgaG91cjEyOiBmYWxzZSwKICAgICAgICAgIC8vIH0pOwogICAgICAgICAgbGV0IG5ld2RhdGUgPSB0aGlzLiRtb21lbnQobmV3IERhdGUoKSkuZm9ybWF0KCJZWVlZL01NL0REIEhIOm1tOnNzIik7CiAgICAgICAgICAvL+iOt+W+l+acgOaWsOeahOS/ruaUueWIl+ihqAogICAgICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAgICAgLmdldCh0aGlzLmFwaSArICIvY3VycmVudFRhc2s/X2lkPSIgKyB0aGlzLmRpZmZJZCkKICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuZGJMaXN0ID0gcmVzLmRhdGFbMF0uZGlmZkxpc3Q7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgLy8gY29uc29sZS5sb2coImRiRGlmZkxpc3QiLCB0aGlzLmRiTGlzdCk7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygic2VudGVuY2VMaXN0IiwgdGhpcy5zZW50ZW5jZUxpc3QpOwogICAgICAgICAgdmFyIGxpc3RMZW4gPSB0aGlzLmRiTGlzdC5sZW5ndGg7CiAgICAgICAgICAvL+S4juesrOS4gOeJiOacrOavlOi+g++8jOagueaNruWPpeWtkOeahOaVsOmHj+i/m+ihjOW+queOr++8iOS/ruaUueWQjuaPkOS6pOWGheWuueWvueW6lOeahOWPpeWtkO+8iQogICAgICAgICAgdmFyIGZpbmFsX3Jlc3VsdCA9IFtdOyAvL+iusOW9leaJgOacieeahOS/ruaUueaDheWGtQogICAgICAgICAgZm9yICh2YXIgbGVuID0gMDsgbGVuIDwgbGlzdExlbjsgbGVuKyspIHsKICAgICAgICAgICAgdmFyIHNlbl9yZXN1bHQgPSBbXTsgLy/orrDlvZXlvZPliY3lj6XlrZDnmoTkv67mlLnmg4XlhrUKICAgICAgICAgICAgdmFyIHNlbnRlbmNlID0gdGhpcy5zZW50ZW5jZUxpc3RbbGVuXQogICAgICAgICAgICAgIC5yZXBsYWNlKC9cc3syLH0vZywgIiAiKQogICAgICAgICAgICAgIC5yZXBsYWNlKC9bXHJcbl0vZywgIiAiKQogICAgICAgICAgICAgIC5yZXBsYWNlKC8oXHJcbnxcbnxccikvZywgIiAiKTsKICAgICAgICAgICAgLy/mlrDmlLnliqjvvJrmjaLmiJDot58g5pyA5paw54mI5pysIOeahCDnrKzkuIDniYjmnKzlj6XlrZAg5q+U6L6DCiAgICAgICAgICAgIHZhciB2MV9zZW50ZW5jZXMgPSB0aGlzLmRiTGlzdFtsZW5dLnNlbnRlbmNlcy5zb3J0KAogICAgICAgICAgICAgIHRoaXMuY29tcGFyZSgidGltZSIpCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJ2MV9zZW50ZW5jZXMiLCB2MV9zZW50ZW5jZXMpOwogICAgICAgICAgICB2YXIgdjFfc2VudGVuY2UgPSB2MV9zZW50ZW5jZXNbdjFfc2VudGVuY2VzLmxlbmd0aCAtIDFdLnNlbnRlbmNlOwogICAgICAgICAgICB2YXIgc19yZXN1bHQxID0gZGlmZmVyCiAgICAgICAgICAgICAgLnBhcnNlKCIgIiArIHYxX3NlbnRlbmNlLCAiICIgKyBzZW50ZW5jZSkKICAgICAgICAgICAgICAucmVwbGFjZSgvJTJDL2csICIsIikKICAgICAgICAgICAgICAucmVwbGFjZSgvJTNGL2csICI/IikKICAgICAgICAgICAgICAucmVwbGFjZSgvJTI3L2csICInIikKICAgICAgICAgICAgICAucmVwbGFjZSgvJTNBL2csICI6Iik7CiAgICAgICAgICAgIC8v5bCG5Y2V54us55qEaW5z5qCH562+5pu/5o2i5Li6ZGVsLWluc+agh+etvgogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygic19yZXN1bHQxIiwgc19yZXN1bHQxKTsKICAgICAgICAgICAgdmFyIHJlZyA9IC8oW2EtekEtWjAtOV0rW1wtXCdcLlw6XT9bYS16QS1aMC05XSpccyg8aW5zW14+XSo/Pi4qPzxcL2lucz5ccykrKS9nOwogICAgICAgICAgICB2YXIgaW5zTWF0Y2hSZXN1bHQgPSBzX3Jlc3VsdDEubWF0Y2gocmVnKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImluc01hdGNoUmVzdWx0IiwgaW5zTWF0Y2hSZXN1bHQpOwogICAgICAgICAgICBpZiAoaW5zTWF0Y2hSZXN1bHQgIT09IG51bGwpIHsKICAgICAgICAgICAgICBmb3IgKHZhciBtID0gMDsgbSA8IGluc01hdGNoUmVzdWx0Lmxlbmd0aDsgbSsrKSB7CiAgICAgICAgICAgICAgICAvL+WOu+aOieepuueahOWMuemFjee7k+aenAogICAgICAgICAgICAgICAgaWYgKGluc01hdGNoUmVzdWx0W21dID09ICIiKSB7CiAgICAgICAgICAgICAgICAgIGluc01hdGNoUmVzdWx0LnNwbGljZShtLCAxKTsKICAgICAgICAgICAgICAgICAgbSA9IG0gLSAxOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgc19yZXN1bHQxID0gc19yZXN1bHQxLnJlcGxhY2UoaW5zTWF0Y2hSZXN1bHRbbV0sICI8PiIpOyAvL+abv+aNouaIkOeJueauiueahOespuWPtyDljaDkvY0KICAgICAgICAgICAgICAgICAgdmFyIGRlbF9jb250ZW50ID0gaW5zTWF0Y2hSZXN1bHRbbV0uc3BsaXQoIiAiKVswXTsgLy/ljp/or40KICAgICAgICAgICAgICAgICAgdmFyIGVkaXRlZF92ZXIgPQogICAgICAgICAgICAgICAgICAgICI8ZGVsPiIgKwogICAgICAgICAgICAgICAgICAgIGRlbF9jb250ZW50ICsKICAgICAgICAgICAgICAgICAgICAiPC9kZWw+IDxpbnM+IiArCiAgICAgICAgICAgICAgICAgICAgZGVsX2NvbnRlbnQgKwogICAgICAgICAgICAgICAgICAgICI8L2lucz4iOwogICAgICAgICAgICAgICAgICBpbnNNYXRjaFJlc3VsdFttXSA9IGluc01hdGNoUmVzdWx0W21dLnJlcGxhY2UoCiAgICAgICAgICAgICAgICAgICAgZGVsX2NvbnRlbnQsCiAgICAgICAgICAgICAgICAgICAgZWRpdGVkX3ZlcgogICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc19yZXN1bHQxID0gc19yZXN1bHQxCiAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCI8PiIsIGluc01hdGNoUmVzdWx0W21dKQogICAgICAgICAgICAgICAgICAucmVwbGFjZSgvKFxyXG58XG58XHIpL2csICIgIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJhZnRlciIsIHNfcmVzdWx0MSk7CiAgICAgICAgICAgIHZhciBzX3Jlc3VsdF9kZWwgPSBzX3Jlc3VsdDEKICAgICAgICAgICAgICAucmVwbGFjZSgvPGluc1tePl0qPz4uKj88XC9pbnM+XHMvZywgIiIpCiAgICAgICAgICAgICAgLnJlcGxhY2UoLyhcclxufFxufFxyKS9nLCAiICIpOwogICAgICAgICAgICAvL+WOu+aOieaJgOaciWluc+agh+etvu+8jOeUqOS6juehruiupGRlbOagh+etvueahGluZGV4CiAgICAgICAgICAgIHZhciBzX3Jlc3VsdF9hcnIgPSBzX3Jlc3VsdF9kZWwKICAgICAgICAgICAgICAudHJpbSgpCiAgICAgICAgICAgICAgLnNwbGl0KC9ccy9nKQogICAgICAgICAgICAgIC5maWx0ZXIoKGQpID0+IGQpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygic19yZXN1bHRfYXJyIiwgc19yZXN1bHRfYXJyKTsKICAgICAgICAgICAgLy8g57uZIHNfcmVzdWx0X2FyciDmlbDnu4TkuK3mr4/kuKror43pg73liqDkuIDkuKppbmRleOWSjGZsYWfvvIzkvr/kuo7lkI7mnJ/mib5pbmRleAogICAgICAgICAgICB2YXIgbmV3X3NfcmVzdWx0X2FyciA9IHNfcmVzdWx0X2Fyci5tYXAoKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgdmFyIHJvYmogPSB7fTsKICAgICAgICAgICAgICByb2JqLmluZGV4ID0gaW5kZXg7CiAgICAgICAgICAgICAgcm9iai53b3JkID0gaXRlbTsKICAgICAgICAgICAgICByb2JqLmZsYWcgPSAwOwogICAgICAgICAgICAgIHJldHVybiByb2JqOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIm5ld19zX3Jlc3VsdF9hcnIiLCBuZXdfc19yZXN1bHRfYXJyKTsKICAgICAgICAgICAgLy/ljLnphY3lh7rmiYDmnInnmoTkv67mlLkKICAgICAgICAgICAgdmFyIGFsbE1hdGNoUmVzdWx0ID0gc19yZXN1bHQxLm1hdGNoKAogICAgICAgICAgICAgIC8oKDxkZWxbXj5dKj8+Lio/PFwvZGVsPlxzKSooPGluc1tePl0qPz4uKj88XC9pbnM+XHMpKikvZwogICAgICAgICAgICApOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiYWxsTWF0Y2hSZXN1bHQ6ICIsIGFsbE1hdGNoUmVzdWx0KTsKICAgICAgICAgICAgLy/lr7nmiYDmnInnmoTljLnphY3nu5PmnpzvvIjkv67mlLnvvInov5vooYzov5vkuIDmraXnmoTmlbTlkIgKICAgICAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBhbGxNYXRjaFJlc3VsdC5sZW5ndGg7IG4rKykgewogICAgICAgICAgICAgIC8v5Y675o6J56m655qE5Yy56YWN57uT5p6cCiAgICAgICAgICAgICAgaWYgKGFsbE1hdGNoUmVzdWx0W25dID09ICIiKSB7CiAgICAgICAgICAgICAgICBhbGxNYXRjaFJlc3VsdC5zcGxpY2UobiwgMSk7CiAgICAgICAgICAgICAgICBuID0gbiAtIDE7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBtYXRjaFNwbGl0ID0gYWxsTWF0Y2hSZXN1bHRbbl0KICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoIlxuIiwgIiAiKQogICAgICAgICAgICAgICAgICAucmVwbGFjZSgi4oa1IiwgIiAiKQogICAgICAgICAgICAgICAgICAudHJpbSgpCiAgICAgICAgICAgICAgICAgIC5zcGxpdCgvXHMvZyk7CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygibWF0Y2hSZXN1bHQiLCBtYXRjaFNwbGl0KTsKICAgICAgICAgICAgICAgIHZhciBkZWwgPSBbXTsKICAgICAgICAgICAgICAgIHZhciBpbnMgPSBbXTsKICAgICAgICAgICAgICAgIC8vIHZhciByZTEgPSAvPGRlbFtePl0qPz4uKj88XC9kZWw+L2c7CiAgICAgICAgICAgICAgICAvLyB2YXIgcmUyID0gLzxpbnNbXj5dKj8+Lio/PFwvaW5zPi9nOwogICAgICAgICAgICAgICAgZm9yICh2YXIgdCA9IDA7IHQgPCBtYXRjaFNwbGl0Lmxlbmd0aDsgdCsrKSB7CiAgICAgICAgICAgICAgICAgIC8v5a2Y5YKo5Yiw55u45Y+N55qE5pWw57uE77yf77yf77yfCiAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJtIik7CiAgICAgICAgICAgICAgICAgIGlmIChtYXRjaFNwbGl0W3RdLmluZGV4T2YoIjxpbnM+IikpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygi5q+P5LiqbWF0Y2hTcGxpdO+8miIsIG1hdGNoU3BsaXRbdF0pOwogICAgICAgICAgICAgICAgICAgIC8vIHZhciBkZWxfaW5kZXggPSBzX3Jlc3VsdF9hcnIuaW5kZXhPZihtYXRjaFNwbGl0W3RdKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZmluaXNoZWRJdGVtID0gbmV3X3NfcmVzdWx0X2Fyci5maW5kKAogICAgICAgICAgICAgICAgICAgICAgKGl0ZW0pID0+IGl0ZW0ud29yZCA9PSBtYXRjaFNwbGl0W3RdICYmIGl0ZW0uZmxhZyA9PSAwCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZmluaXNoZWRJdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgZmluaXNoZWRJbmRleCA9IG5ld19zX3Jlc3VsdF9hcnIuZmluZEluZGV4KAogICAgICAgICAgICAgICAgICAgICAgICAoaXRlbSkgPT4gaXRlbSA9PSBmaW5pc2hlZEl0ZW0KICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICBuZXdfc19yZXN1bHRfYXJyW2ZpbmlzaGVkSW5kZXhdLmZsYWcgPSAxOwogICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbF9pbmRleCA9IGZpbmlzaGVkSW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsX2l0ZW0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbDogbWF0Y2hTcGxpdFt0XSwKICAgICAgICAgICAgICAgICAgICAgICAgZGVsX2luZGV4OiBkZWxfaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgZGVsLnB1c2goZGVsX2l0ZW0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAobWF0Y2hTcGxpdFt0XS5pbmRleE9mKCI8ZGVsPiIpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5zLnB1c2gobWF0Y2hTcGxpdFt0XSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJkZWwgYXJyIiwgZGVsKTsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJpbnMgYXJyIiwgaW5zKTsKICAgICAgICAgICAgICAgIGlmIChpbnMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBkZWwubGVuZ3RoOyBkKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZGlmZjEgPSBkZWxbZF0uZGVsLnRyaW0oKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiYSIsIGRpZmYxKQogICAgICAgICAgICAgICAgICAgIHZhciBkZWxfY29udGVudDEgPSBkZWxbZF0uZGVsLnJlcGxhY2UoCiAgICAgICAgICAgICAgICAgICAgICAvKDxkZWxbXj5dKj8+KXwoPFwvZGVsPikvZywKICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVsX2NvbnRlbnQxIiwgZGVsX2NvbnRlbnQxKQogICAgICAgICAgICAgICAgICAgIHZhciBpdGVtMSA9IHsKICAgICAgICAgICAgICAgICAgICAgIHdvcmQ6IGRlbF9jb250ZW50MSwKICAgICAgICAgICAgICAgICAgICAgIGRpZmY6IGRpZmYxLAogICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGRlbFtkXS5kZWxfaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IC0xLCAvL+WIoOmZpAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgc2VuX3Jlc3VsdC5wdXNoKGl0ZW0xKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGRlbC5sZW5ndGggPT0gMSAmJiBpbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVsX2RlbCIsIGRlbFswXSk7CiAgICAgICAgICAgICAgICAgIHZhciBkZWxfY29udGVudDIgPSBkZWxbMF0uZGVsCiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyg8ZGVsW14+XSo/Pil8KDxcL2RlbD4pL2csICIiKQogICAgICAgICAgICAgICAgICAgIC50cmltKCk7CiAgICAgICAgICAgICAgICAgIHZhciBpbnNfY29udGVudDIgPSBpbnNbMF0ucmVwbGFjZSgKICAgICAgICAgICAgICAgICAgICAvKDxpbnNbXj5dKj8+KXwoPFwvaW5zPikvZywKICAgICAgICAgICAgICAgICAgICAiIgogICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVsX2NvbnRlbnQyIiwgZGVsX2NvbnRlbnQyKTsKICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImluc19jb250ZW50MiIsIGluc19jb250ZW50Mik7CiAgICAgICAgICAgICAgICAgIHZhciBkaWZmMiA9IGRlbFswXS5kZWwudHJpbSgpICsgaW5zLmpvaW4oIiAiKTsKICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1czIgPSAyOyAvL+S/ruaUuQogICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgZGVsX2NvbnRlbnQyID09IGluc19jb250ZW50MiB8fAogICAgICAgICAgICAgICAgICAgIGRlbF9jb250ZW50Mi5zbGljZSgwLCBkZWxfY29udGVudDIubGVuZ3RoIC0gMSkgPT0KICAgICAgICAgICAgICAgICAgICAgIGluc19jb250ZW50MgogICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVsX2NvbnRlbnQyID09IGluc19jb250ZW50MiIpOwogICAgICAgICAgICAgICAgICAgIHN0YXR1czIgPSAxOyAvL+WinuWKoAogICAgICAgICAgICAgICAgICAgIHZhciBpbnNfdGVtcCA9IGlucy5zbGljZSgxKTsKICAgICAgICAgICAgICAgICAgICBkaWZmMiA9IGRlbF9jb250ZW50Mi50cmltKCkgKyAiICIgKyBpbnNfdGVtcC5qb2luKCIgIik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImRpZmYyIiwgZGlmZjIpOwogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGVsX2NvbnRlbnQyIiwgZGVsX2NvbnRlbnQyKTsKICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0yID0gewogICAgICAgICAgICAgICAgICAgIHdvcmQ6IGRlbF9jb250ZW50MiwKICAgICAgICAgICAgICAgICAgICBkaWZmOiBkaWZmMiwKICAgICAgICAgICAgICAgICAgICBpbmRleDogZGVsWzBdLmRlbF9pbmRleCwKICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1czIsCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIHNlbl9yZXN1bHQucHVzaChpdGVtMik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZGVsLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgICAgaWYgKGRlbC5sZW5ndGggPT0gaW5zLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgZGVsLmxlbmd0aDsgYSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhkZWxbYV0pCiAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsX2NvbnRlbnQzID0gZGVsW2FdLmRlbC5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAvKDxkZWxbXj5dKj8+KXwoPFwvZGVsPikvZywKICAgICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zX2NvbnRlbnQzID0gaW5zW2FdLnJlcGxhY2UoCiAgICAgICAgICAgICAgICAgICAgICAgIC8oPGluc1tePl0qPz4pfCg8XC9pbnM+KS9nLAogICAgICAgICAgICAgICAgICAgICAgICAiIgogICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJjIiwgZGVsX2NvbnRlbnQzKQogICAgICAgICAgICAgICAgICAgICAgaWYgKGRlbF9jb250ZW50MyAhPT0gaW5zX2NvbnRlbnQzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtMyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JkOiBkZWxfY29udGVudDMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZjogZGVsW2FdLmRlbC50cmltKCkgKyBpbnNbYV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGRlbFthXS5kZWxfaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAyLAogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBzZW5fcmVzdWx0LnB1c2goaXRlbTMpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZiAoZGVsLmxlbmd0aCA8IGlucy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IGRlbC5sZW5ndGg7IGIrKykgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbF9jb250ZW50NCA9IGRlbFtiXS5kZWwucmVwbGFjZSgKICAgICAgICAgICAgICAgICAgICAgICAgLyg8ZGVsW14+XSo/Pil8KDxcL2RlbD4pL2csCiAgICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImQiLCBkZWxfY29udGVudDQpCiAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlmZjQgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgIGlmIChiID09IGRlbC5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wX2lucyA9IGlucy5zbGljZShiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZGlmZjQgPSBkZWxbYl0uZGVsLnRyaW0oKSArIHRlbXBfaW5zLmpvaW4oIiAiKTsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmY0ID0gZGVsW2JdLmRlbC50cmltKCkgKyBpbnNbYl07CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZCIsIGRpZmY0KQogICAgICAgICAgICAgICAgICAgICAgdmFyIGluc19jb250ZW50NCA9IGluc1tiXS5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAvKDxpbnNbXj5dKj8+KXwoPFwvaW5zPikvZywKICAgICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVsX2NvbnRlbnQ0ICE9PSBpbnNfY29udGVudDQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW00ID0gewogICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmQ6IGRlbF9jb250ZW50NCwKICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmOiBkaWZmNCwKICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogZGVsW2JdLmRlbF9pbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDIsCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbl9yZXN1bHQucHVzaChpdGVtNCk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChkZWwubGVuZ3RoID4gaW5zLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgaW5zLmxlbmd0aDsgYysrKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsX2NvbnRlbnQ1ID0gZGVsW2NdLmRlbC5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAvKDxkZWxbXj5dKj8+KXwoPFwvZGVsPikvZywKICAgICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zX2NvbnRlbnQ1ID0gaW5zW2NdLnJlcGxhY2UoCiAgICAgICAgICAgICAgICAgICAgICAgIC8oPGluc1tePl0qPz4pfCg8XC9pbnM+KS9nLAogICAgICAgICAgICAgICAgICAgICAgICAiIgogICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJlIiwgZGVsX2NvbnRlbnQ1KQogICAgICAgICAgICAgICAgICAgICAgaWYgKGRlbF9jb250ZW50NSAhPT0gaW5zX2NvbnRlbnQ1KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtNSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JkOiBkZWxfY29udGVudDUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZjogZGVsW2NdLmRlbC50cmltKCkgKyBpbnNbY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGRlbFtjXS5kZWxfaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAyLAogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBzZW5fcmVzdWx0LnB1c2goaXRlbTUpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcF9kZWwgPSBkZWwuc2xpY2UoaW5zLmxlbmd0aCwgZGVsLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZiA9IDA7IGYgPCB0ZW1wX2RlbC5sZW5ndGg7IGYrKykgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGRpZmY2ID0gdGVtcF9kZWxbZl0uZGVsLnRyaW0oKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWxfY29udGVudDYgPSB0ZW1wX2RlbFtmXS5kZWwucmVwbGFjZSgKICAgICAgICAgICAgICAgICAgICAgICAgLyg8ZGVsW14+XSo/Pil8KDxcL2RlbD4pL2csCiAgICAgICAgICAgICAgICAgICAgICAgICIiCiAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coImUiLCBkaWZmNikKICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJlIiwgZGVsX2NvbnRlbnQ2KQogICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW02ID0gewogICAgICAgICAgICAgICAgICAgICAgICB3b3JkOiBkZWxfY29udGVudDYsCiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmY6IGRpZmY2LAogICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogdGVtcF9kZWxbZl0uZGVsX2luZGV4LAogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IC0xLAogICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgIHNlbl9yZXN1bHQucHVzaChpdGVtNik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZpbmFsX3Jlc3VsdC5wdXNoKHNlbl9yZXN1bHQpOwogICAgICAgICAgfQogICAgICAgICAgLy8gY29uc29sZS5sb2coImZpbmFsX3Jlc3VsdDogIiwgZmluYWxfcmVzdWx0KTsKICAgICAgICAgIC8v5YaN5Y+W5LiA5qyh5pWw5o2u77yM5Yik5pat5piv5bGe5LqO5ZOq5Liq5Y2V6K+N55qE5L+u5pS577yM5Yik5pat6K+l5L+u5pS55piv5ZCm5a2Y5ZyoCiAgICAgICAgICAvL+WmguaenOWtmOWcqO+8jOebtOaOpeWKoOWFpeeUqOaIt++8jOWmguaenOS4jeWtmOWcqO+8jOWKoOWFpeivpeS/ruaUueS7peWPiueUqOaItwogICAgICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAgICAgLmdldCh0aGlzLmFwaSArICIvY3VycmVudFRhc2s/X2lkPSIgKyB0aGlzLmRpZmZJZCkKICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuZGJMaXN0ID0gcmVzLmRhdGFbMF0uZGlmZkxpc3Q7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgLy8gY29uc29sZS5sb2coImRiRGlmZkxpc3QyIiwgdGhpcy5kYkxpc3QpOwogICAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCBmaW5hbF9yZXN1bHQubGVuZ3RoOyByKyspIHsKICAgICAgICAgICAgLy9y6KGo56S65paH5pys5Lit55qE56yscuWPpQogICAgICAgICAgICB2YXIgc19vcmRlcnMgPSBmaW5hbF9yZXN1bHRbcl07IC8v56yscuWPpeeahOS/ruaUueiusOW9lQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygic19vcmRlcnM6ICIsIHNfb3JkZXJzKTsKICAgICAgICAgICAgdmFyIHNfd29yZHMgPSB0aGlzLmRiTGlzdFtyXS53b3JkczsgLy/nrKxy5Y+l55qE5YiG6K+N57uT5p6cCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJzX3dvcmRzOiAiLCBzX3dvcmRzKTsKICAgICAgICAgICAgdmFyIHNfc2VudGVuY2VzID0gdGhpcy5kYkxpc3Rbcl0uc2VudGVuY2VEaWZmczsgLy/nrKxy5Y+l55qE5LiN5ZCM54mI5pysCiAgICAgICAgICAgIC8v5paw5pS55YqoCiAgICAgICAgICAgIHZhciBuZXdfc2VudGVuY2VzID0gdGhpcy5kYkxpc3Rbcl0uc2VudGVuY2VzOwogICAgICAgICAgICBpZiAoc19vcmRlcnMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAvL+esrHLlj6XnmoTkv67mlLnorrDlvZXkuLrnqboKICAgICAgICAgICAgICAvLyDnlLHkuo7mlbDmja7lupPkuK3nmoTpobrluo/kvJrpmo/mnLrmlLnlj5jvvIzmiYDku6XlhYjljLnphY3lho3mj5LlhaXmm7TmlLnmlbDmja4KICAgICAgICAgICAgICBzX3dvcmRzLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgICAgICAgIHZhciBub19lZGl0ZWRfd29yZCA9IGl0ZW0ud29yZDsKICAgICAgICAgICAgICAgIHZhciBub19lZGl0ZWRfaW5kZXggPSBpdGVtLmRpZmZzLmZpbmRJbmRleCgKICAgICAgICAgICAgICAgICAgKGF0dHIpID0+IGF0dHIuZGlmZiA9PSBub19lZGl0ZWRfd29yZAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbbm9fZWRpdGVkX2luZGV4XS5uYW1lcy5wdXNoKHsKICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgIGVkaXR0aW1lOiBuZXdkYXRlLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpdGVtLmRpZmZzW25vX2VkaXRlZF9pbmRleF0ubnVtKys7CiAgICAgICAgICAgICAgICBpdGVtLmRpZmZzW25vX2VkaXRlZF9pbmRleF0udGltZSA9IG5ld2RhdGU7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdmFyIGZpbHRlcmVkX3dvcmRzID0gc193b3Jkcy5tYXAoKGl0ZW0pID0+IHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGVsZSA9IDA7IGVsZSA8IGl0ZW0uZGlmZnMubGVuZ3RoOyBlbGUrKykgewogICAgICAgICAgICAgICAgICB2YXIgbmFtZV9pbmRleCA9IHRoaXMuZmluZEVsZW0oCiAgICAgICAgICAgICAgICAgICAgaXRlbS5kaWZmc1tlbGVdLm5hbWVzLAogICAgICAgICAgICAgICAgICAgICJ1c2VybmFtZSIsCiAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VybmFtZQogICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICBpZiAobmFtZV9pbmRleCAhPSAtMSkgewogICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmRpZmZzW2VsZV0uaGFzT3duUHJvcGVydHkoInN0eWxlRGlmZiIpKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5kaWZmc1tlbGVdLnN0eWxlRGlmZjsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZGlmZnNbZWxlXS5kaWZmOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJmaWx0ZXJlZF93b3JkcyIsIGZpbHRlcmVkX3dvcmRzKTsKICAgICAgICAgICAgICB2YXIgZmlsdGVyZWRfc2VuID0gZmlsdGVyZWRfd29yZHMuam9pbigiICIpOwoKICAgICAgICAgICAgICBzX3NlbnRlbmNlcy5wdXNoKHsKICAgICAgICAgICAgICAgIHByb3ZpZGVyOiB0aGlzLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgc2VudGVuY2VEaWZmOiBmaWx0ZXJlZF9zZW4sCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy/nrKxy5Y+l55qE5L+u5pS56K6w5b2V5LiN5Li656m6CiAgICAgICAgICAgICAgLy8g56ys5LiA6YOo5YiG77ya5bCG5L+u5pS56K6w5b2V5pu/5o2i5Yiw5LiN5ZCM5Y+l5a2Q55qE54mI5pys5bGV56S65Lit77yM5L6/5LqO5bGV56S65L+u5pS555qE5Zyw5pa5CiAgICAgICAgICAgICAgLy8g5pW05ZCI56ys5LqM6YOo5YiG5LqO56ys5LiA6YOo5YiG5Lit77ya5Yik5pat5q+P5Liq6K+N6K+t5piv5ZCm5pyJ5a+55bqU55qE5L+u5pS5CiAgICAgICAgICAgICAgdmFyIGVkaXRpbmdfd29yZHMgPSBbXTsKICAgICAgICAgICAgICBzX3dvcmRzLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgaXRlbUluZGV4ID0gaW5kZXg7CiAgICAgICAgICAgICAgICB2YXIgcmVwbGFjZWRJdGVtSW5kZXggPSBzX29yZGVycy5pbmRleE9mKAogICAgICAgICAgICAgICAgICBzX29yZGVycy5maW5kKChlbGVtZW50KSA9PiBlbGVtZW50LmluZGV4ID09IGl0ZW1JbmRleCkKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZWRJdGVtSW5kZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgaWYgKHNfb3JkZXJzW3JlcGxhY2VkSXRlbUluZGV4XS5zdGF0dXMgPT0gMSkgewogICAgICAgICAgICAgICAgICAgIC8v5a+55YmN5LiA5Liq6K+N55qE5aSE55CGICAg6KGl5YWF77ya5Y+l5bC+55qE5qCH54K556ym5Y+3CiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmRfaW5kZXggPSB0aGlzLmZpbmRFbGVtKGl0ZW0uZGlmZnMsICJzdGF0dXMiLCAwKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZmluZF9pbmRleGFhYWEiLCBmaW5kX2luZGV4KTsKICAgICAgICAgICAgICAgICAgICBpdGVtLmRpZmZzW2ZpbmRfaW5kZXhdLm5hbWVzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICBlZGl0dGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBpdGVtLmRpZmZzW2ZpbmRfaW5kZXhdLm51bSsrOwogICAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbZmluZF9pbmRleF0udGltZSA9IG5ld2RhdGU7CgogICAgICAgICAgICAgICAgICAgIHZhciByX2luc193b3JkcyA9IHNfb3JkZXJzW3JlcGxhY2VkSXRlbUluZGV4XS5kaWZmLnNwbGl0KAogICAgICAgICAgICAgICAgICAgICAgIiAiCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5zX3dvcmRzID0gcl9pbnNfd29yZHMuc2xpY2UoMSk7CgogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgIHNfd29yZHNbaW5kZXggLSAxXS5kaWZmc1swXS5oYXNPd25Qcm9wZXJ0eSgic3R5bGVEaWZmIikgJiYKICAgICAgICAgICAgICAgICAgICAgIHNfd29yZHNbaW5kZXggLSAxXS5pc2ZpcnN0ID09IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVnX2VuZCA9IC9cLHxcLnxcIXxcP3xcLlwifFwuXCd8XCFcInxcIVwnfFw/XCJ8XD9cJy9nOwogICAgICAgICAgICAgICAgICAgICAgdmFyIGJmX2luc19kd19pID0gc193b3Jkc1tpbmRleCAtIDFdLmRpZmZzLmZpbmRJbmRleCgKICAgICAgICAgICAgICAgICAgICAgICAgKGVsZW0pID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbS5kaWZmID09PSBzX3dvcmRzW2luZGV4IC0gMV0ud29yZDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcF9pbnNfc2RmID0gaXRlbS5kaWZmc1tiZl9pbnNfZHdfaV0uc3R5bGVEaWZmOwogICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coInRlbXBfaW5zX3NkZjExMTEiLCB0ZW1wX2luc19zZGYpOwoKICAgICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgcmVnX2VuZC50ZXN0KAogICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW5zX3NkZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hdGNoKC8oPzw9PHN1Ymlucz4pLio/KD89PFwvc3ViaW5zPikvZylbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zbGljZSgtMSkKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW5zX3NkZiA9IHRlbXBfaW5zX3NkZi5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW5zX3NkZi5zbGljZSgtMTApLAogICAgICAgICAgICAgICAgICAgICAgICAgICI8L3N1Ymlucz4iCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ud29yZCA9IHRlbXBfaW5zX3NkZi5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAgIC88c3ViaW5zPnw8XC9zdWJpbnM+L2csCiAgICAgICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5kaWZmc1tiZl9pbnNfZHdfaV0uZGlmZiA9IGl0ZW0ud29yZDsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5kaWZmc1tiZl9pbnNfZHdfaV0uc3R5bGVEaWZmID0gdGVtcF9pbnNfc2RmOwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgcmVnX2VuZC50ZXN0KAogICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW5zX3NkZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hdGNoKC8oPzw9PHN1Ymlucz4pLio/KD89PFwvc3ViaW5zPikvZylbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zbGljZSgtMikKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW5zX3NkZiA9IHRlbXBfaW5zX3NkZi5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW5zX3NkZi5zbGljZSgtMTEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICI8L3N1Ymlucz4iCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ud29yZCA9IHRlbXBfaW5zX3NkZi5yZXBsYWNlKAogICAgICAgICAgICAgICAgICAgICAgICAgIC88c3ViaW5zPnw8XC9zdWJpbnM+L2csCiAgICAgICAgICAgICAgICAgICAgICAgICAgIiIKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5kaWZmc1tiZl9pbnNfZHdfaV0uZGlmZiA9IGl0ZW0ud29yZDsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5kaWZmc1tiZl9pbnNfZHdfaV0uc3R5bGVEaWZmID0gdGVtcF9pbnNfc2RmOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCLlvZPliY3ljp/or43ljrvmoIfngrnlkI4iLCBpdGVtLndvcmQpOwogICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coInRlbXBfaW5zX3NkZjIyMjIyMjIiLCB0ZW1wX2luc19zZGYpOwoKICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnNfd29yZHNfYXJyID0gWwogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgd29yZDogdGVtcF9pbnNfc2RmLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmY6IHRlbXBfaW5zX3NkZiwgLy/lsZXnpLrmlbDmja4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgICBpc2VkaXRlZDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVnX2VuZCA9IC9cLnxcIXxcP3xcLlwifFwuXCd8XCFcInxcIVwnfFw/XCJ8XD9cJy9nOwogICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBfaW5zID0gcl9pbnNfd29yZHNbMF07CiAgICAgICAgICAgICAgICAgICAgICB2YXIgYmZfaW5zX2R3X2kgPSBpdGVtLmRpZmZzLmZpbmRJbmRleCgoZWxlbSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbS5kaWZmID09PSBpdGVtLndvcmQ7CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJiZl9pbnNfZHdfaSIsIGJmX2luc19kd19pKTsKICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWdfZW5kLnRlc3QodGVtcF9pbnNbdGVtcF9pbnMubGVuZ3RoIC0gMV0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfaW5zID0gdGVtcF9pbnMuc2xpY2UoMCwgdGVtcF9pbnMubGVuZ3RoIC0gMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ud29yZCA9IHRlbXBfaW5zOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygKICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAiaXRlbS5kaWZmc1tiZl9pbnNfZHdfaV0iLAogICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGl0ZW0uZGlmZnNbYmZfaW5zX2R3X2ldCiAgICAgICAgICAgICAgICAgICAgICAgIC8vICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbYmZfaW5zX2R3X2ldLmRpZmYgPSB0ZW1wX2luczsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWdfZW5kLnRlc3QodGVtcF9pbnMuc2xpY2UoLTIpKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2lucyA9IHRlbXBfaW5zLnNsaWNlKDAsIHRlbXBfaW5zLmxlbmd0aCAtIDIpOwogICAgICAgICAgICAgICAgICAgICAgICBpdGVtLndvcmQgPSB0ZW1wX2luczsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5kaWZmc1tiZl9pbnNfZHdfaV0uZGlmZiA9IHRlbXBfaW5zOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgdmFyIGluc193b3Jkc19hcnIgPSBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JkOiB0ZW1wX2lucywKICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmczogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmOiB0ZW1wX2lucywgLy/lsZXnpLrmlbDmja4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgICBpc2VkaXRlZDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy9JIGxvdmUgQ2hpbmEuCiAgICAgICAgICAgICAgICAgICAgLy9JIHZlcnkgbG92ZSBDaGluYSB0b28uCiAgICAgICAgICAgICAgICAgICAgaW5zX3dvcmRzLmZvckVhY2goKGkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpX3dvcmQgPSBpLnJlcGxhY2UoLyg8aW5zW14+XSo/Pil8KDxcL2lucz4pL2csICIiKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpX2luZGV4ID0gc19vcmRlcnNbcmVwbGFjZWRJdGVtSW5kZXhdLmluZGV4ICsgMTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBpX25hbWVzID0gbmV3IEFycmF5KCk7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcl9pdGVtID0gewogICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgZWRpdHRpbWU6IG5ld2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgaV9uYW1lcy5wdXNoKHVzZXJfaXRlbSk7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zX3dvcmRJdGVtID0gewogICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogaV9pbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgd29yZDogaV93b3JkLAogICAgICAgICAgICAgICAgICAgICAgICBkaWZmczogWwogICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmY6IGlfd29yZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlRGlmZjogIjxzdWJpbnM+IiArIGlfd29yZCArICI8L3N1Ymlucz4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZXM6IGlfbmFtZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW06IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lOiBuZXdkYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIGlzZWRpdGVkOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgaXNmaXJzdDogZmFsc2UsIC8v55u45a+556ys5LiA54mI77yM55So5LqO5Yy65YiG5pS554mI5piv5ZCm5Li65aKe5Yqg55qE5YaF5a65CiAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgaW5zX3dvcmRzX2Fyci5wdXNoKGluc193b3JkSXRlbSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgZWRpdGluZ193b3Jkcy5wdXNoKGluc193b3Jkc19hcnIpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHZhciBmaW5kX3Jlc3VsdCA9IHRoaXMuZmluZEVsZW0oCiAgICAgICAgICAgICAgICAgICAgICBpdGVtLmRpZmZzLAogICAgICAgICAgICAgICAgICAgICAgImRpZmYiLAogICAgICAgICAgICAgICAgICAgICAgc19vcmRlcnNbcmVwbGFjZWRJdGVtSW5kZXhdLmRpZmYKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIGlmIChmaW5kX3Jlc3VsdCA9PSAtMSkgewogICAgICAgICAgICAgICAgICAgICAgLy/kuI3lrZjlnKgKICAgICAgICAgICAgICAgICAgICAgIHZhciBuYW1lcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJfaXRlbSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXR0aW1lOiBuZXdkYXRlLAogICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgIG5hbWVzLnB1c2godXNlcl9pdGVtKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWZmX2l0ZW0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmY6IHNfb3JkZXJzW3JlcGxhY2VkSXRlbUluZGV4XS5kaWZmLAogICAgICAgICAgICAgICAgICAgICAgICBuYW1lczogbmFtZXMsCiAgICAgICAgICAgICAgICAgICAgICAgIG51bTogMSwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBzX29yZGVyc1tyZXBsYWNlZEl0ZW1JbmRleF0uc3RhdHVzLAogICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnMucHVzaChkaWZmX2l0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgaXRlbS5pc2VkaXRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbZmluZF9yZXN1bHRdLm5hbWVzLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgZWRpdHRpbWU6IG5ld2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICB9KTsgLy/lsIblvZPliY3nlKjmiLfliqDlhaXliJfooagKICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbZmluZF9yZXN1bHRdLm51bSsrOyAvL+aVsOmHj+WKoDEKICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbZmluZF9yZXN1bHRdLnRpbWUgPSBuZXdkYXRlOyAvL+abtOaWsOaXpeacnwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgd29yZF9kaWZmID0gaXRlbS53b3JkLnJlcGxhY2UoCiAgICAgICAgICAgICAgICAgICAgICBpdGVtLndvcmQsCiAgICAgICAgICAgICAgICAgICAgICBzX29yZGVyc1tyZXBsYWNlZEl0ZW1JbmRleF0uZGlmZgogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgZWRpdGluZ193b3Jkcy5wdXNoKHdvcmRfZGlmZik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHZhciBub19lZGl0ZWRfd29yZCA9IGl0ZW0ud29yZDsKICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIm5vX2VkaXRlZF93b3JkIiwgbm9fZWRpdGVkX3dvcmQpOwogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiaXRlbS5kaWZmcyIsIGl0ZW0uZGlmZnMpOwogICAgICAgICAgICAgICAgICB2YXIgbm9fZWRpdGVkX2luZGV4ID0gaXRlbS5kaWZmcy5maW5kSW5kZXgoKGF0dHIpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXR0ci5kaWZmID09IG5vX2VkaXRlZF93b3JkOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIm5vX2VkaXRlZF9pbmRleCIsIG5vX2VkaXRlZF9pbmRleCk7CiAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbbm9fZWRpdGVkX2luZGV4XS5uYW1lcy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICBlZGl0dGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGl0ZW0uZGlmZnNbbm9fZWRpdGVkX2luZGV4XS5udW0rKzsKICAgICAgICAgICAgICAgICAgaXRlbS5kaWZmc1tub19lZGl0ZWRfaW5kZXhdLnRpbWUgPSBuZXdkYXRlOwoKICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uaXNmaXJzdCA9PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgZWRpdGluZ193b3Jkcy5wdXNoKGl0ZW0ud29yZCk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coCiAgICAgICAgICAgICAgICAgICAgLy8gICAibm9fZWRpdGVkX3dvcmTCoD4+wqBpdGVtLmRpZmZzW25vX2VkaXRlZF9pbmRleF0uc3R5bGVEaWZmIiwKICAgICAgICAgICAgICAgICAgICAvLyAgIGl0ZW0uZGlmZnNbbm9fZWRpdGVkX2luZGV4XS5zdHlsZURpZmYKICAgICAgICAgICAgICAgICAgICAvLyApOwogICAgICAgICAgICAgICAgICAgIGVkaXRpbmdfd29yZHMucHVzaChpdGVtLmRpZmZzW25vX2VkaXRlZF9pbmRleF0uc3R5bGVEaWZmKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJlZGl0aW5nX3dvcmRzMSIsIGVkaXRpbmdfd29yZHMpOwogICAgICAgICAgICAgIHZhciBkZWVwRmxhdHRlbiA9IChhcnIpID0+CiAgICAgICAgICAgICAgICBbXS5jb25jYXQoCiAgICAgICAgICAgICAgICAgIC4uLmFyci5tYXAoKHYpID0+IChBcnJheS5pc0FycmF5KHYpID8gZGVlcEZsYXR0ZW4odikgOiB2KSkKICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgIHZhciBtb3JlX2luc19hcnIgPSBbXTsgLy/lop7liqDnmoTljp/or43mlbDnu4QKICAgICAgICAgICAgICBmb3IgKHZhciBtYSA9IDA7IG1hIDwgZWRpdGluZ193b3Jkcy5sZW5ndGg7IG1hKyspIHsKICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGVkaXRpbmdfd29yZHNbbWFdKSkgewogICAgICAgICAgICAgICAgICBtb3JlX2luc19hcnIucHVzaChlZGl0aW5nX3dvcmRzW21hXS5zbGljZSgxKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJtb3JlX2luc19hcnIiLCBtb3JlX2luc19hcnIpOyAvL21vcmVfaW5zX2FyciBbWzEsIDIsIDNdLCBbNCwgNV0sIFs3LCA4XV0KICAgICAgICAgICAgICB2YXIgbW9yZV9pbnNfYXJyMSA9IGRlZXBGbGF0dGVuKG1vcmVfaW5zX2Fycik7CiAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIm1vcmVfaW5zX2FycjEiLCBtb3JlX2luc19hcnIxKTsgLy9bMSwgMiwgMywgNCwgNSwgNywgOF0KCiAgICAgICAgICAgICAgZm9yICh2YXIgdmEgPSAwOyB2YSA8IG1vcmVfaW5zX2FycjEubGVuZ3RoOyB2YSsrKSB7CiAgICAgICAgICAgICAgICBpZiAobW9yZV9pbnNfYXJyMVt2YV0ud29yZCA9PSAiIikgewogICAgICAgICAgICAgICAgICBtb3JlX2luc19hcnIxLnNwbGljZSh2YSwgMSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBtb3JlX2luc19hcnIxW3ZhXS5pbmRleCA9IG1vcmVfaW5zX2FycjFbdmFdLmluZGV4ICsgdmE7CiAgICAgICAgICAgICAgICAgIHNfd29yZHMuc3BsaWNlKG1vcmVfaW5zX2FycjFbdmFdLmluZGV4LCAwLCBtb3JlX2luc19hcnIxW3ZhXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygic193b3JkczIyMjIiLCBzX3dvcmRzKTsKICAgICAgICAgICAgICAvL+aWsOaUueWKqAogICAgICAgICAgICAgIGlmIChtb3JlX2luc19hcnIxLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHZhciByZWdfZW5kID0gL1wsfFwufFwhfFw/fFwuXCJ8XC5cJ3xcIVwifFwhXCd8XD9cInxcP1wnL2c7CiAgICAgICAgICAgICAgICAvLyB2YXIgcmVnX2VuZCA9IC9cLnxcIXxcPy9nOwogICAgICAgICAgICAgICAgZm9yICh2YXIgd3IgPSAwOyB3ciA8IHNfd29yZHMubGVuZ3RoIC0gMTsgd3IrKykgewogICAgICAgICAgICAgICAgICB2YXIgd29yZCA9IHNfd29yZHNbd3JdLndvcmQ7CiAgICAgICAgICAgICAgICAgIHZhciBkaWZmcyA9IHNfd29yZHNbd3JdLmRpZmZzOwogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiMTExMTExIiwgZGlmZnMpOwogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiMTExMTIiLCB3b3JkKTsKICAgICAgICAgICAgICAgICAgdmFyIG5vX2VkaXRlZF9pbmRleCA9IGRpZmZzLmZpbmRJbmRleCgKICAgICAgICAgICAgICAgICAgICAoYXR0cikgPT4gYXR0ci5kaWZmID09PSB3b3JkCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCIrKysrKysrIiwgbm9fZWRpdGVkX2luZGV4KTsKICAgICAgICAgICAgICAgICAgaWYgKHJlZ19lbmQudGVzdCh3b3JkW3dvcmQubGVuZ3RoIC0gMV0pKSB7CiAgICAgICAgICAgICAgICAgICAgd29yZCA9IHdvcmQuc2xpY2UoMCwgd29yZC5sZW5ndGggLSAxKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiLS0tLS0tLSIsIHdvcmQpOwogICAgICAgICAgICAgICAgICAgIGRpZmZzW25vX2VkaXRlZF9pbmRleF0uZGlmZiA9IGRpZmZzWwogICAgICAgICAgICAgICAgICAgICAgbm9fZWRpdGVkX2luZGV4CiAgICAgICAgICAgICAgICAgICAgXS5kaWZmLnNsaWNlKDAsIGRpZmZzW25vX2VkaXRlZF9pbmRleF0uZGlmZi5sZW5ndGggLSAxKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiLS0tLS0tLSIsIGRpZmZzW25vX2VkaXRlZF9pbmRleF0uZGlmZik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgaWYgKHJlZ19lbmQudGVzdCh3b3JkLnNsaWNlKC0yKSkpIHsKICAgICAgICAgICAgICAgICAgICB3b3JkID0gd29yZC5zbGljZSgwLCB3b3JkLmxlbmd0aCAtIDIpOwogICAgICAgICAgICAgICAgICAgIGRpZmZzW25vX2VkaXRlZF9pbmRleF0uZGlmZiA9IGRpZmZzWwogICAgICAgICAgICAgICAgICAgICAgbm9fZWRpdGVkX2luZGV4CiAgICAgICAgICAgICAgICAgICAgXS5kaWZmLnNsaWNlKDAsIGRpZmZzW25vX2VkaXRlZF9pbmRleF0uZGlmZi5sZW5ndGggLSAyKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIHYxX3dvcmRzID0gW107CiAgICAgICAgICAgICAgICB2MV93b3JkcyA9IHNfd29yZHMubWFwKCh3b3JkKSA9PiB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB3b3JkLndvcmQ7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHZhciBuZXdfc2VudGVuY2UgPSB2MV93b3Jkcy5qb2luKCIgIik7CiAgICAgICAgICAgICAgICB2YXIgbmV3X2l0ZW0gPSB7CiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyOiB0aGlzLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgICBzZW50ZW5jZTogbmV3X3NlbnRlbmNlLAogICAgICAgICAgICAgICAgICB0aW1lOiBuZXdkYXRlLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIG5ld19zZW50ZW5jZXMucHVzaChuZXdfaXRlbSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygic193b3JkczMzMzMiLCBzX3dvcmRzKTsKCiAgICAgICAgICAgICAgZWRpdGluZ193b3JkcyA9IGRlZXBGbGF0dGVuKAogICAgICAgICAgICAgICAgZWRpdGluZ193b3Jkcy5tYXAoKHcpID0+IHsKICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodykgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBzdWJfd29yZCA9IHcubWFwKChpdykgPT4gewogICAgICAgICAgICAgICAgICAgICAgaWYgKGl3LmRpZmZzWzBdLmhhc093blByb3BlcnR5KCJzdHlsZURpZmYiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygKICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAiaXcuZGlmZnNbMF0uc3R5bGVEaWZmIiwKICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBpdy5kaWZmc1swXS5zdHlsZURpZmYKICAgICAgICAgICAgICAgICAgICAgICAgLy8gKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl3LmRpZmZzWzBdLnN0eWxlRGlmZjsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJpdy5kaWZmc1swXS5kaWZmIiwgaXcuZGlmZnNbMF0uZGlmZik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdy5kaWZmc1swXS5kaWZmOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJfd29yZDsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdzsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZWRpdGluZ193b3JkczIiLCBlZGl0aW5nX3dvcmRzKTsKICAgICAgICAgICAgICAvL1siSW4iLCAiPHN1Ymlucz5AQEA8L3N1Ymlucz4iLCAiPHN1Ymlucz5AQEBAQEBAQEBAQDwvc3ViaW5zPiIsICI8ZGVsPmhhdmU8L2RlbD48aW5zPmhhZDwvaW5zPiIsICJlYXJ0aHF1YWtlLiJdCiAgICAgICAgICAgICAgdmFyIGVkaXRpbmdfc2VudGVuY2UgPSBlZGl0aW5nX3dvcmRzLmpvaW4oIiAiKTsKICAgICAgICAgICAgICBzX3NlbnRlbmNlcy5wdXNoKHsKICAgICAgICAgICAgICAgIHByb3ZpZGVyOiB0aGlzLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgc2VudGVuY2VEaWZmOiBlZGl0aW5nX3NlbnRlbmNlLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJzZW50ZW5jZURpZmZzOiAiLCBzX3NlbnRlbmNlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJiYmIiLCB0aGlzLmRiTGlzdCk7CgogICAgICAgICAgLy/liKTmlq3lvZPliY3nlKjmiLfmmK/lkKblnKh1c2VyTGlzdOS4rQogICAgICAgICAgZm9yICh2YXIgaCA9IDA7IGggPCB0aGlzLnVzZXJMaXN0Lmxlbmd0aDsgaCsrKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnVzZXJuYW1lID09IHRoaXMudXNlckxpc3RbaF0ubmFtZSkgewogICAgICAgICAgICAgIHRoaXMuaW5Vc2VyTGlzdCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIC8v5aaC5p6c5rKh5pyJ5YiZ5aKe5YqgCiAgICAgICAgICBpZiAodGhpcy5pblVzZXJMaXN0ID09IGZhbHNlKSB7CiAgICAgICAgICAgIHRoaXMudXNlckxpc3QucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICBteV9zZW50ZW5jZXM6IHRoaXMuc2VudGVuY2VMaXN0LAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKCJzdWJtaXRtdiBzdWJtaXR0ZWQiLCB0aGlzLnN1Ym1pdHRlZCk7CiAgICAgICAgICB0aGlzLnN1Ym1pdHRlZC5wdXNoKHRoaXMudXNlcm5hbWUpOwoKICAgICAgICAgIC8v5pu05paw55u45bqU5pWw5o2u5Yiw5pWw5o2u5bqTCiAgICAgICAgICB0aGlzLiRheGlvcy5wb3N0KHRoaXMuYXBpICsgIi91cGRhdGVkaWZmIiwgewogICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICBfaWQ6IHRoaXMuZGlmZklkLAogICAgICAgICAgICAgIHVzZXJMaXN0OiB0aGlzLnVzZXJMaXN0LAogICAgICAgICAgICAgIGRpZmZMaXN0OiB0aGlzLmRiTGlzdCwKICAgICAgICAgICAgICBzdWJtaXR0ZWQ6IHRoaXMuc3VibWl0dGVkLAogICAgICAgICAgICB9LAogICAgICAgICAgfSk7CgogICAgICAgICAgdmFyIG5ld192ZXJzaW9uID0gdGhpcy5zZW50ZW5jZUxpc3Quam9pbigiICIpOwogICAgICAgICAgdGhpcy4kYXhpb3MucG9zdCh0aGlzLmFwaSArICIvdXBkYXRlVmVyc2lvbiIsIHsKICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgX2lkOiB0aGlzLmRpZmZJZCwKICAgICAgICAgICAgICBuZXdfdmVyc2lvbjogbmV3X3ZlcnNpb24sCiAgICAgICAgICAgICAgdGltZTogbmV3ZGF0ZSwKICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICB1c2VySWQ6IHRoaXMudXNlcklkLAogICAgICAgICAgICB9LAogICAgICAgICAgfSk7CgogICAgICAgICAgLy8g5b2T5Y+R5biD6ICF6LaF6L+H5oiq5q2i5pel5pyf5ZCO5o+Q5Lqk562U5qGICiAgICAgICAgICB0aGlzLiRheGlvcwogICAgICAgICAgICAuZ2V0KHRoaXMuYXBpICsgIi9jdXJyZW50VGFzaz9faWQ9IiArIHRoaXMuZGlmZklkKQogICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgLy/liLfmlrBkaWZmTGlzdAogICAgICAgICAgICAgIHRoaXMuZGlmZkxpc3QgPSByZXMuZGF0YVswXS5kaWZmTGlzdDsKICAgICAgICAgICAgICAvLyBsZXQgZGF0ZTEgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICAgIC8vIGxldCBuZXdkYXRlMSA9IGRhdGUxLnRvTG9jYWxlU3RyaW5nKCJjaGluZXNlIiwgewogICAgICAgICAgICAgIC8vICAgaG91cjEyOiBmYWxzZSwKICAgICAgICAgICAgICAvLyB9KTsKICAgICAgICAgICAgICBsZXQgbmV3ZGF0ZTEgPSB0aGlzLiRtb21lbnQobmV3IERhdGUoKSkuZm9ybWF0KAogICAgICAgICAgICAgICAgIllZWVkvTU0vREQgSEg6bW06c3MiCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICB0aGlzLnVzZXJuYW1lID09IHRoaXMucHVibGlzaGVyICYmCiAgICAgICAgICAgICAgICAhdGhpcy5pc01hbnVhbCAmJgogICAgICAgICAgICAgICAgdGhpcy5jb21wYXJlRGF0ZShuZXdkYXRlMSwgdGhpcy5kZWFkbGluZSkKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRoaXMuY291bnRTY29yZXMoKTsgLy8iMjAyMS8wMi8wNSAwMDowMDowMCIsIHRoaXMuZGVhZGxpbmUKICAgICAgICAgICAgICAgIHRoaXMuaXNDb25maXJtID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIC8v5YWz6Zet6L6T5YWl5qGGCiAgICAgICAgICB0aGlzLmlzZWRpdCA9IGZhbHNlOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKCiAgICAgICAgICB0aGlzLiRub3RpZnkoewogICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICAgIG1lc3NhZ2U6ICLmj5DkuqTmiJDlip/vvIEiLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNyZWF0ZUZpbmFsVmVyc2lvbigpOwogICAgICAgICAgLy8gdGhpcy4kcm91dGVyLmdvKDApOwogICAgICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAgICAgLmdldCh0aGlzLmFwaSArICIvY3VycmVudFRhc2s/X2lkPSIgKyB0aGlzLmRpZmZJZCkKICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIHZhciB2aWRlb19pZCA9IHJlcy5kYXRhWzBdLnZpZGVvSWQ7IC8v5a+55bqU6KeG6aKR55qEX2lkCiAgICAgICAgICAgICAgdmFyIGF1dGhjb2RlID0gcmVzLmRhdGFbMF0uYXV0aGNvZGU7IC8v5a+55bqU5Lu75Yqh55qE6aqM6K+B56CBCiAgICAgICAgICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAgICAgICAgIC5nZXQodGhpcy5hcGkgKyAiL3Byb2ZpbGU/bmFtZT0iICsgdGhpcy51c2VybmFtZSkKICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IHJlcy5kYXRhWzBdLl9pZDsKICAgICAgICAgICAgICAgICAgdmFyIHVzZXJUYXNrcyA9IHJlcy5kYXRhWzBdLm15VGFza3M7CiAgICAgICAgICAgICAgICAgIHVzZXJUYXNrcy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICB0YXNrSWQ6IHRoaXMuZGlmZklkLAogICAgICAgICAgICAgICAgICAgIHZpZGVvSWQ6IHZpZGVvX2lkLAogICAgICAgICAgICAgICAgICAgIGRlYWRsaW5lOiB0aGlzLmRlYWRsaW5lLAogICAgICAgICAgICAgICAgICAgIGF1dGhjb2RlOiBhdXRoY29kZSwKICAgICAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy50YXNrVGl0bGUsCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHRoaXMudGFza0xhYmVscywKICAgICAgICAgICAgICAgICAgICB0aW1lOiBuZXdkYXRlLAogICAgICAgICAgICAgICAgICAgIHNjb3JlczogIiIsCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAvLyDmm7TmlrDnlKjmiLfigJxteVRhc2tz4oCdCiAgICAgICAgICAgICAgICAgIHRoaXMuJGF4aW9zLnBvc3QodGhpcy5hcGkgKyAiL3VwZGF0ZU15VGFza3MiLCB7CiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICBfaWQ6IHVzZXJJZCwKICAgICAgICAgICAgICAgICAgICAgIG15VGFza3M6IHVzZXJUYXNrcywKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgLy8gdGl0bGU6ICLorablkYoiLAogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgIG1lc3NhZ2U6ICLmj5DkuqTlhoXlrrnljIXlkKvpnZ7ms5XlrZfnrKbvvIzor7fmo4Dmn6Xkv67mlLnlkI7lho3mj5DkuqTvvIEiLAogICAgICAgICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgICAgICAgIG9mZnNldDogMTAwLAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgLy8gLmNhdGNoKCgpID0+IHsKICAgICAgLy8gICB0aGlzLiRub3RpZnkoewogICAgICAvLyAgICAgLy8gdGl0bGU6ICLorablkYoiLAogICAgICAvLyAgICAgdHlwZTogIndhcm5pbmciLAogICAgICAvLyAgICAgbWVzc2FnZTogIuaCqOW3suWPlua2iOaPkOS6pCIsCiAgICAgIC8vICAgICBwb3NpdGlvbjogInRvcC1yaWdodCIsCiAgICAgIC8vICAgICBvZmZzZXQ6IDEwMCwKICAgICAgLy8gICB9KTsKICAgICAgLy8gfSk7CiAgICB9LAogICAgLy/nlJ/miJDnu7zlkIjniYjmnKwKICAgIGNyZWF0ZUZpbmFsVmVyc2lvbigpIHsKICAgICAgdGhpcy4kYXhpb3MKICAgICAgICAuZ2V0KHRoaXMuYXBpICsgIi9jdXJyZW50VGFzaz9faWQ9IiArIHRoaXMuZGlmZklkKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIC8vIHRoaXMub3BlbkZ1bGxTY3JlZW4yKCkKICAgICAgICAgIHRoaXMuZGJMaXN0ID0gcmVzLmRhdGFbMF0uZGlmZkxpc3Q7CiAgICAgICAgICAvL+WKoOi9veWKqOeUuwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgfSwgMTUwMCk7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZGJMaXN0IiwgdGhpcy5kYkxpc3QpOwogICAgICAgICAgdmFyIGZpbmFsX3NlbnRlbmNlcyA9IFtdOwogICAgICAgICAgdmFyIG9ubHlfc2VudGVuY2VzID0gW107CiAgICAgICAgICB2YXIgb25seV9zZW50ZW5jZXMxID0gW107CiAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRoaXMuZGJMaXN0Lmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgIHZhciBvcmlnaW5hbF9zZW50ZW5jZSA9IHRoaXMuZGJMaXN0W2tdLnNlbnRlbmNlOwogICAgICAgICAgICB2YXIgd29yZHMgPSB0aGlzLmRiTGlzdFtrXS53b3JkczsKICAgICAgICAgICAgdmFyIG1vc3Rfd29yZHMgPSBbXTsKICAgICAgICAgICAgZm9yICh2YXIgdyA9IDA7IHcgPCB3b3Jkcy5sZW5ndGg7IHcrKykgewogICAgICAgICAgICAgIHZhciB3b3Jkc19kaWZmcyA9IHdvcmRzW3ddLmRpZmZzOwogICAgICAgICAgICAgIHZhciBtb3N0X2VkaXRlZF93b3JkID0gd29yZHNfZGlmZnNbd29yZHNfZGlmZnMubGVuZ3RoIC0gMV0uZGlmZjsgLy/liJ3lp4vlgLwKICAgICAgICAgICAgICAvL+aMieaXtumXtOaOkuW6jwogICAgICAgICAgICAgIC8v5oyJ55So5oi35pWw6YeP5o6S5bqPCiAgICAgICAgICAgICAgdmFyIHdvcmRzX2RpZmZzMiA9IHdvcmRzX2RpZmZzCiAgICAgICAgICAgICAgICAuc29ydCh0aGlzLmNvbXBhcmUoInRpbWUiKSkKICAgICAgICAgICAgICAgIC5zb3J0KHRoaXMuY29tcGFyZSgibnVtIikpOwogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJ3b3Jkc19kaWZmczIiLCB3b3Jkc19kaWZmczIpCgogICAgICAgICAgICAgIGlmICh3b3Jkc19kaWZmczJbd29yZHNfZGlmZnMubGVuZ3RoIC0gMV0uc3R5bGVEaWZmKSB7CiAgICAgICAgICAgICAgICBtb3N0X2VkaXRlZF93b3JkID0gewogICAgICAgICAgICAgICAgICBkaWZmOiB3b3Jkc19kaWZmczJbd29yZHNfZGlmZnMubGVuZ3RoIC0gMV0uc3R5bGVEaWZmLAogICAgICAgICAgICAgICAgICBpc2VkaXRlZDogd29yZHNbd10uaXNlZGl0ZWQsCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtb3N0X2VkaXRlZF93b3JkID0gewogICAgICAgICAgICAgICAgICBkaWZmOiB3b3Jkc19kaWZmczJbd29yZHNfZGlmZnMubGVuZ3RoIC0gMV0uZGlmZiwKICAgICAgICAgICAgICAgICAgaXNlZGl0ZWQ6IHdvcmRzW3ddLmlzZWRpdGVkLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbW9zdF93b3Jkcy5wdXNoKG1vc3RfZWRpdGVkX3dvcmQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBmaW5hbF9zZW50ZW5jZSA9ICIiOwogICAgICAgICAgICBmb3IgKHZhciBzID0gMDsgcyA8IG1vc3Rfd29yZHMubGVuZ3RoOyBzKyspIHsKICAgICAgICAgICAgICBtb3N0X3dvcmRzW3NdLmRpZmYudHJpbSgpOwogICAgICAgICAgICAgIG1vc3Rfd29yZHNbc10uZGlmZiA9IG1vc3Rfd29yZHNbc10uZGlmZiArICIgIjsKICAgICAgICAgICAgICBmaW5hbF9zZW50ZW5jZSA9IGZpbmFsX3NlbnRlbmNlICsgbW9zdF93b3Jkc1tzXS5kaWZmOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHZhciBmaW5hbF9zZW50ZW5jZSA9IG1vc3Rfd29yZHMuam9pbigiIik7CiAgICAgICAgICAgIGZpbmFsX3NlbnRlbmNlcy5wdXNoKHsKICAgICAgICAgICAgICBmaW5hbF9zZW50ZW5jZTogZmluYWxfc2VudGVuY2UsCiAgICAgICAgICAgICAgZmluYWxfd29yZHM6IG1vc3Rfd29yZHMsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBvbmx5X3NlbnRlbmNlcy5wdXNoKGZpbmFsX3NlbnRlbmNlKTsKICAgICAgICAgIH0KICAgICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgb25seV9zZW50ZW5jZXMubGVuZ3RoOyB0KyspIHsKICAgICAgICAgICAgdmFyIGZpbmFsX3NlbnRlbmNlMSA9IG9ubHlfc2VudGVuY2VzW3RdCiAgICAgICAgICAgICAgLnJlcGxhY2UoLyg8ZGVsW14+XSo/Pi4qPzxcL2RlbD4pL2csICIiKQogICAgICAgICAgICAgIC5yZXBsYWNlKC8oPGluc1tePl0qPz4pfCg8XC9pbnM+KS9nLCAiIikKICAgICAgICAgICAgICAucmVwbGFjZSgvKDxzdWJpbnNbXj5dKj8+KXwoPFwvc3ViaW5zPikvZywgIiIpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhvbmx5X3NlbnRlbmNlc1t0XSkKICAgICAgICAgICAgb25seV9zZW50ZW5jZXMxLnB1c2goZmluYWxfc2VudGVuY2UxKTsKICAgICAgICAgIH0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG9ubHlfc2VudGVuY2VzMSk7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZygiZmluYWxfY29udGV4dDogIiwgZmluYWxfc2VudGVuY2VzKTsKICAgICAgICAgIHRoaXMuZmluYWxfY29udGV4dCA9IGZpbmFsX3NlbnRlbmNlczsKICAgICAgICAgIHRoaXMuc2VudGVuY2VMaXN0ID0gb25seV9zZW50ZW5jZXMxOwogICAgICAgIH0pOwogICAgICAvLyBjb25zb2xlLmxvZygiYWFhYSIsIHRoaXMuZGJMaXN0KTsKICAgICAgLy/mmL7npLrmj5DnpLrkv6Hmga8KICAgICAgLy8gdGhpcy4kbWVzc2FnZSh7CiAgICAgIC8vICAgbWVzc2FnZTogIuW3suabtOaWsCIsCiAgICAgIC8vICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAvLyB9KTsKICAgIH0sCiAgICBjb21wYXJlKGF0dHIsIHJldikgewogICAgICAvL+esrOS6jOS4quWPguaVsOayoeacieS8oOmAkiDpu5jorqTljYfluo/mjpLliJcKICAgICAgaWYgKHJldiA9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXYgPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHJldiA9IHJldiA/IDEgOiAtMTsKICAgICAgfQogICAgICByZXR1cm4gZnVuY3Rpb24oYSwgYikgewogICAgICAgIGEgPSBhW2F0dHJdOwogICAgICAgIGIgPSBiW2F0dHJdOwogICAgICAgIGlmIChhIDwgYikgewogICAgICAgICAgcmV0dXJuIHJldiAqIC0xOwogICAgICAgIH0KICAgICAgICBpZiAoYSA+IGIpIHsKICAgICAgICAgIHJldHVybiByZXYgKiAxOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMDsKICAgICAgfTsKICAgIH0sCiAgICAvL0VTNuivreazlSDmlbDnu4Tljrvph40KICAgIHVuaXF1ZShhcnIpIHsKICAgICAgcmV0dXJuIEFycmF5LmZyb20obmV3IFNldChhcnIpKTsKICAgIH0sCiAgICBzaG93QWxsKGV2ZW50LCBpbmRleCwgc19pbmRleCkgewogICAgICBldmVudCB8fCAoZXZlbnQgPSB3aW5kb3cuZXZlbnQpOwogICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24KICAgICAgICA/IGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgOiAoZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZSk7CiAgICAgIHRoaXMudGFibGVEYXRhID0gW107CiAgICAgIC8vc19pbmRleOihqOekuuWPpeWtkOW6j+WPt++8m2luZGV46KGo56S65Y2V6K+N5bqP5Y+3CiAgICAgIHRoaXMuc2VlbiA9IHRydWU7CiAgICAgIHRoaXMuY3VycmVudCA9IGluZGV4OwogICAgICB0aGlzLnRlbXBpbmRleCA9IGluZGV4OwogICAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgLy8gdGhpcy5pc1Nob3dBbGwgPSB0cnVlOwogICAgICB2YXIgd29yZHMgPSB0aGlzLmRiTGlzdFtzX2luZGV4XS53b3JkczsKICAgICAgdGhpcy50YWJsZURhdGEgPSB3b3Jkc1tpbmRleF0uZGlmZnM7CiAgICAgIC8vIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50YWJsZURhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgLy8gICB0aGlzLnRhYmxlRGF0YVtpXS5uYW1lcyA9IHRoaXMudW5pcXVlKHRoaXMudGFibGVEYXRhW2ldLm5hbWVzKTsKICAgICAgLy8gdGhpcy50YWJsZURhdGFbaV0ubmFtZXMgPSB1bmlxdWVfbmFtZXMuam9pbigiLCAiKTsgLy9idWfvvJrmiopuYW1lc+i/meS4quaVsOe7hOWPmOaIkOS6huWtl+espuS4sgogICAgICAvLyB9CiAgICAgIHRoaXMuc2VuVGFibGVEYXRhID0gdGhpcy5kYkxpc3Rbc19pbmRleF0uc2VudGVuY2VEaWZmczsKICAgICAgLy8gY29uc29sZS5sb2coInNlblRhYmxlRGF0YTogIiwgdGhpcy5zZW5UYWJsZURhdGEpOwogICAgICAvLyBjb25zb2xlLmxvZygid29yZHM6ICIsIHdvcmRzKTsKICAgICAgLy8gY29uc29sZS5sb2coInRhYmxlRGF0YTogIiwgdGhpcy50YWJsZURhdGEpOwogICAgICB0aGlzLmNoYW5nZVBvcyhldmVudCk7CiAgICAgIC8vIGNvbnNvbGUubG9nKGV2ZW50KTsKICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCB0aGlzLmhpZGVQYW5lbCwgZmFsc2UpOwogICAgfSwKICAgIGNsb3NlU2hvdygpIHsKICAgICAgdGhpcy5zZWVuID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudCA9IG51bGw7CiAgICAgIHRoaXMudGVtcGluZGV4ID0gbnVsbDsKICAgICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlOwogICAgICAvLyB0aGlzLmlzU2hvd0FsbCA9IGZhbHNlOwogICAgICB2YXIgd29yZE9wZXJhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgid29yZE9wZXJhdGUiKTsKICAgICAgd29yZE9wZXJhdGUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCB0aGlzLmhpZGVQYW5lbCwgZmFsc2UpOwogICAgfSwKICAgIGhpZGVQYW5lbChlKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLm1haW4gJiYgIXRoaXMuJHJlZnMubWFpbi5jb250YWlucyhlLnRhcmdldCkpIHsKICAgICAgICAvL+eCueWHu+mZpOW8ueWHuuWxguWklueahOepuueZveWMuuWfnwogICAgICAgIHRoaXMuY2xvc2VTaG93KCk7CiAgICAgIH0KICAgIH0sCiAgICBwaXAoKSB7CiAgICAgIGlmICh0aGlzLmlzVmlkZW8pIHsKICAgICAgICB2YXIgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdmlkZW8gPiB2aWRlbyIpOwogICAgICAgIGlmICghZG9jdW1lbnQucGljdHVyZUluUGljdHVyZUVsZW1lbnQpIHsKICAgICAgICAgIC8v5byA5ZCvCiAgICAgICAgICB2aWRlby5yZXF1ZXN0UGljdHVyZUluUGljdHVyZSgpLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZygKICAgICAgICAgICAgICBlcnJvciwKICAgICAgICAgICAgICAiVmlkZW8gZmFpbGVkIHRvIGVudGVyIFBpY3R1cmUtaW4tUGljdHVyZSBtb2RlLiIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL+WFs+mXrQogICAgICAgICAgZG9jdW1lbnQuZXhpdFBpY3R1cmVJblBpY3R1cmUoKS5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICAgICAgZXJyb3IsCiAgICAgICAgICAgICAgIlZpZGVvIGZhaWxlZCB0byBsZWF2ZSBQaWN0dXJlLWluLVBpY3R1cmUgbW9kZS4iCiAgICAgICAgICAgICk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgIC8vIHRpdGxlOiAi6K2m5ZGKIiwKICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgIG1lc3NhZ2U6ICJQaWN0dXJlLWluLXBpY3R1cmUgaXMgbm90IHN1cHBvcnRlZC4iLAogICAgICAgICAgcG9zaXRpb246ICJ0b3AtcmlnaHQiLAogICAgICAgICAgb2Zmc2V0OiAxMDAsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCgogICAgLy8g6K6h566X5YiG5pWwCiAgICBjb3VudFNjb3JlcygpIHsKICAgICAgLy8gdGhpcy4kYXhpb3MKICAgICAgLy8gICAucG9zdCh0aGlzLmFwaSArICIvZ2V0VmVyc2lvbnMiLCB7IHBhcmFtczogeyBfaWQ6IHRoaXMuZGlmZklkIH0gfSkKICAgICAgLy8gICAudGhlbigocmVzKSA9PiB7CiAgICAgIC8vICAgICB0aGlzLnZlcnNpb25zTGlzdCA9IHJlcy5kYXRhOyAvL+iOt+WPluavj+S4quS6uueahOeJiOacrAogICAgICAvLyAgIH0pOwogICAgICB2YXIgeyB0cywgZm5sIH0gPSBjb3VudFRlY2hTY29yZXMoCiAgICAgICAgdGhpcy5kaWZmTGlzdCwKICAgICAgICB0aGlzLnB1Ymxpc2hlciwKICAgICAgICB0aGlzLnRlY2hQb2ludHMsCiAgICAgICAgdGhpcy5zdWJtaXR0ZWQsCiAgICAgICAgMC42LAogICAgICAgIDYKICAgICAgKTsKICAgICAgdmFyIHsgY21zLCBtcyB9ID0gY291bnRNYXRjaFBvaW50cygKICAgICAgICB0aGlzLnZlcnNpb25zTGlzdCwKICAgICAgICB0aGlzLnNlbnRlbmNlTGlzdCwKICAgICAgICB0aGlzLnB1Ymxpc2hlciwKICAgICAgICB0aGlzLnB1Ymxpc2hUaW1lLAogICAgICAgIHRoaXMuZGVhZGxpbmUsCiAgICAgICAgdGhpcy5tYXRjaFBvaW50cwogICAgICApOwogICAgICB0aGlzLnRlY2hTY29yZUxpc3QgPSB0czsKICAgICAgdGhpcy5tYXRjaFNjb3JlTGlzdCA9IG1zOwogICAgICB2YXIgc3VtID0gMDsKICAgICAgdmFyIHNjb3JlTGlzdCA9IFtdOwogICAgICB2YXIgcyA9IEFycmF5LmZyb20obmV3IFNldCh0aGlzLnN1Ym1pdHRlZCkpOyAvL+WmguesrOS4gOS4quS6uuWHuueOsOS4pOasoe+8jOWImeWOu+mZpOmHjeWkjeWAvAogICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHMubGVuZ3RoOyBqKyspIHsKICAgICAgICB2YXIgbmFtZSA9IHNbal07CiAgICAgICAgdGhpcy50ZWNoU2NvcmVMaXN0W25hbWVdID0gIXRoaXMudGVjaFNjb3JlTGlzdFtuYW1lXQogICAgICAgICAgPyAwCiAgICAgICAgICA6IHRoaXMudGVjaFNjb3JlTGlzdFtuYW1lXTsKICAgICAgICB0aGlzLm1hdGNoU2NvcmVMaXN0W25hbWVdID0gIXRoaXMubWF0Y2hTY29yZUxpc3RbbmFtZV0KICAgICAgICAgID8gMAogICAgICAgICAgOiB0aGlzLm1hdGNoU2NvcmVMaXN0W25hbWVdOwogICAgICAgIGlmIChuYW1lICE9IHRoaXMucHVibGlzaGVyKSB7CiAgICAgICAgICB2YXIgc2NvcmVzID0KICAgICAgICAgICAgTnVtYmVyKHRoaXMudGVjaFNjb3JlTGlzdFtuYW1lXSkgKwogICAgICAgICAgICBOdW1iZXIodGhpcy5tYXRjaFNjb3JlTGlzdFtuYW1lXSk7CiAgICAgICAgICBzdW0gKz0gc2NvcmVzOwogICAgICAgICAgc2NvcmVMaXN0LnB1c2goewogICAgICAgICAgICBuYW1lOiBuYW1lLAogICAgICAgICAgICBtYXRjaFNjb3JlczogdGhpcy5tYXRjaFNjb3JlTGlzdFtuYW1lXSwKICAgICAgICAgICAgdGVjaFNjb3JlczogdGhpcy50ZWNoU2NvcmVMaXN0W25hbWVdLAogICAgICAgICAgICBzY29yZXM6IHNjb3JlcywKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmF2ZXJTY29yZXMgPSBNYXRoLnJvdW5kKHN1bSAvIHNjb3JlTGlzdC5sZW5ndGgpOwoKICAgICAgc2NvcmVMaXN0LnNvcnQodGhpcy5jb21wYXJlKCJzY29yZXMiKSk7CiAgICAgIHZhciByYW5rTGlzdCA9IFtdOwoKICAgICAgdmFyIHBJbmRleCA9IHMuZmluZEluZGV4KChpdGVtKSA9PiBpdGVtID09IHRoaXMucHVibGlzaGVyKTsKICAgICAgcEluZGV4ICE9IC0xID8gcy5zcGxpY2UocEluZGV4LCAxKSA6IHM7CiAgICAgIC8vIOacieWPkeW4g+iAheWImeaKiuWPkeW4g+iAheWOu+aOiSzml6DliJnkv53mjIHljp/moLcKCiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcy5sZW5ndGg7IGorKykgewogICAgICAgIHNjb3JlTGlzdFtqXS5yYW5rID0gaiArIDE7CiAgICAgICAgcmFua0xpc3QucHVzaCh7IG5hbWU6IHNjb3JlTGlzdFtqXS5uYW1lLCByYW5rOiByYW5rIH0pOwogICAgICB9CgogICAgICBpZiAoc2NvcmVMaXN0ICE9IFtdICYmIHRoaXMuYXZlclNjb3JlcykgewogICAgICAgIHRoaXMudGVjaExpc3QgPSBmbmw7CiAgICAgICAgdGhpcy5tYXRjaExpc3QgPSBjbXM7CiAgICAgICAgdGhpcy5zY29yZUxpc3QgPSBzY29yZUxpc3Q7CiAgICAgICAgdGhpcy4kYXhpb3MucG9zdCh0aGlzLmFwaSArICIvdXBkYXRlU2NvcmVzTGlzdCIsIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBfaWQ6IHRoaXMuZGlmZklkLAogICAgICAgICAgICBzY29yZUxpc3Q6IHRoaXMuc2NvcmVMaXN0LAogICAgICAgICAgICB0ZWNoTGlzdDogdGhpcy50ZWNoTGlzdCwKICAgICAgICAgICAgbWF0Y2hMaXN0OiB0aGlzLm1hdGNoTGlzdCwKICAgICAgICAgICAgYXZlclNjb3JlczogdGhpcy5hdmVyU2NvcmVzLAogICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICAvL+iOt+W+l+WIhuaVsOWIl+ihqAogICAgaXNTY29yZXNMaXN0KCkgewogICAgICB2YXIgaW5kZXggPSBudWxsOwogICAgICB0aGlzLmNoZWNrU3RhdHVzKCk7IC8v5Yik5pat6Lqr5Lu9CiAgICAgIC8vIOWIpOaWreaPkOS6pOWQjeWNleaYr+WQpuWtmOWcqOWPkeW4g+iAhQogICAgICB2YXIgbmV3TGVuID0gQXJyYXkuZnJvbShuZXcgU2V0KHRoaXMuc3VibWl0dGVkKSk7CiAgICAgIHZhciBwSW5kZXggPSBuZXdMZW4uZmluZEluZGV4KChpdGVtKSA9PiBpdGVtID09IHRoaXMucHVibGlzaGVyKTsKICAgICAgLy8g5pyJ5Y+R5biD6ICF5YiZ5oqK5pWw57uE6ZW/5bqm5omj5Y67MSzml6DliJnkv53mjIHljp/moLcKICAgICAgbmV3TGVuID0gcEluZGV4ICE9IC0xID8gbmV3TGVuLmxlbmd0aCA6IG5ld0xlbi5sZW5ndGggLSAxOwoKICAgICAgaWYgKAogICAgICAgIHRoaXMuc2NvcmVMaXN0ID09ICIiIHx8CiAgICAgICAgdGhpcy5zY29yZUxpc3QgPT0gdW5kZWZpbmVkIHx8IC8v5aaC5p6cc2NvcmVMaXN05Li656m6CiAgICAgICAgIXRoaXMuYXZlclNjb3JlcyAvL+WmguaenOW5s+Wdh+WIhuS4uuepugogICAgICAgIC8vIHx8IGlzRXhjZWVkCiAgICAgICkgewogICAgICAgIGlmIChuZXdMZW4gPD0gMCkgewogICAgICAgICAgLy/liKTmlq3mmK/lkKblj5HluIPogIXkuLrnrKzkuIDkuKrmj5DkuqTnmoTkuroKICAgICAgICAgIHRoaXMuc2NvcmVzID0gIk5vIHBhcnRpY2lwYW50cyBub3chIjsKICAgICAgICAgIHRoaXMuaXNTdWJtaXR0ZWQgPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jb3VudFNjb3JlcygpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnNjb3JlTGlzdC5zb3J0KHRoaXMuY29tcGFyZSgic2NvcmVzIikpOwogICAgICBpZiAoCiAgICAgICAgdGhpcy5zdWJtaXR0ZWQuZmluZEluZGV4KChpdGVtKSA9PiBpdGVtID09PSB0aGlzLnVzZXJuYW1lKSA9PSAtMSB8fAogICAgICAgIHRoaXMudXNlcm5hbWUgPT0gdGhpcy5wdWJsaXNoZXIKICAgICAgKSB7CiAgICAgICAgLy/or6XnlKjmiLfmsqHmnInlj4LkuI7mnKzmrKHku7vliqHmiJbmmK/lj5HluIPogIUKICAgICAgICB0aGlzLnNjb3JlcyA9IHRoaXMuYXZlclNjb3JlcyArICLvvIjlubPlnYfliIbvvIkiOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBpbmRleCA9IHRoaXMuc2NvcmVMaXN0LmZpbmRJbmRleCgKICAgICAgICAgIChpdGVtKSA9PiBpdGVtLm5hbWUgPT09IHRoaXMudXNlcm5hbWUKICAgICAgICApOwogICAgICAgIHZhciByYW5rID0gdGhpcy5zY29yZUxpc3RbaW5kZXhdLnJhbms7CiAgICAgICAgdGhpcy5teVJhbmsgPSByYW5rOwogICAgICAgIHRoaXMuc2NvcmVzID0KICAgICAgICAgIHRoaXMuc2NvcmVMaXN0W2luZGV4XS5zY29yZXMgKyAiIOS9oOacrOasoei2hei2iuS6hiIgKyByYW5rICsgIiXnmoTkurrllpTvvIEiOwogICAgICB9CiAgICAgIGlmICh0aGlzLnVzZXJuYW1lID09IHRoaXMucHVibGlzaGVyKSB7CiAgICAgICAgLy8g5pu05paw5Y+R5biD6ICF4oCcbXlQdWJsaXNoZWTigJ3kuK3nmoTlubPlnYfliIYKICAgICAgICB0aGlzLiRheGlvcy5wb3N0KHRoaXMuYXBpICsgIi91cGRhdGVNeVB1Ymxpc2hlZFNjb3JlcyIsIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBfaWQ6IHRoaXMudXNlcklkLAogICAgICAgICAgICB0YXNrSWQ6IHRoaXMuZGlmZklkLAogICAgICAgICAgICBzY29yZUxpc3Q6IHRoaXMuc2NvcmVMaXN0LAogICAgICAgICAgICB0ZWNoTGlzdDogdGhpcy50ZWNoTGlzdCwKICAgICAgICAgICAgbWF0Y2hMaXN0OiB0aGlzLm1hdGNoTGlzdCwKICAgICAgICAgICAgYXZlclNjb3JlczogdGhpcy5hdmVyU2NvcmVzLAogICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICgKICAgICAgICB0aGlzLnN1Ym1pdHRlZC5maW5kSW5kZXgoKGl0ZW0pID0+IGl0ZW0gPT09IHRoaXMudXNlcm5hbWUpICE9IC0xICYmCiAgICAgICAgdGhpcy51c2VybmFtZSAhPSB0aGlzLnB1Ymxpc2hlcgogICAgICApIHsKICAgICAgICAvLyDmm7TmlrDnlKjmiLfigJxteVRhc2tz4oCd5Lit55qE5YiG5pWwCiAgICAgICAgdGhpcy4kYXhpb3MucG9zdCh0aGlzLmFwaSArICIvdXBkYXRlTXlUYXNrc1Njb3JlcyIsIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBfaWQ6IHRoaXMudXNlcklkLAogICAgICAgICAgICB0YXNrSWQ6IHRoaXMuZGlmZklkLAogICAgICAgICAgICBzY29yZXM6IHRoaXMuc2NvcmVMaXN0W2luZGV4XS5zY29yZXMKICAgICAgICAgICAgICA/IHRoaXMuc2NvcmVMaXN0W2luZGV4XS5zY29yZXMKICAgICAgICAgICAgICA6ICIiLAogICAgICAgICAgICB1c2VyUmFuazogdGhpcy5teVJhbmssCiAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgICB9CiAgICB9LAoKICAgIC8v5q+U6L6D5pel5pyf5aSn5bCPCiAgICBjb21wYXJlRGF0ZShEYXRlMSwgRGF0ZTIpIHsKICAgICAgaWYgKERhdGUxLnNlYXJjaCgiLyIpID09IC0xKSB7CiAgICAgICAgLy/lpoLmnpzmqKHlvI/kuLoiMjAyMS8wMi8wNiAwMDowMDowMCIKICAgICAgICBEYXRlMSA9IERhdGUxLnJlcGxhY2UoIi0iLCAiLyIpOyAvL+i9rOaNouaIkOagh+WHhuagvOW8jwogICAgICB9CiAgICAgIGlmIChEYXRlMi5zZWFyY2goIi8iKSA9PSAtMSkgewogICAgICAgIERhdGUyID0gRGF0ZTIucmVwbGFjZSgiLSIsICIvIik7CiAgICAgIH0KICAgICAgaWYgKERhdGUxLnNwbGl0KCIgIilbMF0gPT0gRGF0ZTIuc3BsaXQoIiAiKVswXSkgewogICAgICAgIC8v5aaC5p6c5piv5ZCM5LiA5aSp77yM5YiZ5q+U6L6D5pe25YiG56eSCiAgICAgICAgdmFyIHRpbWUxID0gRGF0ZTEuc3BsaXQoIiAiKVsxXS5zcGxpdCgiOiIpOwogICAgICAgIHZhciB0aW1lMiA9IERhdGUyLnNwbGl0KCIgIilbMV0uc3BsaXQoIjoiKTsKICAgICAgICB2YXIgdG90YWwxID0KICAgICAgICAgIE51bWJlcih0aW1lMVswXSkgKiAzNjAwICsgTnVtYmVyKHRpbWUxWzFdKSAqIDYwICsgTnVtYmVyKHRpbWUxWzJdKTsKICAgICAgICB2YXIgdG90YWwyID0KICAgICAgICAgIE51bWJlcih0aW1lMlswXSkgKiAzNjAwICsgTnVtYmVyKHRpbWUyWzFdKSAqIDYwICsgTnVtYmVyKHRpbWUyWzJdKTsKICAgICAgICByZXR1cm4gdG90YWwxIC0gdG90YWwyID49IDAgPyB0cnVlIDogZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIG9EYXRlMSA9IG5ldyBEYXRlKERhdGUxLnNwbGl0KCIgIilbMF0pOwogICAgICAgIHZhciBvRGF0ZTIgPSBuZXcgRGF0ZShEYXRlMi5zcGxpdCgiICIpWzBdKTsKICAgICAgICByZXR1cm4gb0RhdGUxID49IG9EYXRlMiA/IHRydWUgOiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIC8v5p+l55yL5YiG5pWw5YiX6KGoCiAgICBjaGVja1Njb3Jlc0RldGFpbHMoKSB7CiAgICAgIGlmICh0aGlzLmlzUHVibGlzaGVyKSB7CiAgICAgICAgdmFyIHBhdGggPSAiL2RpZmYvIiArIHRoaXMuZGlmZklkICsgIi9zY29yZXMiOwogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHBhdGgpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBwYXRoID0gIi9kaWZmLyIgKyB0aGlzLmRpZmZJZCArICIvc2NvcmVzU3R1IjsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaChwYXRoKTsKICAgICAgfQogICAgfSwKICAgIC8vIOajgOafpei6q+S7vQogICAgY2hlY2tTdGF0dXMoKSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuc3VibWl0dGVkLmZpbmRJbmRleCgoaXRlbSkgPT4gaXRlbSA9PSB0aGlzLnVzZXJuYW1lKTsKICAgICAgaWYgKHRoaXMudXNlcm5hbWUgPT0gdGhpcy5wdWJsaXNoZXIpIHsKICAgICAgICB0aGlzLmlzUHVibGlzaGVyID0gdHJ1ZTsKICAgICAgICB0aGlzLmlzU3VibWl0dGVkID0gdHJ1ZTsKICAgICAgfSBlbHNlIGlmIChpbmRleCAhPSAtMSkgewogICAgICAgIHRoaXMuaXNTdWJtaXR0ZWQgPSB0cnVlOwogICAgICB9CiAgICB9LAoKICAgIG1hbnVhbENvZmlybSgpIHsKICAgICAgLy/miYvliqjnoa7orqTlkI7miafooYznrpfliIbnmoTlh73mlbAKICAgICAgdGhpcy5pc1Njb3Jlc0xpc3QoKTsKICAgICAgdGhpcy5pc01hbnVhbCA9ICF0aGlzLmlzTWFudWFsOwogICAgICB0aGlzLmlzQ29uZmlybSA9ICF0aGlzLmlzQ29uZmlybTsKICAgICAgdGhpcy5zZXRNYW51YWwoKTsKICAgIH0sCgogICAgc2V0TWFudWFsKCkgewogICAgICAvL+iuvue9ruaYr+WQpuaJi+WKqOehruiupOWIhuaVsAogICAgICB0aGlzLiRheGlvcy5wb3N0KHRoaXMuYXBpICsgIi91cGRhdGVJc01hbnVhbCIsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIF9pZDogdGhpcy5kaWZmSWQsCiAgICAgICAgICBpc01hbnVhbDogdGhpcy5pc01hbnVhbCwKICAgICAgICAgIGlzQ29uZmlybTogdGhpcy5pc0NvbmZpcm0sCiAgICAgICAgfSwKICAgICAgfSk7CiAgICB9LAoKICAgIC8vdmlkZW8gcGxheSAmIGxvYWQgJiBwYXVzZQogICAgcGxheUZ1bmMoKSB7CiAgICAgIHRoaXMuaXNDb3VudFRpbWUgPSB0cnVlOwogICAgICBjb25zb2xlLmxvZygicGxheWluZyIpOwogICAgfSwKICAgIHBhdXNlRnVuYygpIHsKICAgICAgdGhpcy5pc0NvdW50VGltZSA9IGZhbHNlOwogICAgICBjb25zb2xlLmxvZygicGFzdXNlZCIpOwogICAgICAvLyB5b3VyIGNvZGUKICAgIH0sCiAgICBsb2FkZWQoKSB7CiAgICAgIHRoaXMuaXNDb3VudFRpbWUgPSBmYWxzZTsKICAgICAgY29uc29sZS5sb2coIndhaXRpbmciKTsKICAgIH0sCiAgICBzdGFydFRpbWUoKSB7CiAgICAgIHRoaXMuaXNDb3VudFRpbWUgPSB0cnVlOwogICAgICBjb25zb2xlLmxvZygibW92aW5nIik7CiAgICB9LAoKICAgIHVwZGF0ZVN0dWR5VGltZSgpIHsKICAgICAgbGV0IG5ld2RhdGUgPSB0aGlzLiRtb21lbnQobmV3IERhdGUoKSkuZm9ybWF0KCJZWVlZL01NL0REIEhIOm1tOnNzIik7CiAgICAgIHZhciB0aW1lc3BhbiA9IHRoaXMudGltZXNwYW47CiAgICAgIHRoaXMuJGF4aW9zLnBvc3QoIi9zY29yZS91cGRhdGVTdHVkeVRpbWUiLCB7CiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBfaWQ6IHRoaXMudXNlcklkLAogICAgICAgICAgbGlzdGVuVGltZTogdGltZXNwYW4sCiAgICAgICAgICByZWNvcmRUaW1lOiBuZXdkYXRlLAogICAgICAgIH0sCiAgICAgIH0pOwogICAgfSwKICB9LAogIC8v6aG16Z2i55Sf5oiQ5YmN6KaB5YGa55qE5bel5L2cCiAgY3JlYXRlZCgpIHsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJiZWZvcmV1bmxvYWQiLCB0aGlzLnVwZGF0ZVN0dWR5VGltZSk7CiAgICAvL+WPr+S7peiAg+iZkeWKoOS4quWKqOeUu++8jOWboOS4uuaciei+g+WkmuaVsOaNruimgeWKoOi9ve+8jOS4jeeEtuS8muaYvuW+l+mhtemdouWNoemhvwogICAgdGhpcy5kaWZmSWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuZGlmZklkOwogICAgdGhpcy51c2VybmFtZSA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXJOYW1lIik7CiAgICB0aGlzLiRheGlvcy5nZXQodGhpcy5hcGkgKyAiL3Byb2ZpbGU/bmFtZT0iICsgdGhpcy51c2VybmFtZSkudGhlbigocmVzKSA9PiB7CiAgICAgIHRoaXMudXNlcklkID0gcmVzLmRhdGFbMF0uX2lkOwogICAgICB0aGlzLnVzZXJTdGF0dXMgPSByZXMuZGF0YVswXS5zdGF0dXM7CiAgICB9KTsKICAgIHRoaXMuJGF4aW9zCiAgICAgIC5wb3N0KHRoaXMuYXBpICsgIi9nZXRWZXJzaW9ucyIsIHsgcGFyYW1zOiB7IF9pZDogdGhpcy5kaWZmSWQgfSB9KQogICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy52ZXJzaW9uc0xpc3QgPSByZXMuZGF0YTsgLy/ojrflj5bmr4/kuKrkurrnmoTniYjmnKwKICAgICAgfSk7CiAgICAvL+a4suafk+S5i+WJjeivt+axguaVsOaNru+8jOWIpOaWreaYr+WQpuacieesrOS4gOeJiOacrAogICAgdGhpcy4kYXhpb3MKICAgICAgLmdldCh0aGlzLmFwaSArICIvY3VycmVudFRhc2s/X2lkPSIgKyB0aGlzLmRpZmZJZCkKICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgIHZhciB2aWRlb19pZCA9IHJlcy5kYXRhWzBdLnZpZGVvSWQ7IC8v5a+55bqU6KeG6aKR55qEX2lkCiAgICAgICAgdGhpcy51c2VyTGlzdCA9IHJlcy5kYXRhWzBdLnVzZXJMaXN0OwogICAgICAgIHRoaXMuZGlmZkxpc3QgPSByZXMuZGF0YVswXS5kaWZmTGlzdDsKICAgICAgICB0aGlzLnB1Ymxpc2hlciA9IHJlcy5kYXRhWzBdLnB1Ymxpc2hlcjsKICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IHJlcy5kYXRhWzBdLnN1Ym1pdHRlZDsKICAgICAgICB0aGlzLnB1Ymxpc2hUaW1lID0gcmVzLmRhdGFbMF0udGltZTsKICAgICAgICB0aGlzLnRhc2tUaXRsZSA9IHJlcy5kYXRhWzBdLnRpdGxlOwogICAgICAgIHRoaXMuZGVhZGxpbmUgPSByZXMuZGF0YVswXS5kZWFkbGluZTsKICAgICAgICB0aGlzLnRhc2tMYWJlbHMgPSByZXMuZGF0YVswXS5sYWJlbDsKICAgICAgICB0aGlzLnNjb3JlTGlzdCA9IHJlcy5kYXRhWzBdLnNjb3JlTGlzdDsKICAgICAgICB0aGlzLnRlY2hMaXN0ID0gcmVzLmRhdGFbMF0udGVjaExpc3Q7CiAgICAgICAgdGhpcy5tYXRjaExpc3QgPSByZXMuZGF0YVswXS5tYXRjaExpc3Q7CiAgICAgICAgdGhpcy5hdmVyU2NvcmVzID0gcmVzLmRhdGFbMF0uYXZlclNjb3JlczsKICAgICAgICB0aGlzLmlzTWFudWFsID0gcmVzLmRhdGFbMF0uaXNNYW51YWw7CiAgICAgICAgdGhpcy5pc0NvbmZpcm0gPSByZXMuZGF0YVswXS5pc0NvbmZpcm07CiAgICAgICAgY29uc29sZS5sb2coImxsbCIsIHRoaXMuc3VibWl0dGVkKTsKCiAgICAgICAgLy8gbGV0IGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgIC8vIGxldCBuZXdkYXRlID0gZGF0ZS50b0xvY2FsZVN0cmluZygiY2hpbmVzZSIsIHsKICAgICAgICAvLyAgIGhvdXIxMjogZmFsc2UsCiAgICAgICAgLy8gfSk7CiAgICAgICAgbGV0IG5ld2RhdGUgPSB0aGlzLiRtb21lbnQobmV3IERhdGUoKSkuZm9ybWF0KCJZWVlZL01NL0REIEhIOm1tOnNzIik7CiAgICAgICAgdmFyIGlzT3V0ID0gdGhpcy5jb21wYXJlRGF0ZShuZXdkYXRlLCB0aGlzLmRlYWRsaW5lKTsKICAgICAgICBjb25zb2xlLmxvZygiaXNPdXQiLCBpc091dCk7CiAgICAgICAgaWYgKHRoaXMudXNlclN0YXR1cyA9PSAiMSIpIHsKICAgICAgICAgIHRoaXMuaXNUZWFjaGVyID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMudXNlclN0YXR1cyA9PSAiMCIpIHsKICAgICAgICAgIHRoaXMuaXNUZWFjaGVyID0gZmFsc2U7CiAgICAgICAgICBpZiAoaXNPdXQpIHsKICAgICAgICAgICAgdGhpcy5pc3JlYWRvbmx5ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRheGlvcwogICAgICAgICAgLmdldCh0aGlzLmFwaSArICIvY3VycmVudFZpZGVvUHVibGlzaGVyP25hbWU9IiArIHRoaXMucHVibGlzaGVyKQogICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICB0aGlzLnN0YXR1cyA9IHJlcy5kYXRhWzBdLnN0YXR1czsKICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09ICIxIikgewogICAgICAgICAgICAgIHRoaXMuaWRlbnRpdHkgPSAi6ICB5biIIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT0gIjIiKSB7CiAgICAgICAgICAgICAgdGhpcy5pZGVudGl0eSA9ICLnu4Tplb8iOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnVzZXJMaXN0KTsKICAgICAgICAvL+iOt+WPluinhumikei3r+W+hO+8jOS7juacjeWKoeWZqOiOt+WPlgogICAgICAgIHRoaXMuJGF4aW9zCiAgICAgICAgICAuZ2V0KHRoaXMuYXBpICsgIi9jdXJyZW50VmlkZW8/X2lkPSIgKyB2aWRlb19pZCkKICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgdGhpcy5maWxlTmFtZSA9IHJlcy5kYXRhWzBdLmZpbGVOYW1lOwogICAgICAgICAgICB2YXIgZmlsZXR5cGUgPSB0aGlzLmZpbGVOYW1lLnNwbGl0KCIuIilbMV07CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52aWRlb1R5cGUubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBpZiAoZmlsZXR5cGUgPT0gdGhpcy52aWRlb1R5cGVbaV0pIHsKICAgICAgICAgICAgICAgIHRoaXMuaXNWaWRlbyA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAvL+WFiOWIpOaWreaYr+WQpuacieS/ruaUueiusOW9le+8jOWGjeWIpOaWreaYr+WQpuacieesrOS4gOeJiOacrAogICAgICAgIGlmICh0aGlzLmRpZmZMaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICB0aGlzLiRheGlvcwogICAgICAgICAgICAuZ2V0KHRoaXMuYXBpICsgIi9hbGxWZXJzaW9ucz9faWQ9IiArIHRoaXMuZGlmZklkKQogICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgICAgICAvL+W9k+WJjeaXoOS6uuaPkOS6pOeJiOacrO+8jOaYvuekuui+k+WFpeahhgogICAgICAgICAgICAgICAgdGhpcy5pc3ZlcnNpb24xID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5pc3ZlcnNpb24xID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy50ZXh0X3YxID0gcmVzLmRhdGFbMF0udmVyc2lvbjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvL+W9ouaIkOe7vOWQiOeJiOacrAogICAgICAgICAgdGhpcy5jcmVhdGVGaW5hbFZlcnNpb24oKTsKICAgICAgICAgIHRoaXMuaXN2ZXJzaW9uMSA9IHRydWU7CiAgICAgICAgICB0aGlzLmlzRmluYWwgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICBpZiAodGhpcy5zdWJtaXR0ZWQubGVuZ3RoID09IDApIHsKICAgICAgdGhpcy5pc1Njb3Jlc0xpc3QoKTsKICAgIH0KICB9LAogIHVwZGF0ZWQoKSB7CiAgICAvL+WIpOaWreaYr+mfs+mikei/mOaYr+inhumikQogICAgdGhpcy5kZWNpZGVQbGF5ZXIoKTsKICAgIC8vIGxldCBkYXRlID0gbmV3IERhdGUoKTsKICAgIC8vIGxldCBuZXdkYXRlID0gZGF0ZS50b0xvY2FsZVN0cmluZygiY2hpbmVzZSIsIHsKICAgIC8vICAgaG91cjEyOiBmYWxzZSwKICAgIC8vIH0pOwogICAgbGV0IG5ld2RhdGUgPSB0aGlzLiRtb21lbnQobmV3IERhdGUoKSkuZm9ybWF0KCJZWVlZL01NL0REIEhIOm1tOnNzIik7CiAgICAvLygiMjAyMS8wMi8wNiAwMDowMDowMCIsICIyMDIxLzAyLzA1IDAwOjAwOjAwIiBuZXdkYXRlLCB0aGlzLmRlYWRsaW5lKQogICAgdmFyIGlzRERMID0gdGhpcy5jb21wYXJlRGF0ZShuZXdkYXRlLCB0aGlzLmRlYWRsaW5lKTsKICAgIGlmICgKICAgICAgdGhpcy5zdWJtaXR0ZWQubGVuZ3RoID49IDEgJiYKICAgICAgIXRoaXMuaXNNYW51YWwgJiYKICAgICAgKGlzRERMIHx8IHRoaXMuaXNDb25maXJtKQogICAgKSB7CiAgICAgIC8v5aaC5p6c5o+Q5Lqk5ZCN5Y2V5aSn5LqOMSzkuJTkuLroh6rliqjorqHnrpfvvIzov4fkuoZkZGzmiJblt7Lnu4/noa7orqTov4fvvIzliJnov5DooYzlh73mlbAKICAgICAgdGhpcy5pc1Njb3Jlc0xpc3QoKTsKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgIGlmICh0aGlzLmlzQ291bnRUaW1lKSB7CiAgICAgICAgdGhpcy50aW1lc3BhbiArPSAwLjE7CiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy50aW1lc3Bhbik7CiAgICAgIH0KICAgIH0sIDEwMCk7CiAgICAvL3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCB0aGlzLnVwZGF0ZVN0dWR5VGltZSkKICAgIC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJrZXlwcmVzcyIsIHRoaXMuc3RhcnRUaW1lKCkpOwoKICAgIGZ1bmN0aW9uIG9uWW91VHViZUlmcmFtZUFQSVJlYWR5KCkgewogICAgICB2YXIgdm0gPSB0aGlzOwogICAgICB2bS4kbW91bnQoIi53cmFwcGVyIik7CiAgICAgIHBsYXllciA9IG5ldyBZVC5QbGF5ZXIoJ3l0LXBsYXllcicsIHsKCQl2aWRlb0lkOiB2bS4kZGF0YS52aWRlb0lkLAoJCWV2ZW50czogewoJCQlvblJlYWR5KCkgewoJCQkJaWYocGxheWVyKSB7CgkJCQkJY29uc3QgW2FydGlzdCwgdGl0bGVdID0gcGxheWVyLmdldFZpZGVvRGF0YSgpLnRpdGxlLnNwbGl0KCcgLSAnKTsKCQkJCQljb25zdCB2aWRlb0lkID0gcGxheWVyLmdldFZpZGVvVXJsKCkuc3BsaXQoJz92PScpWzFdOwoJCQkJCQoJCQkJCXZtLiRkYXRhLmR1cmF0aW9uID0gTWF0aC5mbG9vcihwbGF5ZXIuZ2V0RHVyYXRpb24oKSk7CgkJCQkJdm0uJGRhdGEudGl0bGUgPSB0aXRsZS5zcGxpdCgnfCcpWzBdOwoJCQkJCXZtLiRkYXRhLmFydGlzdCA9IGFydGlzdDsKCQkJCQl2bS4kZGF0YS52aWRlb0lkID0gdmlkZW9JZDsKCQkJCX0KCQkJfQoJCX0KCX0pOwogICAgfQogIH0sCiAgZGVzdHJveWVkKCkgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoImJlZm9yZXVubG9hZCIsIHRoaXMudXBkYXRlU3R1ZHlUaW1lKTsKICAgIC8vIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJzY3JvbGwiLCB0aGlzLnNldEhlYWRQb3NpdGlvbiwgdHJ1ZSk7CiAgfSwKfTsK"},{"version":3,"sources":["diff.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6eA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"diff.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <!--  -->\n    <div class=\"buttons\">\n      <el-popover placement=\"left\" trigger=\"hover\" content=\"\">\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-arrow-down\"\n          circle\n          plain\n          v-if=\"isVideo\"\n          @click=\"toBest('#mainContent')\"\n          slot=\"reference\"\n        ></el-button>\n      </el-popover>\n      <br />\n      <el-popover placement=\"left\" trigger=\"hover\" content=\"\">\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-monitor\"\n          circle\n          plain\n          v-if=\"isVideo\"\n          @click=\"pip()\"\n          slot=\"reference\"\n        ></el-button>\n      </el-popover>\n      <br />\n      <el-popover placement=\"left\" trigger=\"hover\" content=\"\">\n        <el-button\n          type=\"primary\"\n          icon=\"el-icon-arrow-up\"\n          circle\n          plain\n          v-if=\"isVideo\"\n          @click=\"toTop()\"\n          slot=\"reference\"\n        ></el-button>\n      </el-popover>\n    </div>\n    <div>\n      <div class=\"video-container\">\n        <!--  -->\n        <div class=\"video-left-box\">\n          <div class=\"video-box\">\n            <vue-core-video-player\n              id=\"video\"\n              v-if=\"isVideo\"\n              :src=\"require('../assets/video/' + fileName)\"\n              cover=\"https://cdn.quasar.dev/img/parallax2.jpg\"\n              controls\n              :autoplay=\"autoplay\"\n              @play=\"playFunc\"\n              @pause=\"pauseFunc\"\n              @loadedmetadata=\"loaded\"\n            ></vue-core-video-player>\n            <audio\n              :src=\"require('../assets/video/' + fileName)\"\n              id=\"audio\"\n              controls\n              v-else\n              @play=\"playFunc\"\n              @pause=\"pauseFunc\"\n              @loadedmetadata=\"loaded\"\n              controlslist=\"nodownload\"\n            ></audio>\n\n<div class=\"wrapper\">\n\t<div class=\"player\">\n\t\t<div class=\"top\">\n\t\t\t<div id=\"yt-player\" ref=\"yt-player\"></div>\n\t\t\t<div class=\"artist\">\n\t\t\t\t<div class=\"name\">\n\t\t\t\t\t{{artist}}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"title\">\n\t\t\t\t\t{{title}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"time\">\n\t\t\t\t<div class=\"complete\">{{showPlayTime}}</div>\n\t\t\t\t<div class=\"current\">{{showCurrentPlayTime}}</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"record-wrapper\">\n\t\t\t\t<div class=\"record\" :class=\"{spin: isPlaying}\">\n\t\t\t\t\t<div class=\"image\" :style=\"{backgroundImage: `url(${recordImage})`}\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"controls\">\n\t\t\t<div class=\"grid\">\n\t\t\t\t<svg width=\"22\" height=\"22\" viewBox=\"0 0 22 22\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M1 5C1 2.79086 2.79086 1 5 1V1C7.20914 1 9 2.79086 9 5V5C9 7.20914 7.20914 9 5 9V9C2.79086 9 1 7.20914 1 5V5Z\" stroke=\"#5D626C\" stroke-width=\"2\" stroke-linecap=\"square\"/>\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M13 1H21V9H13V1Z\" stroke=\"#5D626C\" stroke-width=\"2\" stroke-linecap=\"square\"/>\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M1 13H9V21H1V13Z\" stroke=\"#5D626C\" stroke-width=\"2\" stroke-linecap=\"square\"/>\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M13 13H21V21H13V13Z\" stroke=\"#5D626C\" stroke-width=\"2\" stroke-linecap=\"square\"/>\n</svg>\n\t\t\t</div>\n\t\t\t<div class=\"repeat\">\n\t\t\t\t<svg width=\"18\" height=\"20\" viewBox=\"0 0 18 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14 5H4V9H2V3H14V0L18 4L14 8V5ZM4 15H14V11H16V17H4V20L0 16L4 12V15Z\" fill=\"#AFB5C0\"/>\n</svg>\n\t\t\t</div>\n\t\t\t<div class=\"prev\" @click=\"prev\">\n\t\t\t\t<svg width=\"23\" height=\"27\" viewBox=\"0 0 23 27\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M17.8896 23.7417C19.6365 24.9935 22.0673 23.7449 22.0673 21.5958V5.40423C22.0673 3.25511 19.6365 2.0065 17.8896 3.25828L6.59146 11.3541C5.12173 12.4072 5.12173 14.5928 6.59147 15.6459L17.8896 23.7417Z\" fill=\"#AFB5C0\"/>\n<rect y=\"4.26471\" width=\"2\" height=\"18\" fill=\"#AFB5C0\"/>\n</svg>\n\n\t\t\t</div>\n\t\t\t<div class=\"play\" @click=\"togglePlay\">\n\t\t\t\t<svg v-if=\"!isPlaying\" width=\"42\" height=\"51\" viewBox=\"0 0 42 51\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M9.05427 42.3186C7.29861 43.4702 4.96631 42.2107 4.96631 40.1111V4.8889C4.96631 2.78927 7.29861 1.52983 9.05427 2.68141L35.9034 20.2925C37.4928 21.335 37.4928 23.665 35.9034 24.7075L9.05427 42.3186Z\" fill=\"#383E47\"/>\n</svg>\n\t\t\t\t<span v-else></span>\n\t\t\t</div>\n\t\t\t<div class=\"next\" @click=\"next\">\n\t\t\t\t<svg width=\"23\" height=\"27\" viewBox=\"0 0 23 27\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M17.8896 23.7417C19.6365 24.9935 22.0673 23.7449 22.0673 21.5958V5.40423C22.0673 3.25511 19.6365 2.0065 17.8896 3.25828L6.59146 11.3541C5.12173 12.4072 5.12173 14.5928 6.59147 15.6459L17.8896 23.7417Z\" fill=\"#AFB5C0\"/>\n<rect y=\"4.26471\" width=\"2\" height=\"18\" fill=\"#AFB5C0\"/>\n</svg>\n\t\t\t</div>\n\t\t\t<div class=\"shuffle\">\n\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M6.59 5.17L1.41 0L0 1.41L5.17 6.58L6.59 5.17ZM10.5 0L12.54 2.04L0 14.59L1.41 16L13.96 3.46L16 5.5V0H10.5ZM9.42 10.82L10.83 9.41L13.96 12.54L16 10.5V16H10.5L12.55 13.95L9.42 10.82Z\" fill=\"#AFB5C0\"/>\n</svg>\n\t\t\t</div>\n\t\t\t<div class=\"heart\">\n\t\t\t\t<a target=\"_blank\" href=\"https://www.youtube.com/watch?v=8b-5N7B7qWI\">\n\t\t\t\t<svg width=\"24\" height=\"21\" viewBox=\"0 0 24 21\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path d=\"M20.2501 11.3912L20.4728 11.1713C21.9577 9.70875 22.4703 7.53982 21.7944 5.57969C21.1185 3.61957 19.3717 2.20964 17.2912 1.94482C15.2106 1.68 13.1586 2.60641 12.001 4.33315C10.8433 2.60641 8.79134 1.68 6.71077 1.94482C4.63021 2.20964 2.88345 3.61957 2.20753 5.57969C1.53161 7.53982 2.04424 9.70875 3.52914 11.1713L12.0001 19.5341\" stroke=\"#5D626C\" stroke-width=\"2\" stroke-linecap=\"square\"/>\n  <rect width=\"2\" height=\"8\" transform=\"translate(12 22) rotate(90 8 0)\" fill=\"#5D626C\"/>\n  <rect width=\"2\" height=\"8\" transform=\"translate(15 11)\" fill=\"#5D626C\"/>\n</svg></a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"timeline\" @click=\"jumpTo\" ref=\"timeline\">\n\t\t\t<div :style=\"{width: percentage + '%'}\"></div>\n\t\t</div>\n\t</div>\n</div>\n\n          </div>\n          <div id=\"menu\" class=\"q-pa-md q-gutter-sm\">\n            <q-btn\n              class=\"q-mx-xl\"\n              @click=\"goBack\"\n              color=\"purple-4\"\n              icon-right=\"fast_rewind\"\n              label=\"Backward\"\n            />\n            <q-btn\n              class=\"q-mx-xl\"\n              @click=\"goForward\"\n              color=\"purple-4\"\n              icon=\"fast_forward\"\n              label=\"Forward\"\n            />\n          </div>\n        </div>\n        <!--  -->\n        <div class=\"video-right-box\">\n          <q-card class=\"my-card\" flat bordered>\n            <q-item>\n              <q-item-section avatar>\n                <q-avatar>\n                  <img src=\"https://i04piccdn.sogoucdn.com/25ef1f0c2b4af7d7\" />\n                </q-avatar>\n              </q-item-section>\n\n              <q-item-section>\n                <q-item-label>{{ publisher }} ({{ identity }})</q-item-label>\n                <q-item-label caption\n                  >Posted on {{ publishTime.slice(0, 10) }} at\n                  {{ publishTime.slice(10) }}</q-item-label\n                >\n              </q-item-section>\n            </q-item>\n\n            <q-separator />\n\n            <q-list bordered separator>\n              <q-item clickable v-ripple class=\"row\">\n                <q-item-section class=\"col-4\">\n                  <div class=\"text-left text-weight-bold\">Title:</div>\n                </q-item-section>\n                <q-item-section class=\"col-8\">\n                  <div class=\"text-left\">{{ taskTitle }}</div>\n                </q-item-section>\n              </q-item>\n\n              <q-item clickable v-ripple class=\"row\">\n                <q-item-section class=\"col-4\">\n                  <div class=\"text-left text-weight-bold\">Deadline:</div>\n                </q-item-section>\n                <q-item-section class=\"col-8\">\n                  <div class=\"text-left\">{{ deadline }}</div>\n                </q-item-section>\n              </q-item>\n\n              <q-item clickable v-ripple class=\"row\">\n                <q-item-section class=\"col-4\">\n                  <div class=\"text-left text-weight-bold\">People:</div>\n                </q-item-section>\n                <q-item-section class=\"col-8\">\n                  <div class=\"text-left\">\n                    {{\n                      submitted.filter(\n                        (item, index, arr) => arr.indexOf(item) === index\n                      ).length\n                    }}\n                  </div>\n                </q-item-section>\n              </q-item>\n\n              <q-item clickable v-ripple class=\"row\">\n                <q-item-section class=\"col-4\">\n                  <div class=\"text-left text-weight-bold\">Score:</div>\n                </q-item-section>\n                <q-item-section class=\"col-8\">\n                  <div class=\"text-left\">{{ scores }}</div>\n                </q-item-section>\n              </q-item>\n\n              <q-item v-if=\"isSubmitted\">\n                <q-item-section class=\"col-12\">\n                  <div class=\"text-center\">\n                    <q-btn\n                      color=\"purple\"\n                      size=\"md\"\n                      @click=\"checkScoresDetails()\"\n                      >Scores Details</q-btn\n                    >\n                  </div>\n                </q-item-section>\n              </q-item>\n\n              <q-item class=\"column\" v-if=\"username == publisher && !isConfirm\">\n                <q-item-section class=\"col q-my-sm\">\n                  <div class=\"text-center\">\n                    <el-switch\n                      v-model=\"isManual\"\n                      active-text=\"\"\n                      inactive-text=\"\"\n                      @change=\"setManual()\"\n                    >\n                    </el-switch>\n                  </div>\n                </q-item-section>\n                <q-item-section\n                  class=\"col q-my-sm\"\n                  v-if=\"isManual && username == publisher\"\n                >\n                  <q-btn color=\"blue\" size=\"md\" @click=\"manualCofirm()\">\n                    \n                  </q-btn>\n                </q-item-section>\n              </q-item>\n            </q-list>\n          </q-card>\n        </div>\n      </div>\n      <el-button type=\"primary\" @click=\"countScores()\"></el-button>\n      <br />\n      <el-main v-loading=\"loading\" id=\"mainContent\">\n        <el-row :gutter=\"21\" type=\"flex\" class=\"row-bg\" justify=\"center\">\n          <el-col :span=\"21\" v-if=\"isversion1\">\n            <p class=\"edit-tip\"></p>\n            <div id=\"textDiv\">\n              <div>\n                <span v-for=\"(item, index) in final_context\" :key=\"index\">\n                  <span\n                    v-for=\"(final_word, final_word_index) in item.final_words\"\n                    :key=\"final_word_index\"\n                    @click=\"showAll($event, final_word_index, index)\"\n                    :class=\"{ active: isActive }\"\n                  >\n                    <el-badge :is-dot=\"final_word.isedited\" class=\"badge\">\n                      <span\n                        v-if=\"regtest.test(final_word.diff)\"\n                        v-html=\"final_word.diff\"\n                      >\n                      </span>\n                      <span v-else>\n                        {{ final_word.diff }}\n                      </span>\n                    </el-badge>\n                  </span>\n                </span>\n              </div>\n            </div>\n            <div class=\"q-pa-md q-gutter-sm edit-btn\" v-if=\"isTeacher\">\n              <q-btn\n                glossy\n                color=\"purple-6\"\n                icon=\"edit\"\n                @click=\"changev1()\"\n                label=\"\"\n              />\n            </div>\n            <div class=\"q-pa-md q-gutter-sm edit-btn\" v-else>\n              <q-btn\n                glossy\n                color=\"purple-6\"\n                icon=\"edit\"\n                @click=\"changev1()\"\n                label=\"Edit\"\n                v-show=\"isreadonly\"\n              />\n              <q-btn\n                glossy\n                color=\"purple-6\"\n                icon=\"edit\"\n                @click=\"returnback()\"\n                label=\"\"\n                v-show=\"isreadonly\"\n              />\n            </div>\n          </el-col>\n          <el-col :span=\"20\" v-else>\n            <div>\n              <p class=\"edit-tip\">\n                ~\n                \n              </p>\n              <el-input\n                type=\"textarea\"\n                :rows=\"15\"\n                :autosize=\"{ minRows: 15, maxRows: 30 }\"\n                placeholder=\"\"\n                v-model=\"text1\"\n                style=\"font-size: 20px\"\n              ></el-input>\n              <div class=\"q-px-md q-pt-md q-gutter-sm submit-btn\">\n                <q-btn color=\"purple\" @click=\"submitv1()\">Submit</q-btn>\n              </div>\n            </div>\n          </el-col>\n          <el-col :span=\"12\" v-if=\"isedit\">\n            <div>\n              <p class=\"edit-tip\"></p>\n              <div v-for=\"(item, i) in sentenceList\" :key=\"i\">\n                <el-input\n                  type=\"textarea\"\n                  :rows=\"1\"\n                  :autosize=\"{ minRows: 1, maxRows: 4 }\"\n                  v-model=\"sentenceList[i]\"\n                ></el-input>\n              </div>\n              <q-btn\n                @click=\"submitmv()\"\n                color=\"purple-5\"\n                icon=\"check\"\n                label=\"Confirm\"\n              />\n              <q-btn\n                class=\"q-mx-md\"\n                @click=\"cancelChangev1()\"\n                color=\"purple-5\"\n                icon=\"clear\"\n                label=\"Cancel\"\n              />\n              <q-btn\n                class=\"q-mx-md\"\n                @click=\"tempsave()\"\n                color=\"purple-5\"\n                icon=\"clear\"\n                label=\"\"\n              />\n            </div>\n          </el-col>\n        </el-row>\n      </el-main>\n      <el-button\n        type=\"info\"\n        icon=\"el-icon-more\"\n        circle\n        @click=\"showTimeline()\"\n      ></el-button>\n      <div v-if=\"isTimeline\">\n        \n        <el-radio-group v-model=\"reverse\">\n          <el-radio :label=\"true\"></el-radio>\n          <el-radio :label=\"false\"></el-radio>\n        </el-radio-group>\n        <el-timeline :reverse=\"reverse\">\n          <el-timeline-item\n            v-for=\"(version, index) in versions\"\n            :key=\"index\"\n            :timestamp=\"version.time\"\n            placement=\"bottom\"\n          >\n            <el-card>\n              <p>{{ version.version }}</p>\n              <br />\n              <p>{{ version.name }}</p>\n            </el-card>\n          </el-timeline-item>\n        </el-timeline>\n        <el-button\n          type=\"danger\"\n          icon=\"el-icon-close\"\n          circle\n          @click=\"closeTimeline()\"\n        ></el-button>\n      </div>\n    </div>\n    <div id=\"wordOperate\" ref=\"main\">\n      <a class=\"aui_close\" @click=\"closeShow()\"></a>\n      <el-table\n        :data=\"tableData.slice((currpage - 1) * pagesize, currpage * pagesize)\"\n        class=\"eltable\"\n      >\n        <el-table-column type=\"String\" prop=\"diff\" label=\"\" width=\"200\">\n          <template slot-scope=\"scope\">\n            <span v-html=\"scope.row.diff\"></span>\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"names\" label=\"\" width=\"380\">\n          <template slot-scope=\"scope\">\n            <span v-for=\"(item, i) in scope.row.names\" :key=\"i\">\n              <span\n                v-if=\"item.username == submitted[0]\"\n                style=\"font-weight: bold\"\n                >{{ item.username + \"; \" }}</span\n              >\n              <span v-else>{{ item.username + \"; \" }}</span>\n            </span>\n          </template>\n        </el-table-column>\n      </el-table>\n      <el-pagination\n        layout=\"prev, pager, next\"\n        :page-size=\"pagesize\"\n        :current-page=\"currpage\"\n        :total=\"tableData.length\"\n        @current-change=\"handleCurrentChange\"\n        @size-change=\"handleSizeChange\"\n      >\n      </el-pagination>\n      <!--  -->\n      <el-collapse>\n        <el-collapse-item style=\"padding-bottom: 1px\">\n          <template slot=\"title\">\n            <i class=\"header-icon el-icon-info\"></i>\n          </template>\n          <el-table\n            :data=\"\n              senTableData.slice(\n                (currpageS - 1) * pagesizeS,\n                currpageS * pagesizeS\n              )\n            \"\n            class=\"eltable\"\n          >\n            <el-table-column prop=\"provider\" label=\"\" width=\"80\">\n              <template slot-scope=\"scope\">\n                <span>\n                  {{ scope.row.provider }}\n                </span>\n              </template>\n            </el-table-column>\n            <el-table-column\n              type=\"String\"\n              prop=\"sentenceDiff\"\n              label=\"\"\n              width=\"500\"\n            >\n              <template slot-scope=\"scope\">\n                <span\n                  v-html=\"scope.row.sentenceDiff\"\n                  style=\"word-wrap: break-word; width: 500px\"\n                ></span>\n              </template>\n            </el-table-column>\n          </el-table>\n          <el-pagination\n            layout=\"prev, pager, next\"\n            :page-size=\"pagesizeS\"\n            :current-page=\"currpageS\"\n            :total=\"senTableData.length\"\n            @current-change=\"handleCurrentChangeS\"\n            @size-change=\"handleSizeChangeS\"\n          >\n          </el-pagination>\n        </el-collapse-item>\n      </el-collapse>\n    </div>\n  </div>\n</template>\n\n<script>\n// import { version } from 'xlsx/types';\nimport Avatar from \"vue-avatar\";\n\nvar differ = require(\"../diff.js\").differ;\nvar {\n  countTechScores,\n  countMatchPoints,\n  linearReg,\n} = require(\"../countScores.js\");\n\nlet musicInterval = null;\nlet player;\n\nexport default {\n  data() {\n    return {\n      userStatus: 0,\n      isreadonly: true,\n      isTeacher: false,\n      text1: \"\", //\n      isversion1: false, //\n      isFinal: false, //\n      text_v1: \"\", //text1\n      text_fn: \"\",\n      isedit: false, //\n      textDiv: \"\", //textDiv, \n      currentCompareText: \"\", //textDiv, \n      sentences: [], //\n      username: \"\",\n      diffList: [],\n      tableData: [], //\n      senTableData: [], //\n      pagesize: 3, //\n      currpage: 1, //\n      pagesizeS: 1, //\n      currpageS: 1, //\n      isActive: false,\n      seen: false,\n      tempindex: 0,\n      current: 0,\n      diffId: \"\", //_id\n      fileName: \"\",\n      userList: [],\n      inUserList: false,\n      api: \"/api\",\n      player: \"\", //\n      rateSelected: \"1.0\", //\n      isVideo: false, //\n      videoType: [\"AVI\", \"baiwma\", \"rmvb\", \"rm\", \"flash\", \"mp4\", \"mid\", \"3GP\"], //\n      sentenceList: [], //\n      final_context: [],\n      dbList: [],\n      regtest: /[<ins>|<del>|<subins>]/g,\n      loading: true, //\n      publisher: \"\",\n      status: \"1\",\n      identity: \"\",\n      submitted: [], //\n      isAddition: false, //\n      addition: \"\", //\n      autoplay: false, //\n      taskTitle: \"\",\n      deadline: \"\",\n      publishTime: \"\",\n      isTimeline: false,\n      versions: [],\n      reverse: true,\n      taskLabels: [],\n      userId: \"\",\n      versionsList: \"\", //created\n      techScoreList: {}, //\n      matchScoreList: {}, //\n      techList: [],\n      matchList: [],\n      scoreList: [], //\n      countMatchScores: [],\n      techPoints: 60, //\n      matchPoints: 40, //\n      scores: \"~\",\n      averScores: \"\", //\n      isPublisher: false,\n      isSubmitted: false,\n      taskCoins: 0, //\n      myRank: \"\",\n      timespan: 0, //video\n      isCountTime: false, //\n      isManual: \"\", //\n      isConfirm: \"\",\n      videoId: 'bJl-avjRgzU',\n      artist: \"Parcels\",\n      title: \"Lightenup\",\n      duration: 178,\n      currentTime: 0,\n      isPlaying: false\n    };\n  },\n  component: {\n    Avatar,\n  },\n  computed: {\n\t\trecordImage() {\n\t\t\treturn `https://img.youtube.com/vi/${this.videoId}/sddefault.jpg`;\n\t\t},\n\t\tpercentage() {\n\t\t\treturn this.currentTime / this.duration * 100;\n\t\t},\n\t\tshowPlayTime() {\n\t\t\tconst m = this.getMinutes(this.duration);\n\t\t\tconst s = this.getSeconds(this.duration);\n\t\t\treturn `${m}:${s}`;\n\t\t},\n\t\tshowCurrentPlayTime() {\n\t\t\tconst m = this.getMinutes(this.currentTime);\n\t\t\tconst s = this.getSeconds(this.currentTime);\n\n\t\t\treturn `${m}:${s}`;\n\t\t}\n\t},\n\twatch: {\n\t\tcurrentTime(time) {\n\t\t\tif (Math.round(time + 1) >= this.duration) {\n\t\t\t\tthis.togglePlay();\n\t\t\t\tthis.currentTime = 0;\n\t\t\t\tplayer.stopVideo();\n\t\t\t}\n\t\t}\n\t},\n  methods: {\n    prev() {\n\t\t\tif(player) {\n\t\t\t\tplayer.previousVideo();\n\t\t\t}\n\t\t},\t\t\n\t\tnext() {\n\t\t\tif(player) {\n\t\t\t\tconsole.log(player, player.getVideoUrl().split('?v=')[1])\n\t\t\t\tplayer.nextVideo();\n\t\t\t}\n\t\t},\n\t\tjumpTo(e) {\n\t\t\tconst trackPercentage = (e.layerX / this.$refs.timeline.offsetWidth) * 100;\n\t\t\t\n\t\t\tthis.playAt(this.duration / 100 * trackPercentage);\n\t\t},\n\t\tplayAt(seconds) {\n\t\t\tif(player) {\n\t\t\t\tplayer.seekTo(seconds);\n\t\t\t\tthis.currentTime = seconds;\n\t\t\t\t\n\t\t\t\tif(!this.isPlaying) {\n\t\t\t\t\tthis.togglePlay();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetMinutes(seconds) {\n\t\t\tconst m = Math.floor((seconds % 3600) / 60);\n\t\t\treturn m;\n\t\t},\n\t\tgetSeconds(seconds) {\n\t\t\tconst s = Math.floor((seconds % 3600) % 60);\n\t\t\treturn (s <= 9 ? \"0\" : \"\") + s;\n\t\t},\n\t\tinterval() {\n\t\t\tthis.currentTime = !player ? this.currentTime : Math.round(player.getCurrentTime());\n\t\t},\n\t\ttogglePlay() {\n\t\t\tif (!this.isPlaying) {\n\t\t\t\tmusicInterval = setInterval(this.interval, 1000);\n\t\t\t\tplayer.playVideo();\n\t\t\t\tplayer.unMute();\n\t\t\t} else {\n\t\t\t\tclearInterval(musicInterval);\n\t\t\t\tplayer.pauseVideo();\n\t\t\t}\n\n\t\t\tthis.isPlaying = !this.isPlaying;\n\t\t},\n\n    tempsave() {\n      this.$axios\n        .get(this.api + \"/currentTask?_id=\" + this.diffId)\n        .then((res) => {\n          this.userList = res.data[0].userList;\n          var isName = false;\n          for (var uh = 0; uh < this.userList.length; uh++) {\n            if (this.username == this.userList[uh].name) {\n              isName = true;\n              this.userList[uh].my_sentences = this.sentenceList;\n            }\n          }\n          //\n          if (isName == false) {\n            this.userList.push({\n              name: this.username,\n              my_sentences: this.sentenceList,\n            });\n          }\n\n          this.$axios.post(this.api + \"/tempsave\", {\n            params: {\n              _id: this.diffId,\n              userList: this.userList,\n            },\n          });\n          this.$notify({\n            type: \"success\",\n            message: \"\",\n            position: \"top-right\",\n            offset: 100,\n          });\n          this.isedit = false;\n        });\n    },\n    returnback() {\n      if (this.submitted.indexOf(this.username) >= 0) {\n        if (this.submitted.indexOf(this.username) == 0) {\n          if (this.submitted.indexOf(this.username, 1) == -1) {\n            var user_index = this.userList.findIndex(\n              (attr) => attr.name == this.username\n            );\n            if (user_index >= 0) {\n              this.isedit = true;\n              this.sentenceList = this.userList[user_index].my_sentences;\n            } else {\n              this.isedit = false;\n              this.$notify({\n                // title: \"\",\n                type: \"warning\",\n                message: \"\",\n                position: \"top-right\",\n                offset: 100,\n              });\n            }\n          } else {\n            this.isedit = false;\n            this.$notify({\n              // title: \"\",\n              type: \"warning\",\n              message: \"\",\n              position: \"top-right\",\n              offset: 100,\n            });\n          }\n        } else {\n          this.isedit = false;\n          this.$notify({\n            // title: \"\",\n            type: \"warning\",\n            message: \"\",\n            position: \"top-right\",\n            offset: 100,\n          });\n        }\n      } else {\n        var user_index = this.userList.findIndex(\n          (attr) => attr.name == this.username\n        );\n        if (user_index >= 0) {\n          this.sentenceList = this.userList[user_index].my_sentences;\n          this.isedit = true;\n        } else {\n          this.isedit = false;\n          this.$notify({\n            // title: \"\",\n            type: \"warning\",\n            message: \"\",\n            position: \"top-right\",\n            offset: 100,\n          });\n        }\n      }\n    },\n    showTimeline() {\n      this.$axios\n        .get(this.api + \"/allVersions?_id=\" + this.diffId)\n        .then((res) => {\n          // console.log(\"res data\", res.data);\n          this.versions = res.data;\n          if (this.versions.length > 0) {\n            this.isTimeline = true;\n          } else {\n            this.$notify({\n              // title: \"\",\n              type: \"warning\",\n              message: \"\",\n              position: \"top-right\",\n              offset: 100,\n            });\n          }\n        });\n    },\n    closeTimeline() {\n      this.isTimeline = false;\n    },\n    //document.querySelector\n    toBest(idName) {\n      document.querySelector(idName).scrollIntoView(true);\n    },\n    //\n    toTop() {\n      document.body.scrollTop = document.documentElement.scrollTop = 0;\n    },\n    //\n    changePos(event) {\n      var wordOperate = document.getElementById(\"wordOperate\");\n      wordOperate.style.position = \"fixed\";\n      wordOperate.style.display = \"inline-block\";\n      wordOperate.style.backgroundColor = \"white\";\n      if (event.clientX < window.screen.width / 2) {\n        wordOperate.style.left = event.clientX + 5 + \"px\";\n      } else {\n        wordOperate.style.left = event.clientX - wordOperate.offsetWidth + \"px\";\n      }\n\n      if (event.clientY > window.screen.height / 2) {\n        wordOperate.style.top = event.clientY - wordOperate.offsetHeight + \"px\";\n      } else {\n        wordOperate.style.top = event.clientY + \"px\";\n      }\n    },\n    //\n    decidePlayer() {\n      if (this.isVideo) {\n        this.player = document.querySelector(\"#video > video\");\n      } else {\n        this.player = document.getElementById(\"audio\");\n      }\n    },\n    //\n    // handleSpeed() {\n    //   this.player.playbackRate = this.rateSelected;\n    // },\n    //10\n    goBack() {\n      this.player.currentTime -= 10;\n    },\n    //10\n    goForward() {\n      this.player.currentTime += 10;\n    },\n    //\n    handleCurrentChange(val) {\n      this.currpage = val;\n    },\n    //\n    handleSizeChange(val) {\n      this.pagesize = val;\n    },\n    //\n    handleCurrentChangeS(val) {\n      this.currpageS = val;\n    },\n    //\n    handleSizeChangeS(val) {\n      this.pagesizeS = val;\n    },\n    //\n    submitv1() {\n      //\n      // let date = new Date();\n      // let newdate = date.toLocaleString(\"chinese\", {\n      //   hour12: false,\n      // });\n\n      let newdate = this.$moment(new Date()).format(\"YYYY/MM/DD HH:mm:ss\");\n\n      var flag = true;\n      var regstr = /([A-Za-z0-9\\'\\\"\\!\\?\\-\\:\\;\\.\\,\\%\\$\\&\\[ \\]])/;\n      var limited_words = 0;\n      this.$axios\n        .get(this.api + \"/currentTask?_id=\" + this.diffId)\n        .then((res) => {\n          limited_words = res.data[0].words;\n          // console.log(limited_words);\n          var video_id = res.data[0].videoId; //_id\n          var authcode = res.data[0].authcode; //\n          //\n          if (this.text1) {\n            var t_length = this.text1.split(\" \").length;\n            // console.log(t_length)\n            if (t_length > limited_words) {\n              for (var a = 0; a < this.text1.length; a++) {\n                var regResult = regstr.test(this.text1[a]);\n                // console.log(\"-----1\", regResult);\n                if (regResult === false) {\n                  // console.log(\"aaa\");\n                  flag = false;\n                }\n              }\n              // console.log(\"flag\", flag);\n              if (flag) {\n                this.$axios\n                  .post(this.api + \"/updateVersion\", {\n                    //\n                    params: {\n                      _id: this.diffId,\n                      time: newdate,\n                      new_version: this.text1,\n                      username: this.username,\n                      userId: this.userId,\n                    },\n                  })\n                  .then((result) => {\n                    // console.log(\"aaa\");\n                    this.$axios\n                      .get(this.api + \"/currentTask?_id=\" + this.diffId)\n                      .then((res) => {\n                        // console.log(\"111\");\n                        this.diffList = res.data[0].diffList;\n                        // console.log(\"diffList1\", this.diffList)\n                        this.userList = res.data[0].userList;\n                        if (this.diffList.length == 0) {\n                          this.$axios\n                            .get(this.api + \"/allVersions?_id=\" + this.diffId)\n                            .then((res) => {\n                              // console.log(\"res data\", res.data);\n                              var owner = res.data[0].name; //\n                              if (owner == this.username) {\n                                this.$notify({\n                                  type: \"success\",\n                                  message:\n                                    \"55\",\n                                  position: \"top-right\",\n                                  offset: 100,\n                                });\n                                if (\n                                  this.userList.indexOf(\n                                    this.userList.find(\n                                      (obj) => obj.name == owner\n                                    )\n                                  ) == -1\n                                ) {\n                                  this.userList.push({\n                                    name: owner,\n                                    my_sentences: [],\n                                  });\n                                }\n                                this.submitted.push(owner);\n                                this.$axios\n                                  .get(\n                                    this.api + \"/profile?name=\" + this.username\n                                  )\n                                  .then((res) => {\n                                    var userId = res.data[0]._id;\n                                    var userTasks = res.data[0].myTasks;\n                                    userTasks.push({\n                                      taskId: this.diffId,\n                                      videoId: video_id,\n                                      deadline: this.deadline,\n                                      authcode: authcode,\n                                      title: this.taskTitle,\n                                      label: this.taskLabels,\n                                      time: newdate,\n                                      scores: \"\",\n                                    });\n                                    // myTasks\n                                    this.$axios.post(\n                                      this.api + \"/updateMyTasks\",\n                                      {\n                                        params: {\n                                          _id: userId,\n                                          myTasks: userTasks,\n                                          time: newdate,\n                                        },\n                                      }\n                                    );\n                                  });\n                              } else {\n                                this.$notify({\n                                  // title: \"\",\n                                  type: \"warning\",\n                                  message:\n                                    \"1( _)\",\n                                  position: \"top-right\",\n                                  offset: 100,\n                                });\n                              }\n                              this.isversion1 = true;\n                              this.text_v1 = res.data[0].version;\n                              var diffList1 = [];\n                              //\n                              this.sentences = this.text_v1.split(\n                                /(?<=[^A-Z].[.?]) +(?=[A-Z])/g\n                              );\n                              // console.log(this.sentences);\n                              for (\n                                var sen = 0;\n                                sen < this.sentences.length;\n                                sen++\n                              ) {\n                                let words = this.sentences[sen].split(\" \"); //\n                                //\n                                for (var y = 0; y < words.length; y++) {\n                                  if (words[y] == \"\") {\n                                    words.splice(y, 1);\n                                    y = y - 1;\n                                  }\n                                }\n                                let word_list = []; //\n                                var names = new Array();\n                                var user_item = {\n                                  username: this.username,\n                                  edittime: newdate,\n                                };\n                                names.push(user_item);\n                                for (var wor = 0; wor < words.length; wor++) {\n                                  var wordItem = {\n                                    // index: wor,\n                                    word: words[wor],\n                                    diffs: [\n                                      {\n                                        diff: words[wor],\n                                        names: names,\n                                        num: 1,\n                                        time: newdate,\n                                        status: 0, //0=>1=>2=>-1=>\n                                      },\n                                    ],\n                                    isedited: false,\n                                    isfirst: true, //\n                                  };\n                                  word_list.push(wordItem);\n                                }\n                                //\n                                var sentence_item = {\n                                  sentences: [\n                                    {\n                                      provider: this.username,\n                                      sentence: this.sentences[sen],\n                                      time: newdate,\n                                    },\n                                  ],\n                                  words: word_list,\n                                  author: this.username,\n                                  sentenceDiffs: [\n                                    {\n                                      provider: this.username,\n                                      sentenceDiff: this.sentences[sen],\n                                    },\n                                  ],\n                                };\n                                diffList1.push(sentence_item);\n                              }\n                              var user_index = this.userList.findIndex(\n                                (attr) => attr.name == this.username\n                              );\n                              this.userList[\n                                user_index\n                              ].my_sentences = this.sentences;\n                              // console.log(\"deffList2\", diffList1)\n                              this.$axios\n                                .post(this.api + \"/updatediff\", {\n                                  //\n                                  params: {\n                                    _id: this.diffId,\n                                    diffList: diffList1,\n                                    userList: this.userList,\n                                    submitted: this.submitted,\n                                  },\n                                })\n                                .then((res) => {\n                                  // console.log(\"-------\" + res);\n                                  // this.$router.go(0);\n                                });\n                              this.$router.go(0);\n                              // this.createFinalVersion();\n                            });\n\n                          // this.createFinalVersion();\n                        } else {\n                          this.isversion1 = true;\n                          this.isFinal = true;\n                          //\n                          this.$router.go(0);\n                          // this.createFinalVersion();\n                          this.$notify({\n                            // title: \"\",\n                            type: \"warning\",\n                            message:\n                              \"1( _)\",\n                            position: \"top-right\",\n                            offset: 100,\n                          });\n                        }\n                      });\n                  });\n                // this.$router.go(0);\n                // this.createFinalVersion();\n              } else {\n                // console.log(flag);\n                this.$notify({\n                  // title: \"\",\n                  type: \"warning\",\n                  message: \"\",\n                  position: \"top-right\",\n                  offset: 100,\n                });\n              }\n            } else {\n              this.$notify({\n                // title: \"\",\n                type: \"warning\",\n                message: \"\" + limited_words + \"\",\n                position: \"top-right\",\n                offset: 100,\n              });\n            }\n          } else {\n            //\n            this.$notify({\n              // title: \"\",\n              type: \"warning\",\n              message: \"~\",\n              position: \"top-right\",\n              offset: 100,\n            });\n          }\n        });\n      // this.$router.go(0); //\n    },\n    //\n    editv1() {\n      this.$notify({\n        title: \"Tip\",\n        message: \"\",\n        position: \"top-right\",\n        offset: 100,\n      });\n      this.isAddition = true;\n      this.addition = \"\";\n    },\n    //\n    changev1() {\n      this.$axios\n        .get(this.api + \"/currentTask?_id=\" + this.diffId)\n        .then((res) => {\n          // this.submitted = res.data[0].submitted;\n          // console.log(\"changev1 submitted\", this.submitted);\n          if (this.submitted.indexOf(this.username) >= 0) {\n            // console.log(\n            //   \"this.submitted.indexOf(this.username)\",\n            //   this.submitted.indexOf(this.username)\n            // );\n            // console.log(\n            //   \"this.submitted.indexOf(this.username, 1)\",\n            //   this.submitted.indexOf(this.username, 1)\n            // );\n            if (this.submitted.indexOf(this.username) == 0) {\n              if (this.submitted.indexOf(this.username, 1) == -1) {\n                //\n                this.isedit = true;\n                //\n                // console.log(document.getElementById(\"textDiv\").innerHTML);\n                this.textDiv = document\n                  .getElementById(\"textDiv\")\n                  .innerHTML.replace(/(<span[^>]*?>)|(<\\/span>)/g, \"\");\n                //\n                this.currentCompareText = document\n                  .getElementById(\"textDiv\")\n                  .innerHTML.replace(/(<span[^>]*?>)|(<\\/span>)/g, \"\");\n              } else {\n                this.isedit = false;\n                this.$notify({\n                  // title: \"\",\n                  type: \"warning\",\n                  message: \"\",\n                  position: \"top-right\",\n                  offset: 100,\n                });\n              }\n            } else {\n              this.isedit = false;\n              this.$notify({\n                // title: \"\",\n                type: \"warning\",\n                message: \"\",\n                position: \"top-right\",\n                offset: 100,\n              });\n            }\n          } else {\n            //\n            this.isedit = true;\n            //\n            this.textDiv = document\n              .getElementById(\"textDiv\")\n              .innerHTML.replace(/(<span[^>]*?>)|(<\\/span>)/g, \"\");\n\n            //\n            this.currentCompareText = document\n              .getElementById(\"textDiv\")\n              .innerHTML.replace(/(<span[^>]*?>)|(<\\/span>)/g, \"\");\n          }\n        });\n    },\n    //\n    cancelChangev1() {\n      this.isedit = false;\n    },\n    //\n    findElem(arrayToSearch, attr, val) {\n      for (var i = 0; i < arrayToSearch.length; i++) {\n        if (arrayToSearch[i][attr] == val) {\n          return i;\n        }\n      }\n      return -1;\n    },\n    //\n    submitmv() {\n      this.$confirm(\", ?\", \"\", {\n        confirmButtonText: \"\",\n        cancelButtonText: \"\",\n        type: \"warning\",\n        center: true,\n      }).then(() => {\n        var flag1 = true;\n        var regstr = /([A-Za-z0-9\\'\\\"\\!\\?\\:\\-\\;\\.\\,\\%\\$\\&\\[ \\]])/;\n        for (var sl = 0; sl < this.sentenceList.length; sl++) {\n          //\n          for (var c = 0; c < this.sentenceList[sl].length; c++) {\n            var regResult = regstr.test(this.sentenceList[sl][c]);\n            // console.log(\"+++++3\", regResult);\n            if (regResult === false) {\n              // console.log(\"ccc\");\n              flag1 = false;\n            }\n          }\n        }\n        // console.log(\"flag1\", flag1);\n        if (flag1) {\n          //\n          // let date = new Date();\n          // let newdate = date.toLocaleString(\"chinese\", {\n          //   hour12: false,\n          // });\n          let newdate = this.$moment(new Date()).format(\"YYYY/MM/DD HH:mm:ss\");\n          //\n          this.$axios\n            .get(this.api + \"/currentTask?_id=\" + this.diffId)\n            .then((res) => {\n              this.dbList = res.data[0].diffList;\n            });\n          // console.log(\"dbDiffList\", this.dbList);\n          // console.log(\"sentenceList\", this.sentenceList);\n          var listLen = this.dbList.length;\n          //\n          var final_result = []; //\n          for (var len = 0; len < listLen; len++) {\n            var sen_result = []; //\n            var sentence = this.sentenceList[len]\n              .replace(/\\s{2,}/g, \" \")\n              .replace(/[\\r\\n]/g, \" \")\n              .replace(/(\\r\\n|\\n|\\r)/g, \" \");\n            //    \n            var v1_sentences = this.dbList[len].sentences.sort(\n              this.compare(\"time\")\n            );\n            // console.log(\"v1_sentences\", v1_sentences);\n            var v1_sentence = v1_sentences[v1_sentences.length - 1].sentence;\n            var s_result1 = differ\n              .parse(\" \" + v1_sentence, \" \" + sentence)\n              .replace(/%2C/g, \",\")\n              .replace(/%3F/g, \"?\")\n              .replace(/%27/g, \"'\")\n              .replace(/%3A/g, \":\");\n            //insdel-ins\n            // console.log(\"s_result1\", s_result1);\n            var reg = /([a-zA-Z0-9]+[\\-\\'\\.\\:]?[a-zA-Z0-9]*\\s(<ins[^>]*?>.*?<\\/ins>\\s)+)/g;\n            var insMatchResult = s_result1.match(reg);\n            // console.log(\"insMatchResult\", insMatchResult);\n            if (insMatchResult !== null) {\n              for (var m = 0; m < insMatchResult.length; m++) {\n                //\n                if (insMatchResult[m] == \"\") {\n                  insMatchResult.splice(m, 1);\n                  m = m - 1;\n                } else {\n                  s_result1 = s_result1.replace(insMatchResult[m], \"<>\"); // \n                  var del_content = insMatchResult[m].split(\" \")[0]; //\n                  var edited_ver =\n                    \"<del>\" +\n                    del_content +\n                    \"</del> <ins>\" +\n                    del_content +\n                    \"</ins>\";\n                  insMatchResult[m] = insMatchResult[m].replace(\n                    del_content,\n                    edited_ver\n                  );\n                }\n                s_result1 = s_result1\n                  .replace(\"<>\", insMatchResult[m])\n                  .replace(/(\\r\\n|\\n|\\r)/g, \" \");\n              }\n            }\n            // console.log(\"after\", s_result1);\n            var s_result_del = s_result1\n              .replace(/<ins[^>]*?>.*?<\\/ins>\\s/g, \"\")\n              .replace(/(\\r\\n|\\n|\\r)/g, \" \");\n            //insdelindex\n            var s_result_arr = s_result_del\n              .trim()\n              .split(/\\s/g)\n              .filter((d) => d);\n            // console.log(\"s_result_arr\", s_result_arr);\n            //  s_result_arr indexflagindex\n            var new_s_result_arr = s_result_arr.map((item, index) => {\n              var robj = {};\n              robj.index = index;\n              robj.word = item;\n              robj.flag = 0;\n              return robj;\n            });\n            // console.log(\"new_s_result_arr\", new_s_result_arr);\n            //\n            var allMatchResult = s_result1.match(\n              /((<del[^>]*?>.*?<\\/del>\\s)*(<ins[^>]*?>.*?<\\/ins>\\s)*)/g\n            );\n            // console.log(\"allMatchResult: \", allMatchResult);\n            //\n            for (var n = 0; n < allMatchResult.length; n++) {\n              //\n              if (allMatchResult[n] == \"\") {\n                allMatchResult.splice(n, 1);\n                n = n - 1;\n              } else {\n                var matchSplit = allMatchResult[n]\n                  .replace(\"\\n\", \" \")\n                  .replace(\"\", \" \")\n                  .trim()\n                  .split(/\\s/g);\n                // console.log(\"matchResult\", matchSplit);\n                var del = [];\n                var ins = [];\n                // var re1 = /<del[^>]*?>.*?<\\/del>/g;\n                // var re2 = /<ins[^>]*?>.*?<\\/ins>/g;\n                for (var t = 0; t < matchSplit.length; t++) {\n                  //\n                  // console.log(\"m\");\n                  if (matchSplit[t].indexOf(\"<ins>\")) {\n                    // console.log(\"matchSplit\", matchSplit[t]);\n                    // var del_index = s_result_arr.indexOf(matchSplit[t]);\n                    var finishedItem = new_s_result_arr.find(\n                      (item) => item.word == matchSplit[t] && item.flag == 0\n                    );\n                    if (finishedItem) {\n                      var finishedIndex = new_s_result_arr.findIndex(\n                        (item) => item == finishedItem\n                      );\n                      new_s_result_arr[finishedIndex].flag = 1;\n                      var del_index = finishedIndex;\n                      var del_item = {\n                        del: matchSplit[t],\n                        del_index: del_index,\n                      };\n                      del.push(del_item);\n                    }\n                  }\n                  if (matchSplit[t].indexOf(\"<del>\")) {\n                    ins.push(matchSplit[t]);\n                  }\n                }\n                // console.log(\"del arr\", del);\n                // console.log(\"ins arr\", ins);\n                if (ins.length == 0) {\n                  for (var d = 0; d < del.length; d++) {\n                    var diff1 = del[d].del.trim();\n                    // console.log(\"a\", diff1)\n                    var del_content1 = del[d].del.replace(\n                      /(<del[^>]*?>)|(<\\/del>)/g,\n                      \"\"\n                    );\n                    // console.log(\"del_content1\", del_content1)\n                    var item1 = {\n                      word: del_content1,\n                      diff: diff1,\n                      index: del[d].del_index,\n                      status: -1, //\n                    };\n                    sen_result.push(item1);\n                  }\n                }\n                if (del.length == 1 && ins.length > 0) {\n                  // console.log(\"del_del\", del[0]);\n                  var del_content2 = del[0].del\n                    .replace(/(<del[^>]*?>)|(<\\/del>)/g, \"\")\n                    .trim();\n                  var ins_content2 = ins[0].replace(\n                    /(<ins[^>]*?>)|(<\\/ins>)/g,\n                    \"\"\n                  );\n                  // console.log(\"del_content2\", del_content2);\n                  // console.log(\"ins_content2\", ins_content2);\n                  var diff2 = del[0].del.trim() + ins.join(\" \");\n                  var status2 = 2; //\n                  if (\n                    del_content2 == ins_content2 ||\n                    del_content2.slice(0, del_content2.length - 1) ==\n                      ins_content2\n                  ) {\n                    // console.log(\"del_content2 == ins_content2\");\n                    status2 = 1; //\n                    var ins_temp = ins.slice(1);\n                    diff2 = del_content2.trim() + \" \" + ins_temp.join(\" \");\n                  }\n                  // console.log(\"diff2\", diff2);\n                  // console.log(\"del_content2\", del_content2);\n                  var item2 = {\n                    word: del_content2,\n                    diff: diff2,\n                    index: del[0].del_index,\n                    status: status2,\n                  };\n                  sen_result.push(item2);\n                }\n                if (del.length > 1) {\n                  if (del.length == ins.length) {\n                    for (var a = 0; a < del.length; a++) {\n                      // console.log(del[a])\n                      var del_content3 = del[a].del.replace(\n                        /(<del[^>]*?>)|(<\\/del>)/g,\n                        \"\"\n                      );\n                      var ins_content3 = ins[a].replace(\n                        /(<ins[^>]*?>)|(<\\/ins>)/g,\n                        \"\"\n                      );\n                      // console.log(\"c\", del_content3)\n                      if (del_content3 !== ins_content3) {\n                        var item3 = {\n                          word: del_content3,\n                          diff: del[a].del.trim() + ins[a],\n                          index: del[a].del_index,\n                          status: 2,\n                        };\n                        sen_result.push(item3);\n                      }\n                    }\n                  }\n                  if (del.length < ins.length) {\n                    for (var b = 0; b < del.length; b++) {\n                      var del_content4 = del[b].del.replace(\n                        /(<del[^>]*?>)|(<\\/del>)/g,\n                        \"\"\n                      );\n                      // console.log(\"d\", del_content4)\n                      var diff4 = \"\";\n                      if (b == del.length - 1) {\n                        var temp_ins = ins.slice(b);\n                        diff4 = del[b].del.trim() + temp_ins.join(\" \");\n                      } else {\n                        diff4 = del[b].del.trim() + ins[b];\n                      }\n                      // console.log(\"d\", diff4)\n                      var ins_content4 = ins[b].replace(\n                        /(<ins[^>]*?>)|(<\\/ins>)/g,\n                        \"\"\n                      );\n                      if (del_content4 !== ins_content4) {\n                        var item4 = {\n                          word: del_content4,\n                          diff: diff4,\n                          index: del[b].del_index,\n                          status: 2,\n                        };\n                        sen_result.push(item4);\n                      }\n                    }\n                  }\n                  if (del.length > ins.length) {\n                    for (var c = 0; c < ins.length; c++) {\n                      var del_content5 = del[c].del.replace(\n                        /(<del[^>]*?>)|(<\\/del>)/g,\n                        \"\"\n                      );\n                      var ins_content5 = ins[c].replace(\n                        /(<ins[^>]*?>)|(<\\/ins>)/g,\n                        \"\"\n                      );\n                      // console.log(\"e\", del_content5)\n                      if (del_content5 !== ins_content5) {\n                        var item5 = {\n                          word: del_content5,\n                          diff: del[c].del.trim() + ins[c],\n                          index: del[c].del_index,\n                          status: 2,\n                        };\n                        sen_result.push(item5);\n                      }\n                    }\n                    var temp_del = del.slice(ins.length, del.length);\n                    for (var f = 0; f < temp_del.length; f++) {\n                      var diff6 = temp_del[f].del.trim();\n                      var del_content6 = temp_del[f].del.replace(\n                        /(<del[^>]*?>)|(<\\/del>)/g,\n                        \"\"\n                      );\n                      // console.log(\"e\", diff6)\n                      // console.log(\"e\", del_content6)\n                      var item6 = {\n                        word: del_content6,\n                        diff: diff6,\n                        index: temp_del[f].del_index,\n                        status: -1,\n                      };\n                      sen_result.push(item6);\n                    }\n                  }\n                }\n              }\n            }\n            final_result.push(sen_result);\n          }\n          // console.log(\"final_result: \", final_result);\n          //\n          //\n          this.$axios\n            .get(this.api + \"/currentTask?_id=\" + this.diffId)\n            .then((res) => {\n              this.dbList = res.data[0].diffList;\n            });\n          // console.log(\"dbDiffList2\", this.dbList);\n          for (var r = 0; r < final_result.length; r++) {\n            //rr\n            var s_orders = final_result[r]; //r\n            // console.log(\"s_orders: \", s_orders);\n            var s_words = this.dbList[r].words; //r\n            // console.log(\"s_words: \", s_words);\n            var s_sentences = this.dbList[r].sentenceDiffs; //r\n            //\n            var new_sentences = this.dbList[r].sentences;\n            if (s_orders.length == 0) {\n              //r\n              // \n              s_words.forEach((item) => {\n                var no_edited_word = item.word;\n                var no_edited_index = item.diffs.findIndex(\n                  (attr) => attr.diff == no_edited_word\n                );\n                item.diffs[no_edited_index].names.push({\n                  username: this.username,\n                  edittime: newdate,\n                });\n                item.diffs[no_edited_index].num++;\n                item.diffs[no_edited_index].time = newdate;\n              });\n              var filtered_words = s_words.map((item) => {\n                for (var ele = 0; ele < item.diffs.length; ele++) {\n                  var name_index = this.findElem(\n                    item.diffs[ele].names,\n                    \"username\",\n                    this.username\n                  );\n                  if (name_index != -1) {\n                    if (item.diffs[ele].hasOwnProperty(\"styleDiff\")) {\n                      return item.diffs[ele].styleDiff;\n                    } else {\n                      return item.diffs[ele].diff;\n                    }\n                  }\n                }\n              });\n              // console.log(\"filtered_words\", filtered_words);\n              var filtered_sen = filtered_words.join(\" \");\n\n              s_sentences.push({\n                provider: this.username,\n                sentenceDiff: filtered_sen,\n              });\n            } else {\n              //r\n              // \n              // \n              var editing_words = [];\n              s_words.forEach((item, index) => {\n                var itemIndex = index;\n                var replacedItemIndex = s_orders.indexOf(\n                  s_orders.find((element) => element.index == itemIndex)\n                );\n                if (replacedItemIndex != -1) {\n                  if (s_orders[replacedItemIndex].status == 1) {\n                    //   \n                    var find_index = this.findElem(item.diffs, \"status\", 0);\n                    // console.log(\"find_indexaaaa\", find_index);\n                    item.diffs[find_index].names.push({\n                      username: this.username,\n                      edittime: newdate,\n                    });\n                    item.diffs[find_index].num++;\n                    item.diffs[find_index].time = newdate;\n\n                    var r_ins_words = s_orders[replacedItemIndex].diff.split(\n                      \" \"\n                    );\n                    var ins_words = r_ins_words.slice(1);\n\n                    if (\n                      s_words[index - 1].diffs[0].hasOwnProperty(\"styleDiff\") &&\n                      s_words[index - 1].isfirst == false\n                    ) {\n                      var reg_end = /\\,|\\.|\\!|\\?|\\.\\\"|\\.\\'|\\!\\\"|\\!\\'|\\?\\\"|\\?\\'/g;\n                      var bf_ins_dw_i = s_words[index - 1].diffs.findIndex(\n                        (elem) => {\n                          return elem.diff === s_words[index - 1].word;\n                        }\n                      );\n\n                      var temp_ins_sdf = item.diffs[bf_ins_dw_i].styleDiff;\n                      // console.log(\"temp_ins_sdf1111\", temp_ins_sdf);\n\n                      if (\n                        reg_end.test(\n                          temp_ins_sdf\n                            .match(/(?<=<subins>).*?(?=<\\/subins>)/g)[0]\n                            .slice(-1)\n                        )\n                      ) {\n                        temp_ins_sdf = temp_ins_sdf.replace(\n                          temp_ins_sdf.slice(-10),\n                          \"</subins>\"\n                        );\n                        item.word = temp_ins_sdf.replace(\n                          /<subins>|<\\/subins>/g,\n                          \"\"\n                        );\n                        item.diffs[bf_ins_dw_i].diff = item.word;\n                        item.diffs[bf_ins_dw_i].styleDiff = temp_ins_sdf;\n                      } else if (\n                        reg_end.test(\n                          temp_ins_sdf\n                            .match(/(?<=<subins>).*?(?=<\\/subins>)/g)[0]\n                            .slice(-2)\n                        )\n                      ) {\n                        temp_ins_sdf = temp_ins_sdf.replace(\n                          temp_ins_sdf.slice(-11),\n                          \"</subins>\"\n                        );\n                        item.word = temp_ins_sdf.replace(\n                          /<subins>|<\\/subins>/g,\n                          \"\"\n                        );\n                        item.diffs[bf_ins_dw_i].diff = item.word;\n                        item.diffs[bf_ins_dw_i].styleDiff = temp_ins_sdf;\n                      }\n\n                      // console.log(\"\", item.word);\n                      // console.log(\"temp_ins_sdf2222222\", temp_ins_sdf);\n\n                      var ins_words_arr = [\n                        {\n                          word: temp_ins_sdf,\n                          diffs: [\n                            {\n                              diff: temp_ins_sdf, //\n                            },\n                          ],\n                          isedited: false,\n                        },\n                      ];\n                    } else {\n                      var reg_end = /\\.|\\!|\\?|\\.\\\"|\\.\\'|\\!\\\"|\\!\\'|\\?\\\"|\\?\\'/g;\n                      var temp_ins = r_ins_words[0];\n                      var bf_ins_dw_i = item.diffs.findIndex((elem) => {\n                        return elem.diff === item.word;\n                      });\n                      // console.log(\"bf_ins_dw_i\", bf_ins_dw_i);\n                      if (reg_end.test(temp_ins[temp_ins.length - 1])) {\n                        temp_ins = temp_ins.slice(0, temp_ins.length - 1);\n                        item.word = temp_ins;\n                        // console.log(\n                        //   \"item.diffs[bf_ins_dw_i]\",\n                        //   item.diffs[bf_ins_dw_i]\n                        // );\n                        item.diffs[bf_ins_dw_i].diff = temp_ins;\n                      }\n                      if (reg_end.test(temp_ins.slice(-2))) {\n                        temp_ins = temp_ins.slice(0, temp_ins.length - 2);\n                        item.word = temp_ins;\n                        item.diffs[bf_ins_dw_i].diff = temp_ins;\n                      }\n                      var ins_words_arr = [\n                        {\n                          word: temp_ins,\n                          diffs: [\n                            {\n                              diff: temp_ins, //\n                            },\n                          ],\n                          isedited: false,\n                        },\n                      ];\n                    }\n\n                    //I love China.\n                    //I very love China too.\n                    ins_words.forEach((i) => {\n                      var i_word = i.replace(/(<ins[^>]*?>)|(<\\/ins>)/g, \"\");\n                      var i_index = s_orders[replacedItemIndex].index + 1;\n                      var i_names = new Array();\n                      var user_item = {\n                        username: this.username,\n                        edittime: newdate,\n                      };\n                      i_names.push(user_item);\n                      var ins_wordItem = {\n                        index: i_index,\n                        word: i_word,\n                        diffs: [\n                          {\n                            diff: i_word,\n                            styleDiff: \"<subins>\" + i_word + \"</subins>\",\n                            names: i_names,\n                            num: 1,\n                            time: newdate,\n                            status: 0,\n                          },\n                        ],\n                        isedited: false,\n                        isfirst: false, //\n                      };\n                      ins_words_arr.push(ins_wordItem);\n                    });\n                    editing_words.push(ins_words_arr);\n                  } else {\n                    var find_result = this.findElem(\n                      item.diffs,\n                      \"diff\",\n                      s_orders[replacedItemIndex].diff\n                    );\n                    if (find_result == -1) {\n                      //\n                      var names = new Array();\n                      var user_item = {\n                        username: this.username,\n                        edittime: newdate,\n                      };\n                      names.push(user_item);\n                      var diff_item = {\n                        diff: s_orders[replacedItemIndex].diff,\n                        names: names,\n                        num: 1,\n                        time: newdate,\n                        status: s_orders[replacedItemIndex].status,\n                      };\n                      item.diffs.push(diff_item);\n                      item.isedited = true;\n                    } else {\n                      item.diffs[find_result].names.push({\n                        username: this.username,\n                        edittime: newdate,\n                      }); //\n                      item.diffs[find_result].num++; //1\n                      item.diffs[find_result].time = newdate; //\n                    }\n                    var word_diff = item.word.replace(\n                      item.word,\n                      s_orders[replacedItemIndex].diff\n                    );\n                    editing_words.push(word_diff);\n                  }\n                } else {\n                  var no_edited_word = item.word;\n                  // console.log(\"no_edited_word\", no_edited_word);\n                  // console.log(\"item.diffs\", item.diffs);\n                  var no_edited_index = item.diffs.findIndex((attr) => {\n                    return attr.diff == no_edited_word;\n                  });\n                  // console.log(\"no_edited_index\", no_edited_index);\n                  item.diffs[no_edited_index].names.push({\n                    username: this.username,\n                    edittime: newdate,\n                  });\n                  item.diffs[no_edited_index].num++;\n                  item.diffs[no_edited_index].time = newdate;\n\n                  if (item.isfirst == true) {\n                    editing_words.push(item.word);\n                  } else {\n                    // console.log(\n                    //   \"no_edited_word>>item.diffs[no_edited_index].styleDiff\",\n                    //   item.diffs[no_edited_index].styleDiff\n                    // );\n                    editing_words.push(item.diffs[no_edited_index].styleDiff);\n                  }\n                }\n              });\n              // console.log(\"editing_words1\", editing_words);\n              var deepFlatten = (arr) =>\n                [].concat(\n                  ...arr.map((v) => (Array.isArray(v) ? deepFlatten(v) : v))\n                );\n\n              var more_ins_arr = []; //\n              for (var ma = 0; ma < editing_words.length; ma++) {\n                if (Array.isArray(editing_words[ma])) {\n                  more_ins_arr.push(editing_words[ma].slice(1));\n                }\n              }\n              // console.log(\"more_ins_arr\", more_ins_arr); //more_ins_arr [[1, 2, 3], [4, 5], [7, 8]]\n              var more_ins_arr1 = deepFlatten(more_ins_arr);\n              // console.log(\"more_ins_arr1\", more_ins_arr1); //[1, 2, 3, 4, 5, 7, 8]\n\n              for (var va = 0; va < more_ins_arr1.length; va++) {\n                if (more_ins_arr1[va].word == \"\") {\n                  more_ins_arr1.splice(va, 1);\n                } else {\n                  more_ins_arr1[va].index = more_ins_arr1[va].index + va;\n                  s_words.splice(more_ins_arr1[va].index, 0, more_ins_arr1[va]);\n                }\n              }\n\n              // console.log(\"s_words2222\", s_words);\n              //\n              if (more_ins_arr1.length > 0) {\n                var reg_end = /\\,|\\.|\\!|\\?|\\.\\\"|\\.\\'|\\!\\\"|\\!\\'|\\?\\\"|\\?\\'/g;\n                // var reg_end = /\\.|\\!|\\?/g;\n                for (var wr = 0; wr < s_words.length - 1; wr++) {\n                  var word = s_words[wr].word;\n                  var diffs = s_words[wr].diffs;\n                  // console.log(\"111111\", diffs);\n                  // console.log(\"11112\", word);\n                  var no_edited_index = diffs.findIndex(\n                    (attr) => attr.diff === word\n                  );\n                  // console.log(\"+++++++\", no_edited_index);\n                  if (reg_end.test(word[word.length - 1])) {\n                    word = word.slice(0, word.length - 1);\n                    // console.log(\"-------\", word);\n                    diffs[no_edited_index].diff = diffs[\n                      no_edited_index\n                    ].diff.slice(0, diffs[no_edited_index].diff.length - 1);\n                    // console.log(\"-------\", diffs[no_edited_index].diff);\n                  }\n                  if (reg_end.test(word.slice(-2))) {\n                    word = word.slice(0, word.length - 2);\n                    diffs[no_edited_index].diff = diffs[\n                      no_edited_index\n                    ].diff.slice(0, diffs[no_edited_index].diff.length - 2);\n                  }\n                }\n                var v1_words = [];\n                v1_words = s_words.map((word) => {\n                  return word.word;\n                });\n                var new_sentence = v1_words.join(\" \");\n                var new_item = {\n                  provider: this.username,\n                  sentence: new_sentence,\n                  time: newdate,\n                };\n                new_sentences.push(new_item);\n              }\n\n              // console.log(\"s_words3333\", s_words);\n\n              editing_words = deepFlatten(\n                editing_words.map((w) => {\n                  if (Array.isArray(w) == true) {\n                    var sub_word = w.map((iw) => {\n                      if (iw.diffs[0].hasOwnProperty(\"styleDiff\")) {\n                        // console.log(\n                        //   \"iw.diffs[0].styleDiff\",\n                        //   iw.diffs[0].styleDiff\n                        // );\n                        return iw.diffs[0].styleDiff;\n                      } else {\n                        // console.log(\"iw.diffs[0].diff\", iw.diffs[0].diff);\n                        return iw.diffs[0].diff;\n                      }\n                    });\n                    return sub_word;\n                  } else {\n                    return w;\n                  }\n                })\n              );\n\n              // console.log(\"editing_words2\", editing_words);\n              //[\"In\", \"<subins>@@@</subins>\", \"<subins>@@@@@@@@@@@</subins>\", \"<del>have</del><ins>had</ins>\", \"earthquake.\"]\n              var editing_sentence = editing_words.join(\" \");\n              s_sentences.push({\n                provider: this.username,\n                sentenceDiff: editing_sentence,\n              });\n              // console.log(\"sentenceDiffs: \", s_sentences);\n            }\n          }\n          // console.log(\"bbb\", this.dbList);\n\n          //userList\n          for (var h = 0; h < this.userList.length; h++) {\n            if (this.username == this.userList[h].name) {\n              this.inUserList = true;\n            }\n          }\n          //\n          if (this.inUserList == false) {\n            this.userList.push({\n              name: this.username,\n              my_sentences: this.sentenceList,\n            });\n          }\n          console.log(\"submitmv submitted\", this.submitted);\n          this.submitted.push(this.username);\n\n          //\n          this.$axios.post(this.api + \"/updatediff\", {\n            params: {\n              _id: this.diffId,\n              userList: this.userList,\n              diffList: this.dbList,\n              submitted: this.submitted,\n            },\n          });\n\n          var new_version = this.sentenceList.join(\" \");\n          this.$axios.post(this.api + \"/updateVersion\", {\n            params: {\n              _id: this.diffId,\n              new_version: new_version,\n              time: newdate,\n              username: this.username,\n              userId: this.userId,\n            },\n          });\n\n          // \n          this.$axios\n            .get(this.api + \"/currentTask?_id=\" + this.diffId)\n            .then((res) => {\n              //diffList\n              this.diffList = res.data[0].diffList;\n              // let date1 = new Date();\n              // let newdate1 = date1.toLocaleString(\"chinese\", {\n              //   hour12: false,\n              // });\n              let newdate1 = this.$moment(new Date()).format(\n                \"YYYY/MM/DD HH:mm:ss\"\n              );\n              if (\n                this.username == this.publisher &&\n                !this.isManual &&\n                this.compareDate(newdate1, this.deadline)\n              ) {\n                this.countScores(); //\"2021/02/05 00:00:00\", this.deadline\n                this.isConfirm = true;\n              }\n            });\n\n          //\n          this.isedit = false;\n          this.loading = true;\n\n          this.$notify({\n            type: \"success\",\n            message: \"\",\n            position: \"top-right\",\n            offset: 100,\n          });\n          this.createFinalVersion();\n          // this.$router.go(0);\n          this.$axios\n            .get(this.api + \"/currentTask?_id=\" + this.diffId)\n            .then((res) => {\n              var video_id = res.data[0].videoId; //_id\n              var authcode = res.data[0].authcode; //\n              this.$axios\n                .get(this.api + \"/profile?name=\" + this.username)\n                .then((res) => {\n                  var userId = res.data[0]._id;\n                  var userTasks = res.data[0].myTasks;\n                  userTasks.push({\n                    taskId: this.diffId,\n                    videoId: video_id,\n                    deadline: this.deadline,\n                    authcode: authcode,\n                    title: this.taskTitle,\n                    label: this.taskLabels,\n                    time: newdate,\n                    scores: \"\",\n                  });\n                  // myTasks\n                  this.$axios.post(this.api + \"/updateMyTasks\", {\n                    params: {\n                      _id: userId,\n                      myTasks: userTasks,\n                    },\n                  });\n                });\n            });\n        } else {\n          this.$notify({\n            // title: \"\",\n            type: \"warning\",\n            message: \"\",\n            position: \"top-right\",\n            offset: 100,\n          });\n        }\n      });\n      // .catch(() => {\n      //   this.$notify({\n      //     // title: \"\",\n      //     type: \"warning\",\n      //     message: \"\",\n      //     position: \"top-right\",\n      //     offset: 100,\n      //   });\n      // });\n    },\n    //\n    createFinalVersion() {\n      this.$axios\n        .get(this.api + \"/currentTask?_id=\" + this.diffId)\n        .then((res) => {\n          // this.openFullScreen2()\n          this.dbList = res.data[0].diffList;\n          //\n          setTimeout(() => {\n            this.loading = false;\n          }, 1500);\n          // console.log(\"dbList\", this.dbList);\n          var final_sentences = [];\n          var only_sentences = [];\n          var only_sentences1 = [];\n          for (var k = 0; k < this.dbList.length; k++) {\n            var original_sentence = this.dbList[k].sentence;\n            var words = this.dbList[k].words;\n            var most_words = [];\n            for (var w = 0; w < words.length; w++) {\n              var words_diffs = words[w].diffs;\n              var most_edited_word = words_diffs[words_diffs.length - 1].diff; //\n              //\n              //\n              var words_diffs2 = words_diffs\n                .sort(this.compare(\"time\"))\n                .sort(this.compare(\"num\"));\n              // console.log(\"words_diffs2\", words_diffs2)\n\n              if (words_diffs2[words_diffs.length - 1].styleDiff) {\n                most_edited_word = {\n                  diff: words_diffs2[words_diffs.length - 1].styleDiff,\n                  isedited: words[w].isedited,\n                };\n              } else {\n                most_edited_word = {\n                  diff: words_diffs2[words_diffs.length - 1].diff,\n                  isedited: words[w].isedited,\n                };\n              }\n              most_words.push(most_edited_word);\n            }\n            var final_sentence = \"\";\n            for (var s = 0; s < most_words.length; s++) {\n              most_words[s].diff.trim();\n              most_words[s].diff = most_words[s].diff + \" \";\n              final_sentence = final_sentence + most_words[s].diff;\n            }\n            // var final_sentence = most_words.join(\"\");\n            final_sentences.push({\n              final_sentence: final_sentence,\n              final_words: most_words,\n            });\n            only_sentences.push(final_sentence);\n          }\n          for (var t = 0; t < only_sentences.length; t++) {\n            var final_sentence1 = only_sentences[t]\n              .replace(/(<del[^>]*?>.*?<\\/del>)/g, \"\")\n              .replace(/(<ins[^>]*?>)|(<\\/ins>)/g, \"\")\n              .replace(/(<subins[^>]*?>)|(<\\/subins>)/g, \"\");\n            // console.log(only_sentences[t])\n            only_sentences1.push(final_sentence1);\n          }\n          // console.log(only_sentences1);\n          // console.log(\"final_context: \", final_sentences);\n          this.final_context = final_sentences;\n          this.sentenceList = only_sentences1;\n        });\n      // console.log(\"aaaa\", this.dbList);\n      //\n      // this.$message({\n      //   message: \"\",\n      //   type: \"success\",\n      // });\n    },\n    compare(attr, rev) {\n      // \n      if (rev == undefined) {\n        rev = 1;\n      } else {\n        rev = rev ? 1 : -1;\n      }\n      return function(a, b) {\n        a = a[attr];\n        b = b[attr];\n        if (a < b) {\n          return rev * -1;\n        }\n        if (a > b) {\n          return rev * 1;\n        }\n        return 0;\n      };\n    },\n    //ES6 \n    unique(arr) {\n      return Array.from(new Set(arr));\n    },\n    showAll(event, index, s_index) {\n      event || (event = window.event);\n      event.stopPropagation\n        ? event.stopPropagation()\n        : (event.cancelBubble = true);\n      this.tableData = [];\n      //s_indexindex\n      this.seen = true;\n      this.current = index;\n      this.tempindex = index;\n      this.isActive = true;\n      // this.isShowAll = true;\n      var words = this.dbList[s_index].words;\n      this.tableData = words[index].diffs;\n      // for (var i = 0; i < this.tableData.length; i++) {\n      //   this.tableData[i].names = this.unique(this.tableData[i].names);\n      // this.tableData[i].names = unique_names.join(\", \"); //bugnames\n      // }\n      this.senTableData = this.dbList[s_index].sentenceDiffs;\n      // console.log(\"senTableData: \", this.senTableData);\n      // console.log(\"words: \", words);\n      // console.log(\"tableData: \", this.tableData);\n      this.changePos(event);\n      // console.log(event);\n      document.addEventListener(\"click\", this.hidePanel, false);\n    },\n    closeShow() {\n      this.seen = false;\n      this.current = null;\n      this.tempindex = null;\n      this.isActive = false;\n      // this.isShowAll = false;\n      var wordOperate = document.getElementById(\"wordOperate\");\n      wordOperate.style.display = \"none\";\n      document.removeEventListener(\"click\", this.hidePanel, false);\n    },\n    hidePanel(e) {\n      if (this.$refs.main && !this.$refs.main.contains(e.target)) {\n        //\n        this.closeShow();\n      }\n    },\n    pip() {\n      if (this.isVideo) {\n        var video = document.querySelector(\"#video > video\");\n        if (!document.pictureInPictureElement) {\n          //\n          video.requestPictureInPicture().catch((error) => {\n            console.log(\n              error,\n              \"Video failed to enter Picture-in-Picture mode.\"\n            );\n          });\n        } else {\n          //\n          document.exitPictureInPicture().catch((error) => {\n            console.log(\n              error,\n              \"Video failed to leave Picture-in-Picture mode.\"\n            );\n          });\n        }\n      } else {\n        this.$notify({\n          // title: \"\",\n          type: \"warning\",\n          message: \"Picture-in-picture is not supported.\",\n          position: \"top-right\",\n          offset: 100,\n        });\n      }\n    },\n\n    // \n    countScores() {\n      // this.$axios\n      //   .post(this.api + \"/getVersions\", { params: { _id: this.diffId } })\n      //   .then((res) => {\n      //     this.versionsList = res.data; //\n      //   });\n      var { ts, fnl } = countTechScores(\n        this.diffList,\n        this.publisher,\n        this.techPoints,\n        this.submitted,\n        0.6,\n        6\n      );\n      var { cms, ms } = countMatchPoints(\n        this.versionsList,\n        this.sentenceList,\n        this.publisher,\n        this.publishTime,\n        this.deadline,\n        this.matchPoints\n      );\n      this.techScoreList = ts;\n      this.matchScoreList = ms;\n      var sum = 0;\n      var scoreList = [];\n      var s = Array.from(new Set(this.submitted)); //\n      for (var j = 0; j < s.length; j++) {\n        var name = s[j];\n        this.techScoreList[name] = !this.techScoreList[name]\n          ? 0\n          : this.techScoreList[name];\n        this.matchScoreList[name] = !this.matchScoreList[name]\n          ? 0\n          : this.matchScoreList[name];\n        if (name != this.publisher) {\n          var scores =\n            Number(this.techScoreList[name]) +\n            Number(this.matchScoreList[name]);\n          sum += scores;\n          scoreList.push({\n            name: name,\n            matchScores: this.matchScoreList[name],\n            techScores: this.techScoreList[name],\n            scores: scores,\n          });\n        }\n      }\n      this.averScores = Math.round(sum / scoreList.length);\n\n      scoreList.sort(this.compare(\"scores\"));\n      var rankList = [];\n\n      var pIndex = s.findIndex((item) => item == this.publisher);\n      pIndex != -1 ? s.splice(pIndex, 1) : s;\n      // ,\n\n      for (var j = 0; j < s.length; j++) {\n        scoreList[j].rank = j + 1;\n        rankList.push({ name: scoreList[j].name, rank: rank });\n      }\n\n      if (scoreList != [] && this.averScores) {\n        this.techList = fnl;\n        this.matchList = cms;\n        this.scoreList = scoreList;\n        this.$axios.post(this.api + \"/updateScoresList\", {\n          params: {\n            _id: this.diffId,\n            scoreList: this.scoreList,\n            techList: this.techList,\n            matchList: this.matchList,\n            averScores: this.averScores,\n          },\n        });\n      }\n    },\n\n    //\n    isScoresList() {\n      var index = null;\n      this.checkStatus(); //\n      // \n      var newLen = Array.from(new Set(this.submitted));\n      var pIndex = newLen.findIndex((item) => item == this.publisher);\n      // 1,\n      newLen = pIndex != -1 ? newLen.length : newLen.length - 1;\n\n      if (\n        this.scoreList == \"\" ||\n        this.scoreList == undefined || //scoreList\n        !this.averScores //\n        // || isExceed\n      ) {\n        if (newLen <= 0) {\n          //\n          this.scores = \"No participants now!\";\n          this.isSubmitted = false;\n          return;\n        } else {\n          this.countScores();\n        }\n      }\n      this.scoreList.sort(this.compare(\"scores\"));\n      if (\n        this.submitted.findIndex((item) => item === this.username) == -1 ||\n        this.username == this.publisher\n      ) {\n        //\n        this.scores = this.averScores + \"\";\n      } else {\n        var index = this.scoreList.findIndex(\n          (item) => item.name === this.username\n        );\n        var rank = this.scoreList[index].rank;\n        this.myRank = rank;\n        this.scores =\n          this.scoreList[index].scores + \" \" + rank + \"%\";\n      }\n      if (this.username == this.publisher) {\n        // myPublished\n        this.$axios.post(this.api + \"/updateMyPublishedScores\", {\n          params: {\n            _id: this.userId,\n            taskId: this.diffId,\n            scoreList: this.scoreList,\n            techList: this.techList,\n            matchList: this.matchList,\n            averScores: this.averScores,\n          },\n        });\n      } else if (\n        this.submitted.findIndex((item) => item === this.username) != -1 &&\n        this.username != this.publisher\n      ) {\n        // myTasks\n        this.$axios.post(this.api + \"/updateMyTasksScores\", {\n          params: {\n            _id: this.userId,\n            taskId: this.diffId,\n            scores: this.scoreList[index].scores\n              ? this.scoreList[index].scores\n              : \"\",\n            userRank: this.myRank,\n          },\n        });\n      }\n    },\n\n    //\n    compareDate(Date1, Date2) {\n      if (Date1.search(\"/\") == -1) {\n        //\"2021/02/06 00:00:00\"\n        Date1 = Date1.replace(\"-\", \"/\"); //\n      }\n      if (Date2.search(\"/\") == -1) {\n        Date2 = Date2.replace(\"-\", \"/\");\n      }\n      if (Date1.split(\" \")[0] == Date2.split(\" \")[0]) {\n        //\n        var time1 = Date1.split(\" \")[1].split(\":\");\n        var time2 = Date2.split(\" \")[1].split(\":\");\n        var total1 =\n          Number(time1[0]) * 3600 + Number(time1[1]) * 60 + Number(time1[2]);\n        var total2 =\n          Number(time2[0]) * 3600 + Number(time2[1]) * 60 + Number(time2[2]);\n        return total1 - total2 >= 0 ? true : false;\n      } else {\n        var oDate1 = new Date(Date1.split(\" \")[0]);\n        var oDate2 = new Date(Date2.split(\" \")[0]);\n        return oDate1 >= oDate2 ? true : false;\n      }\n    },\n    //\n    checkScoresDetails() {\n      if (this.isPublisher) {\n        var path = \"/diff/\" + this.diffId + \"/scores\";\n        this.$router.push(path);\n      } else {\n        var path = \"/diff/\" + this.diffId + \"/scoresStu\";\n        this.$router.push(path);\n      }\n    },\n    // \n    checkStatus() {\n      var index = this.submitted.findIndex((item) => item == this.username);\n      if (this.username == this.publisher) {\n        this.isPublisher = true;\n        this.isSubmitted = true;\n      } else if (index != -1) {\n        this.isSubmitted = true;\n      }\n    },\n\n    manualCofirm() {\n      //\n      this.isScoresList();\n      this.isManual = !this.isManual;\n      this.isConfirm = !this.isConfirm;\n      this.setManual();\n    },\n\n    setManual() {\n      //\n      this.$axios.post(this.api + \"/updateIsManual\", {\n        params: {\n          _id: this.diffId,\n          isManual: this.isManual,\n          isConfirm: this.isConfirm,\n        },\n      });\n    },\n\n    //video play & load & pause\n    playFunc() {\n      this.isCountTime = true;\n      console.log(\"playing\");\n    },\n    pauseFunc() {\n      this.isCountTime = false;\n      console.log(\"pasused\");\n      // your code\n    },\n    loaded() {\n      this.isCountTime = false;\n      console.log(\"waiting\");\n    },\n    startTime() {\n      this.isCountTime = true;\n      console.log(\"moving\");\n    },\n\n    updateStudyTime() {\n      let newdate = this.$moment(new Date()).format(\"YYYY/MM/DD HH:mm:ss\");\n      var timespan = this.timespan;\n      this.$axios.post(\"/score/updateStudyTime\", {\n        params: {\n          _id: this.userId,\n          listenTime: timespan,\n          recordTime: newdate,\n        },\n      });\n    },\n  },\n  //\n  created() {\n    window.addEventListener(\"beforeunload\", this.updateStudyTime);\n    //\n    this.diffId = this.$route.params.diffId;\n    this.username = sessionStorage.getItem(\"userName\");\n    this.$axios.get(this.api + \"/profile?name=\" + this.username).then((res) => {\n      this.userId = res.data[0]._id;\n      this.userStatus = res.data[0].status;\n    });\n    this.$axios\n      .post(this.api + \"/getVersions\", { params: { _id: this.diffId } })\n      .then((res) => {\n        this.versionsList = res.data; //\n      });\n    //\n    this.$axios\n      .get(this.api + \"/currentTask?_id=\" + this.diffId)\n      .then((res) => {\n        var video_id = res.data[0].videoId; //_id\n        this.userList = res.data[0].userList;\n        this.diffList = res.data[0].diffList;\n        this.publisher = res.data[0].publisher;\n        this.submitted = res.data[0].submitted;\n        this.publishTime = res.data[0].time;\n        this.taskTitle = res.data[0].title;\n        this.deadline = res.data[0].deadline;\n        this.taskLabels = res.data[0].label;\n        this.scoreList = res.data[0].scoreList;\n        this.techList = res.data[0].techList;\n        this.matchList = res.data[0].matchList;\n        this.averScores = res.data[0].averScores;\n        this.isManual = res.data[0].isManual;\n        this.isConfirm = res.data[0].isConfirm;\n        console.log(\"lll\", this.submitted);\n\n        // let date = new Date();\n        // let newdate = date.toLocaleString(\"chinese\", {\n        //   hour12: false,\n        // });\n        let newdate = this.$moment(new Date()).format(\"YYYY/MM/DD HH:mm:ss\");\n        var isOut = this.compareDate(newdate, this.deadline);\n        console.log(\"isOut\", isOut);\n        if (this.userStatus == \"1\") {\n          this.isTeacher = true;\n        }\n        if (this.userStatus == \"0\") {\n          this.isTeacher = false;\n          if (isOut) {\n            this.isreadonly = false;\n          }\n        }\n\n        this.$axios\n          .get(this.api + \"/currentVideoPublisher?name=\" + this.publisher)\n          .then((res) => {\n            this.status = res.data[0].status;\n            if (this.status == \"1\") {\n              this.identity = \"\";\n            }\n            if (this.status == \"2\") {\n              this.identity = \"\";\n            }\n          });\n        // console.log(this.userList);\n        //\n        this.$axios\n          .get(this.api + \"/currentVideo?_id=\" + video_id)\n          .then((res) => {\n            this.fileName = res.data[0].fileName;\n            var filetype = this.fileName.split(\".\")[1];\n            for (var i = 0; i < this.videoType.length; i++) {\n              if (filetype == this.videoType[i]) {\n                this.isVideo = true;\n              }\n            }\n          });\n        //\n        if (this.diffList.length == 0) {\n          this.$axios\n            .get(this.api + \"/allVersions?_id=\" + this.diffId)\n            .then((res) => {\n              if (res.data.length == 0) {\n                //\n                this.isversion1 = false;\n                this.loading = false;\n              } else {\n                this.isversion1 = true;\n                this.loading = false;\n                this.text_v1 = res.data[0].version;\n              }\n            });\n        } else {\n          //\n          this.createFinalVersion();\n          this.isversion1 = true;\n          this.isFinal = true;\n        }\n      });\n    if (this.submitted.length == 0) {\n      this.isScoresList();\n    }\n  },\n  updated() {\n    //\n    this.decidePlayer();\n    // let date = new Date();\n    // let newdate = date.toLocaleString(\"chinese\", {\n    //   hour12: false,\n    // });\n    let newdate = this.$moment(new Date()).format(\"YYYY/MM/DD HH:mm:ss\");\n    //(\"2021/02/06 00:00:00\", \"2021/02/05 00:00:00\" newdate, this.deadline)\n    var isDDL = this.compareDate(newdate, this.deadline);\n    if (\n      this.submitted.length >= 1 &&\n      !this.isManual &&\n      (isDDL || this.isConfirm)\n    ) {\n      //1,ddl\n      this.isScoresList();\n    }\n  },\n  mounted() {\n    setInterval(() => {\n      if (this.isCountTime) {\n        this.timespan += 0.1;\n        // console.log(this.timespan);\n      }\n    }, 100);\n    //window.addEventListener('beforeunload', this.updateStudyTime)\n    // window.addEventListener(\"keypress\", this.startTime());\n\n    function onYouTubeIframeAPIReady() {\n      var vm = this;\n      vm.$mount(\".wrapper\");\n      player = new YT.Player('yt-player', {\n\t\tvideoId: vm.$data.videoId,\n\t\tevents: {\n\t\t\tonReady() {\n\t\t\t\tif(player) {\n\t\t\t\t\tconst [artist, title] = player.getVideoData().title.split(' - ');\n\t\t\t\t\tconst videoId = player.getVideoUrl().split('?v=')[1];\n\t\t\t\t\t\n\t\t\t\t\tvm.$data.duration = Math.floor(player.getDuration());\n\t\t\t\t\tvm.$data.title = title.split('|')[0];\n\t\t\t\t\tvm.$data.artist = artist;\n\t\t\t\t\tvm.$data.videoId = videoId;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n    }\n  },\n  destroyed() {\n    window.removeEventListener(\"beforeunload\", this.updateStudyTime);\n    // window.removeEventListener(\"scroll\", this.setHeadPosition, true);\n  },\n};\n</script>\n\n<style>\n/**/\n.el-collapse-item__content {\n  padding-bottom: 0;\n}\n\n.eltable {\n  width: 100%;\n  font-size: 90%;\n}\n\n.eltable th {\n  padding: 4px 0 !important;\n}\n\n.eltable td {\n  padding: 4px 0 !important;\n}\n\n.badge {\n  font-size: 1em;\n  padding: 0.28em 0.22em;\n  font-weight: normal;\n  /*  */\n}\n.buttons {\n  position: fixed;\n  right: 0;\n  margin-right: 6px;\n  display: inline-block;\n  margin-top: 150px;\n  z-index: 99;\n}\n\n.el-header,\n.el-footer {\n  background-color: #b3c0d1;\n  color: #333;\n  line-height: 60px;\n}\n\n.edit {\n  background-color: lavender;\n}\n\nins {\n  color: green;\n  font-weight: bold;\n}\n\nsubins {\n  color: blue;\n}\n\ndel {\n  color: indianred;\n}\n\n.el-main {\n  background: #d3cce3;\n  background: -webkit-linear-gradient(to left, #e9e4f0, #d3cce3);\n  background: linear-gradient(to left, #e9e4f0, #d3cce3);\n  border-radius: 2em;\n}\n.edit-tip {\n  color: purple;\n  font-size: 20px;\n  word-wrap: break-word;\n  word-break: break-all;\n}\n\n#textDiv {\n  margin-top: 0;\n  padding: 1% 2%;\n  font-size: 20px;\n  background-color: white;\n  border-radius: 6px;\n  width: 100%;\n  height: 85%;\n  text-align: left;\n}\n\n#insertText {\n  text-decoration: none;\n  color: #21bf73;\n}\n\n#deleteText {\n  color: #ef6c57;\n  text-decoration: line-through #ea4c4c solid;\n}\n.box-card {\n  width: 1000px;\n  margin-top: 2%;\n}\n.active:hover {\n  color: rgb(0, 0, 95);\n  border-radius: 2px;\n  border-bottom: 1px solid black;\n}\n#wordOperate {\n  display: none;\n  width: 600px;\n  padding: 5px 5px;\n  border-radius: 5px;\n  transition-duration: 100ms;\n  line-height: 100%;\n  box-shadow: 0px 0px 7px rgb(143, 141, 141);\n  z-index: 10001;\n}\n\n/* css */\n.video-container {\n  margin: 1.5% auto;\n  display: flex;\n  justify-content: center;\n}\n\n.video-left-box,\n.video-right-box {\n  margin: 0 1.5em;\n}\n\n.example-player {\n  position: relative;\n  width: 750px;\n  height: 450px;\n  background-color: #000;\n  font-weight: normal;\n}\n\n/* css */\n.my-card.q-card.q-card--bordered.q-card--flat.no-shadow {\n  width: 17.5em;\n}\n\n/* css */\n#menu,\n.submit-btn,\n.edit-btn {\n  display: flex;\n  justify-content: center;\n}\n\n/* .el-row {\n  margin-bottom: 20px;\n} */\n.el-col {\n  border-radius: 4px;\n}\n.row-bg {\n  padding: 10px 0;\n  /* background-color: #f9fafc; */\n}\n.el-textarea {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  vertical-align: baseline;\n  font-size: 16px;\n  line-height: 1.5;\n}\nbutton.q-btn.q-btn-item.non-selectable.no-outline.q-btn--standard.q-btn--rectangle.bg-purple.text-white.q-btn--actionable.q-focusable.q-hoverable.q-btn--wrap,\nbutton.q-btn.q-btn-item.non-selectable.no-outline.q-btn--standard.q-btn--rectangle.bg-purple-4.text-white.q-btn--actionable.q-focusable.q-hoverable.q-btn--wrap,\nbutton.q-btn.q-btn-item.non-selectable.no-outline.q-btn--standard.q-btn--rectangle.bg-purple-6.text-white.q-btn--actionable.q-focusable.q-hoverable.q-btn--wrap {\n  width: 15em;\n}\nmain#mainContent {\n  height: 88vh;\n  padding-bottom: 4%;\n}\n.q-item__section.column.q-item__section--main.justify-center {\n  flex-direction: column;\n}\n.aui_close {\n  width: 15px;\n  height: 15px;\n  line-height: 15px;\n  display: block;\n  position: absolute;\n  right: 10px;\n  top: 10px;\n  font-family: Helvetica, STHeiti;\n  _font-family: \"\\u9ed1\\u4f53\", \"Book Antiqua\", Palatino;\n  font-size: 18px;\n  border-radius: 20px;\n  background: #999;\n  color: #fff;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);\n  -moz-transition: linear 0.06s;\n  -webkit-transition: linear 0.06s;\n  transition: linear 0.06s;\n  padding: 0;\n  text-align: center;\n  text-decoration: none;\n  outline: none;\n  cursor: pointer;\n  z-index: 20;\n}\n.aui_close:hover {\n  width: 17px;\n  height: 17px;\n  line-height: 17px;\n  right: 9px;\n  top: 9px;\n  color: #fff;\n  box-shadow: 0 1px 3px rgba(209, 40, 42, 0.5);\n  background: #d1282a;\n  border-radius: 24px;\n  transition: all 0.2s ease-out;\n  text-decoration: none;\n  opacity: 0.8;\n}\n</style>\n"]}]}